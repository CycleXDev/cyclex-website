<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google tag (GA4) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-BXDFXJWCNQ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-BXDFXJWCNQ');
  </script>

  <link rel="icon" href="/logo.png">
  <link rel="icon" href="/favicon.ico" sizes="any">
  <link rel="icon" type="image/png" href="/logo.png">
  <link rel="apple-touch-icon" href="/logo.png">

  <meta charset="UTF-8" />
  <title>CycleX ‚Äì Security Hub</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
  :root {
    --bg-main: #05060a;
    --bg-gradient-start: #05060a;
    --bg-gradient-mid: #1a0d3a;
    --bg-gradient-end: #003a4c;

    --text-main: #f4f6ff;
    --text-muted: rgba(244, 246, 255, 0.7);

    --accent-cyan: #00e5ff;
    --accent-green: #5dffb2;
    --accent-purple: #7c5cff;

    --card-bg: rgba(255, 255, 255, 0.06);
    --border-subtle: rgba(255, 255, 255, 0.12);

    --shadow-soft: 0 30px 90px rgba(0, 0, 0, 0.75);
    --radius-xl: 24px;
    --radius-lg: 18px;
    --transition-fast: 0.18s ease-out;

    --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    --sans: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text", "Segoe UI", sans-serif;
    --maxw: 1160px;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }
  html, body { height: 100%; }
  body {
    font-family: var(--sans);
    background:
      radial-gradient(circle at top left, rgba(124, 92, 255, 0.35) 0%, transparent 45%),
      radial-gradient(circle at top right, rgba(0, 229, 255, 0.35) 0%, transparent 45%),
      radial-gradient(circle at bottom, rgba(0, 58, 76, 0.55) 0%, transparent 55%),
      linear-gradient(160deg, var(--bg-gradient-start), var(--bg-gradient-mid), var(--bg-gradient-end));
    color: var(--text-main);
    min-height: 100vh;
    -webkit-font-smoothing: antialiased;
    animation: fadeBody 0.7s ease-out forwards;
    opacity: 1;
    overflow-x: hidden;
  }
  @keyframes fadeBody { from { opacity: 0; } to { opacity: 1; } }
  a { color: inherit; text-decoration: none; }

  .page-shell { max-width: var(--maxw); margin: 0 auto; padding: 32px 20px 72px; }

  /* ===== helpers ===== */
  .hide-sm { } /* gets hidden in responsive below */
  .mono {
    font-family: var(--mono);
    font-variant-numeric: tabular-nums;
    direction: ltr;
    unicode-bidi: plaintext;
  }
  .muted { color: var(--text-muted); font-size: 13px; line-height: 1.45; }
  .small { font-size: 12px; color: var(--text-muted); line-height: 1.45; }
  .cell { min-width: 0; }
  .wrap { white-space: normal; overflow-wrap: anywhere; }

  /* Top bar */
  .top-bar {
    position: sticky;
    top: 14px;
    z-index: 999;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 12px;
    padding: 12px 18px;
    margin-bottom: 26px;
    border-radius: 999px;
    background: rgba(8, 10, 22, 0.55);
    backdrop-filter: blur(18px);
    -webkit-backdrop-filter: blur(18px);
    border: 1px solid rgba(255, 255, 255, 0.14);
    box-shadow: 0 20px 70px rgba(0, 0, 0, 0.6), inset 0 1px 0 rgba(255, 255, 255, 0.06);
  }
  .brand { display: flex; align-items: center; gap: 10px; min-width: 0; }
  .brand-logo {
    width: 44px; height: 44px; border-radius: 16px; object-fit: contain;
    box-shadow: 0 12px 32px rgba(0, 0, 0, 0.8);
    flex: 0 0 auto;
  }
  .brand-text { display: flex; flex-direction: column; gap: 2px; min-width: 0; }
  .brand-title {
    font-weight: 800; letter-spacing: 0.05em; font-size: 18px; text-transform: uppercase;
    white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
  }
  .brand-sub {
    font-size: 11px; text-transform: uppercase; letter-spacing: 0.16em; color: var(--text-muted);
    white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
  }

  .lang-switch {
    display: inline-flex;
    align-items: center;
    padding: 4px;
    border-radius: 999px;
    background: rgba(255, 255, 255, 0.06);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.16);
    box-shadow: 0 12px 36px rgba(0, 0, 0, 0.55);
    gap: 2px;
    flex: 0 0 auto;
  }
  .lang-btn {
    border: none;
    background: transparent;
    color: var(--text-muted);
    font-size: 11px;
    padding: 6px 9px;
    border-radius: 999px;
    cursor: pointer;
    transition: background var(--transition-fast), color var(--transition-fast), transform var(--transition-fast);
    user-select: none;
    white-space: nowrap;
  }
  .lang-btn:hover { transform: translateY(-1px); }
  .lang-btn.active { background: rgba(0, 229, 255, 0.14); color: var(--accent-cyan); }

  body.lang-switching { animation: langFade 0.28s ease-out; }
  @keyframes langFade { from { opacity: 0.5; transform: translateY(4px); } to { opacity: 1; transform: translateY(0); } }

  /* Hero */
  .hero {
    text-align: center;
    max-width: 980px;
    margin: 0 auto 18px auto;
    animation: fadeUp 0.8s ease-out forwards;
  }
  @keyframes fadeUp { from { opacity: 0; transform: translateY(14px); } to { opacity: 1; transform: translateY(0); } }

  .hero-kicker { font-size: 13px; letter-spacing: 0.16em; text-transform: uppercase; color: var(--accent-cyan); margin-bottom: 14px; }
  .hero-title { font-size: clamp(40px, 5vw, 60px); line-height: 1.05; font-weight: 900; margin-bottom: 14px; letter-spacing: -0.02em; }
  .hero-subtitle { max-width: 760px; margin: 0 auto 18px auto; font-size: 16px; line-height: 1.5; color: var(--text-muted); }
  .hero-actions { display: flex; justify-content: center; flex-wrap: wrap; gap: 14px; margin-bottom: 10px; }

  .btn {
    border-radius: 999px;
    border: none;
    padding: 13px 26px;
    font-size: 14px;
    font-weight: 700;
    letter-spacing: 0.04em;
    text-transform: uppercase;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    transition: transform var(--transition-fast), box-shadow var(--transition-fast), background var(--transition-fast), color var(--transition-fast), border-color var(--transition-fast);
    user-select: none;
    white-space: nowrap;
    max-width: 100%;
    min-width: 0;
  }
  .btn:disabled { opacity: 0.55; cursor: not-allowed; }

  .btn-primary {
    background: linear-gradient(135deg, var(--accent-cyan), #7df2ff);
    color: #020308;
    box-shadow: 0 14px 40px rgba(0, 229, 255, 0.4);
  }
  .btn-primary:hover { transform: translateY(-1px); box-shadow: 0 18px 60px rgba(0, 229, 255, 0.6); }

  .btn-secondary {
    background: linear-gradient(135deg, var(--accent-green), #b9ffcf);
    color: #020308;
    box-shadow: 0 14px 40px rgba(0, 230, 118, 0.4);
  }
  .btn-secondary:hover { transform: translateY(-1px); box-shadow: 0 18px 60px rgba(0, 230, 118, 0.7); }

  .btn-ghost {
    background: rgba(255,255,255,0.05);
    border: 1px solid rgba(255,255,255,0.16);
    color: var(--text-main);
    box-shadow: 0 12px 34px rgba(0,0,0,0.45);
  }
  .btn-ghost:hover { transform: translateY(-1px); border-color: rgba(0,229,255,0.26); }

  .note-line { margin-top: 10px; font-size: 12px; color: var(--text-muted); line-height: 1.45; }

  /* Tool cubes */
  .tool-grid-wrap { max-width: 1040px; margin: 0 auto 18px; }
  .tool-grid-title {
    text-align: center;
    margin: 14px 0 8px;
    font-size: 12px;
    letter-spacing: 0.16em;
    text-transform: uppercase;
    color: rgba(244,246,255,0.72);
  }
  .tool-grid {
    display: grid;
    grid-template-columns: repeat(3, minmax(0, 1fr));
    gap: 18px;
    margin-top: 10px;
    align-items: stretch;
  }
  .tool-card {
    background: rgba(255,255,255,0.05);
    border-radius: var(--radius-xl);
    border: 1px solid rgba(255,255,255,0.12);
    padding: 22px 22px 18px;
    box-shadow: 0 24px 70px rgba(0,0,0,0.65), inset 0 1px 0 rgba(255,255,255,0.05);
    cursor: pointer;
    position: relative;
    overflow: hidden;
    transition: transform var(--transition-fast), border-color var(--transition-fast), background var(--transition-fast);
    min-width: 0;
    min-height: 178px;
  }
  .tool-card::before{
    content:"";
    position:absolute; inset:-2px;
    background:
      radial-gradient(520px 180px at 18% -5%, rgba(0,229,255,.18), transparent 60%),
      radial-gradient(520px 180px at 85% 0%, rgba(124,92,255,.18), transparent 60%);
    pointer-events:none;
    opacity: .95;
  }
  .tool-card > * { position: relative; }
  .tool-card:hover { transform: translateY(-3px); border-color: rgba(0,229,255,0.28); background: rgba(255,255,255,0.065); }
  .tool-card.active { border-color: rgba(0,229,255,0.42); background: rgba(0,229,255,0.06); }

  .tool-head { display:flex; align-items:flex-start; justify-content:space-between; gap:10px; margin-bottom:10px; }
  .tool-name { font-size: 17px; font-weight: 900; letter-spacing: 0.01em; line-height: 1.25; }
  .tool-desc { font-size: 14px; color: var(--text-muted); line-height: 1.5; }

  .badge-row { display:flex; flex-wrap:wrap; gap:8px; margin-top: 14px; }
  .badge {
    display:inline-flex; align-items:center; gap:8px;
    font-size: 12px;
    padding: 6px 10px;
    border-radius: 999px;
    border: 1px solid rgba(255,255,255,0.12);
    background: rgba(255,255,255,0.05);
    color: var(--text-muted);
    white-space: nowrap;
    user-select: none;
  }
  .badge strong { color: rgba(244,246,255,0.92); font-weight: 800; }
  .badge.beta { border-color: rgba(255,193,7,0.25); background: rgba(255,193,7,0.08); color: rgba(244,246,255,0.92); }

  /* Risk badges */
  .risk-badges { display:flex; flex-wrap:wrap; gap:8px; margin-top: 10px; }
  .risk {
    display:inline-flex; align-items:center; gap:8px;
    padding: 6px 10px;
    border-radius: 999px;
    font-size: 12px;
    border: 1px solid rgba(255,255,255,0.12);
    background: rgba(255,255,255,0.05);
    color: rgba(244,246,255,0.88);
    user-select:none;
  }
  .risk .dot{
    width:10px; height:10px; border-radius: 999px;
    background: rgba(255,255,255,0.25);
    box-shadow: 0 0 0 3px rgba(255,255,255,0.06);
    flex: 0 0 auto;
  }
  .risk.ok    { border-color: rgba(0,230,118,0.25); background: rgba(0,230,118,0.08); }
  .risk.ok .dot { background: rgba(0,230,118,0.95); }
  .risk.warn  { border-color: rgba(255,193,7,0.25); background: rgba(255,193,7,0.08); }
  .risk.warn .dot { background: rgba(255,193,7,0.95); }
  .risk.bad   { border-color: rgba(220,53,69,0.25); background: rgba(220,53,69,0.10); }
  .risk.bad .dot { background: rgba(220,53,69,0.95); }

  /* Panels */
  .panel-shell {
    margin-top: 14px;
    padding: 22px 20px;
    border-radius: var(--radius-xl);
    background: rgba(255, 255, 255, 0.04);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.12);
    box-shadow: 0 28px 80px rgba(0, 0, 0, 0.65), inset 0 1px 0 rgba(255, 255, 255, 0.05);
  }
  .panel-shell.hidden { display: none; }

  .panel-head {
    display:flex;
    align-items:flex-start;
    justify-content:space-between;
    gap:12px;
    margin-bottom: 12px;
  }
  .panel-kicker {
    font-size: 12px;
    letter-spacing: 0.16em;
    text-transform: uppercase;
    color: var(--accent-purple);
    margin-bottom: 8px;
  }
  .panel-title { font-size: 28px; font-weight: 900; letter-spacing: -0.01em; line-height: 1.12; }
  .panel-sub { margin-top: 8px; max-width: 900px; color: var(--text-muted); font-size: 14px; line-height: 1.6; }

  .panel-actions { display:flex; gap:10px; flex-wrap:wrap; justify-content:flex-end; align-items:center; }
  .pill {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    font-size: 12px;
    padding: 6px 10px;
    border-radius: 999px;
    border: 1px solid rgba(255,255,255,0.12);
    background: rgba(255,255,255,0.05);
    color: var(--text-muted);
    white-space: nowrap;
  }

  .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; margin-top: 14px; }

  .card {
    background: var(--card-bg);
    border-radius: var(--radius-lg);
    border: 1px solid var(--border-subtle);
    padding: 16px;
    box-shadow: var(--shadow-soft);
    backdrop-filter: blur(18px);
    min-width: 0;
  }
  .card h3 { font-size: 15px; letter-spacing: 0.02em; margin-bottom: 8px; color: var(--text-main); }

  .field { margin-top: 10px; }
  .label { font-size: 12px; letter-spacing: 0.08em; text-transform: uppercase; color: rgba(244,246,255,0.75); margin-bottom: 6px; }
  .row { display: flex; gap: 10px; flex-wrap: wrap; align-items: center; }

  input, textarea, select {
    width: 100%;
    padding: 10px 12px;
    border-radius: 999px;
    border: 1px solid rgba(255,255,255,0.16);
    background: rgba(5, 7, 18, 0.9);
    color: var(--text-main);
    font-size: 13px;
    outline: none;
  }
  textarea { border-radius: 18px; min-height: 96px; resize: vertical; padding: 12px 12px; }
  input:focus, textarea:focus, select:focus { border-color: var(--accent-cyan); }

  .toggle{
    display:flex; align-items:center; gap:10px;
    padding:10px 12px;
    border:1px solid rgba(255,255,255,0.12);
    background: rgba(255,255,255,0.04);
    border-radius: 14px;
    user-select:none;
    width: 100%;
  }
  .toggle input{ width:auto; accent-color: var(--accent-cyan); }

  .status {
    margin-top: 10px;
    padding: 12px 14px;
    border-radius: 16px;
    border: 1px solid rgba(255,255,255,0.14);
    background: rgba(255,255,255,0.04);
    color: var(--text-main);
    line-height: 1.5;
    font-size: 13px;
    display: none;
    overflow-wrap: anywhere;
  }
  .status.ok   { display:block; background: rgba(0, 230, 118, 0.10); border-color: rgba(0,230,118,0.35); color: #78ffbf; }
  .status.warn { display:block; background: rgba(255, 193, 7, 0.10); border-color: rgba(255,193,7,0.35); color: #ffd166; }
  .status.bad  { display:block; background: rgba(220, 53, 69, 0.10); border-color: rgba(220,53,69,0.35); color: #ff7a8a; }
  .status.info { display:block; background: rgba(0, 229, 255, 0.10); border-color: rgba(0,229,255,0.30); color: #7df2ff; }

  /* ===== tables (IMPORTANT FIX: no "card expansion") ===== */
  .table{
    margin-top: 10px;
    border: 1px solid rgba(255,255,255,0.12);
    border-radius: 18px;
    overflow-x: auto;
    overflow-y: hidden;
    -webkit-overflow-scrolling: touch;
    background: rgba(255,255,255,0.03);
  }

  .trow{
    display: grid;
    grid-template-columns: 1.3fr 1.1fr 0.9fr 0.9fr;
    gap: 10px;
    padding: 10px 12px;
    border-top: 1px solid rgba(255,255,255,0.10);
    align-items: center;
    font-size: 13px;
    min-width: 640px; /* prevents squish -> scroll instead */
  }
  .trow.head{
    border-top: none;
    background: rgba(255,255,255,0.05);
    font-size: 12px;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    color: rgba(244,246,255,0.75);
  }

  .trow .cell{
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }
  .trow .cell.wrap{
    white-space: normal;
    text-overflow: clip;
    overflow-wrap: anywhere;
  }

  /* =========================
     RPC table
     ========================= */
  #rpc-table { overflow-x: auto; -webkit-overflow-scrolling: touch; }

  #rpc-table .trow.head.rpc,
  #rpc-table .trow.rpc{
    display: grid;
    grid-template-columns: minmax(240px, 1.8fr) 72px 64px 64px 60px 60px minmax(140px, 1fr);
    gap: 10px;
    align-items: center;
    min-width: 760px;
  }

  #rpc-table .trow.head.rpc .cell,
  #rpc-table .trow.rpc .cell{
    min-width: 0;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }

  #rpc-table .trow.head.rpc .cell:first-child,
  #rpc-table .trow.rpc .cell:first-child{
    white-space: normal;
    text-overflow: clip;
    overflow: hidden;
    overflow-wrap: anywhere;
    line-height: 1.15;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 2;
    direction: ltr;
    unicode-bidi: plaintext;
  }

  #rpc-table .trow.head.rpc .cell:last-child,
  #rpc-table .trow.rpc .cell:last-child{
    white-space: normal;
    text-overflow: clip;
    overflow: hidden;
    overflow-wrap: anywhere;
    line-height: 1.15;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 2;
  }

  #rpc-table .trow.rpc .cell:not(:first-child),
  #rpc-table .trow.head.rpc .cell:not(:first-child){
    text-align: center;
    justify-self: center;
  }

  .trow.highlight{
    background: rgba(0,230,118,0.10);
    border-top-color: rgba(0,230,118,0.20);
  }

  /* chips */
  .chip {
    display:inline-flex; align-items:center; gap:8px;
    padding: 8px 10px;
    border-radius: 999px;
    border: 1px solid rgba(255,255,255,0.12);
    background: rgba(255,255,255,0.05);
    color: rgba(244,246,255,0.88);
    cursor: pointer;
    user-select: none;
    transition: transform var(--transition-fast), border-color var(--transition-fast);
    font-size: 12px;
  }
  .chip:hover { transform: translateY(-1px); border-color: rgba(0,229,255,0.26); }

  .chip-danger{
    border-color: rgba(255, 80, 80, 0.25);
    background: rgba(255, 80, 80, 0.08);
  }
  .chip-danger:hover{
    border-color: rgba(255, 80, 80, 0.45);
    transform: translateY(-1px);
  }

  .share-row { display:flex; gap:10px; flex-wrap:wrap; margin-top: 12px; }

  /* QuickScan results table */
  #panel-quick .table .trow{ align-items: start; }
  #panel-quick .table .trow.head{ align-items: center; }
  #panel-quick .table .trow .cell{ overflow-wrap: anywhere; }
  #panel-quick .table .trow:not(.head) .cell:last-child{
    font-size: 12px;
    font-family: var(--mono);
    font-variant-numeric: tabular-nums;
    line-height: 1.25;
    white-space: normal;
    text-overflow: clip;
  }

  /* QuickScan buttons */
  #panel-quick .row.qs-actions,
  #panel-quick .qs-share{
    display: grid;
    grid-template-columns: repeat(2, minmax(0, 1fr));
    gap: 10px;
    align-items: stretch;
  }
  #panel-quick .qs-share{ margin-top: 12px; }

  #panel-quick .qs-actions .btn,
  #panel-quick .qs-share .btn{
    width: 100%;
    min-width: 0;
    padding: 12px 14px;
    font-size: 12px;
    letter-spacing: 0.03em;
    white-space: normal;
    line-height: 1.15;
    min-height: 44px;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  #panel-quick .qs-actions #qs-run{ grid-column: 1 / -1; }
  #panel-quick .qs-actions #qs-copy-md{ grid-column: 1 / -1; }
  #panel-quick .qs-share #qs-copy-xtext{ grid-column: 1 / -1; }

  @media (min-width: 1280px){
    #panel-quick .row.qs-actions{ grid-template-columns: repeat(4, minmax(0, 1fr)); }
    #panel-quick .qs-actions #qs-run,
    #panel-quick .qs-actions #qs-copy-md{ grid-column: auto; }
    #panel-quick .qs-share{ grid-template-columns: repeat(3, minmax(0, 1fr)); }
    #panel-quick .qs-share #qs-copy-xtext{ grid-column: auto; }
  }

  /* =========================
     QuickScan ‚Äî Risk Table
     ========================= */
  #qs-riskTable{
    margin-top: 12px;
    overflow-x: auto;
    overflow-y: hidden;
    -webkit-overflow-scrolling: touch;
  }

  #qs-riskTable .trow.head.risk,
  #qs-riskTable .trow.risk{
    display: grid;
    grid-template-columns: 0.95fr 0.95fr 0.95fr 0.95fr 0.95fr 0.95fr 0.85fr 1.5fr;
    gap: 10px;
    padding: 10px 12px;
    align-items: center;
    min-width: 980px;
  }

  #qs-riskTable .trow.head.risk{
    background: rgba(255,255,255,0.05);
    font-size: 12px;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    color: rgba(244,246,255,0.75);
    border-top: none;
  }

  #qs-riskTable .trow.risk{
    background: rgba(255,255,255,0.03);
    border-top: 1px solid rgba(255,255,255,0.10);
  }

  #qs-riskTable .cell{
    min-width: 0;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }

  #qs-riskTable .cell:not(:last-child){
    text-align: center;
    justify-self: center;
  }

  #qs-riskTable .cell:last-child{
    text-align: left;
    white-space: normal;
    overflow-wrap: anywhere;
    line-height: 1.15;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 3;
  }

  .sig{
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    padding: 6px 10px;
    border-radius: 999px;
    border: 1px solid rgba(255,255,255,0.12);
    background: rgba(255,255,255,0.05);
    color: rgba(244,246,255,0.92);
    font-size: 12px;
    white-space: nowrap;
  }
  .sig .dot{
    width: 10px;
    height: 10px;
    border-radius: 999px;
    background: rgba(255,255,255,0.25);
    box-shadow: 0 0 0 3px rgba(255,255,255,0.06);
  }
  .sig.ok    { border-color: rgba(0,230,118,0.25); background: rgba(0,230,118,0.08); }
  .sig.ok .dot { background: rgba(0,230,118,0.95); }
  .sig.warn  { border-color: rgba(255,193,7,0.25); background: rgba(255,193,7,0.08); }
  .sig.warn .dot { background: rgba(255,193,7,0.95); }
  .sig.bad   { border-color: rgba(220,53,69,0.25); background: rgba(220,53,69,0.10); }
  .sig.bad .dot { background: rgba(220,53,69,0.95); }

  .qs-scoreRow{
    display:flex;
    flex-wrap:wrap;
    gap:10px;
    align-items:center;
    margin-top: 10px;
  }
  .score-pill{
    display:inline-flex;
    align-items:center;
    gap:10px;
    padding: 8px 12px;
    border-radius: 999px;
    border: 1px solid rgba(255,255,255,0.12);
    background: rgba(255,255,255,0.05);
    font-size: 12px;
    color: rgba(244,246,255,0.92);
  }
  .score-pill strong{ font-weight: 900; letter-spacing: 0.02em; }
  .score-pill.low   { border-color: rgba(0,230,118,0.25); background: rgba(0,230,118,0.08); }
  .score-pill.med   { border-color: rgba(255,193,7,0.25); background: rgba(255,193,7,0.08); }
  .score-pill.high  { border-color: rgba(220,53,69,0.25); background: rgba(220,53,69,0.10); }

  .flags-box{
    margin-top: 10px;
    padding: 12px 14px;
    border-radius: 16px;
    border: 1px solid rgba(255,193,7,0.25);
    background: rgba(255,193,7,0.08);
    color: #ffd166;
    font-size: 13px;
    line-height: 1.45;
    display:none;
  }
  .flags-box ul{ margin-top: 8px; padding-left: 18px; }
  .flags-box li{ margin: 4px 0; }

  .qs-disclaimer{
    margin-top: 10px;
    font-size: 12px;
    color: var(--text-muted);
    line-height: 1.45;
  }

  /* =========================
     Bookmarklet help block + logo
     ========================= */
  .h3-row{
    display:flex;
    align-items:center;
    gap:10px;
  }
  .h3-row img{
    width: 22px;
    height: 22px;
    border-radius: 8px;
    box-shadow: 0 10px 24px rgba(0,0,0,0.6);
  }

  .help-box{
    margin-top: 10px;
    padding: 12px 14px;
    border-radius: 16px;
    border: 1px solid rgba(0,229,255,0.20);
    background: rgba(0,229,255,0.08);
    color: #7df2ff;
    font-size: 13px;
    line-height: 1.45;
    display:none;
  }
  .help-box ol{ margin-top: 8px; padding-left: 18px; }
  .help-box li{ margin: 4px 0; }

  /* Footer */
  .footer {
    border-top: 1px solid rgba(255, 255, 255, 0.06);
    margin-top: 20px;
    padding-top: 16px;
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    justify-content: space-between;
    gap: 10px;
    font-size: 12px;
    color: var(--text-muted);
  }
  .footer-tagline { color: var(--accent-cyan); font-weight: 700; }

  /* RTL tweaks */
  html[dir="rtl"] body { direction: rtl; }
  html[dir="rtl"] .top-bar { flex-direction: row-reverse; }
  html[dir="rtl"] .brand { flex-direction: row-reverse; }
  html[dir="rtl"] .panel-head { flex-direction: row-reverse; }
  html[dir="rtl"] .row { flex-direction: row-reverse; }
  html[dir="rtl"] .panel-actions { justify-content: flex-start; }

  /* Responsiveness */
  @media (max-width: 1080px) {
    .tool-grid { grid-template-columns: repeat(2, minmax(0, 1fr)); }
  }
  @media (max-width: 980px) {
    .grid-2 { grid-template-columns: 1fr; }
    .panel-title { font-size: 24px; }

    .hide-sm { display: none !important; }

    /* On smaller screens: make base tables scroll nicely without breaking cards */
    .trow { min-width: 560px; }

    /* RPC table becomes 3 visible columns if your middle cells are marked hide-sm */
    #rpc-table .trow.head.rpc,
    #rpc-table .trow.rpc{
      grid-template-columns: minmax(220px, 1.6fr) 72px minmax(140px, 1fr);
      min-width: 560px;
    }
  }
  @media (max-width: 900px) {
    .tool-grid { grid-template-columns: 1fr; }
    .tool-card { min-height: unset; }
  }
  @media (max-width: 640px) {
    .top-bar { top: 10px; padding: 10px 12px; }
    .brand-logo { width: 40px; height: 40px; border-radius: 14px; }
    .btn { padding: 12px 18px; font-size: 13px; }
  }
</style>
</head>

<body>
  <div class="page-shell">
    <header class="top-bar">
      <a class="brand" href="/" title="Back to CycleX" data-i18n-title="title_back_to_cyclex">
        <img src="/logo.png" alt="CycleX logo" class="brand-logo" />
        <div class="brand-text">
          <div class="brand-title">CYCLEX</div>
          <div class="brand-sub" data-i18n="brand_sub">On-Chain Security & Rewards</div>
        </div>
      </a>

      <div class="lang-switch" aria-label="Language selector" data-i18n-aria-label="aria_lang_selector">
        <button class="lang-btn active" data-lang="en">üá∫üá∏ EN</button>
        <button class="lang-btn" data-lang="zh">üá®üá≥ ‰∏≠Êñá</button>
        <button class="lang-btn" data-lang="ar">üá∏üá¶ ÿπÿ±ÿ®Ÿä</button>
        <button class="lang-btn" data-lang="ru">üá∑üá∫ RU</button>
      </div>
    </header>

    <main>
      <section class="hero">
        <div class="hero-kicker" data-i18n="hero_kicker">Security Hub</div>
        <h1 class="hero-title" data-i18n="hero_title">CycleX Security Tools</h1>
        <p class="hero-subtitle" data-i18n="hero_subtitle">
          A lightweight, client-side toolkit for safer swaps, approvals hygiene, liquidity checks, RPC health, and transaction decoding across BSC + Ethereum.
        </p>

        <div class="hero-actions">
          <a class="btn btn-primary" href="/" data-i18n="btn_back">Back to Site</a>
          <button class="btn btn-secondary" id="btn-connect" data-i18n="btn_connect">Connect Wallet (optional)</button>
          <button class="btn btn-ghost" id="btn-quick" data-i18n="btn_quick">Run Quick Scan</button>
        </div>

        <div class="note-line" data-i18n="hero_note">
          Note: These checks are informational and do not guarantee safety. Always verify independently.
        </div>
      </section>

      <section class="tool-grid-wrap">
        <div class="tool-grid-title" data-i18n="tools_kicker">CHOOSE A TOOL</div>

        <div class="tool-grid" id="toolGrid">
          <div class="tool-card active" data-tool="quick">
            <div class="tool-head">
              <div class="tool-name" data-i18n="cube_quick_title">Quick Scan</div>
              <div class="badge"><strong>BSC</strong> + <strong>ETH</strong></div>
            </div>
            <div class="tool-desc" data-i18n="cube_quick_desc">Fast token sanity-check + shareable report + cache.</div>
            <div class="badge-row">
              <div class="badge"><strong data-i18n="badge_fast">Fast</strong></div>
              <div class="badge"><strong data-i18n="badge_share">Share</strong></div>
              <div class="badge"><strong data-i18n="badge_cache">Cache</strong></div>
            </div>
          </div>

          <div class="tool-card" data-tool="liq">
            <div class="tool-head">
              <div class="tool-name" data-i18n="cube_liq_title">Token + Liquidity Scan</div>
              <div class="badge"><strong>V2</strong> + <strong>V3</strong></div>
            </div>
            <div class="tool-desc" data-i18n="cube_liq_desc">DEX Registry checks (Pancake/Uni): token vs WBNB/WETH and USDT.</div>
            <div class="badge-row">
              <div class="badge"><strong data-i18n="badge_dex">DEX</strong></div>
              <div class="badge"><strong>USDT</strong></div>
              <div class="badge"><strong data-i18n="badge_pairs">Pairs</strong></div>
            </div>
          </div>

          <div class="tool-card" data-tool="approvals">
            <div class="tool-head">
              <div class="tool-name" data-i18n="cube_approvals_title">Approval Guardian</div>
              <div class="badge"><strong data-i18n="badge_wallet">Wallet</strong></div>
            </div>
            <div class="tool-desc" data-i18n="cube_approvals_desc">Check and revoke ERC-20 allowances safely (approve ‚Üí 0).</div>
            <div class="badge-row">
              <div class="badge"><strong>BSC</strong> + <strong>ETH</strong></div>
              <div class="badge"><strong data-i18n="badge_safe">Safe</strong></div>
            </div>
          </div>

          <div class="tool-card" data-tool="rpc">
            <div class="tool-head">
              <div class="tool-name" data-i18n="cube_rpc_title">RPC Health Checker</div>
              <div class="badge"><strong>‚úÖ</strong> <span data-i18n="badge_table">Table</span></div>
            </div>
            <div class="tool-desc" data-i18n="cube_rpc_desc">Latency + chainId + block + eth_call + read logs + dev custom test.</div>
            <div class="badge-row">
              <div class="badge"><strong data-i18n="badge_copy">Copy</strong></div>
              <div class="badge"><strong data-i18n="badge_dev">Dev</strong></div>
              <div class="badge"><strong>X</strong> <span data-i18n="badge_share">Share</span></div>
            </div>
          </div>

          <div class="tool-card" data-tool="tx">
            <div class="tool-head">
              <div class="tool-name" data-i18n="cube_tx_title">Tx Decoder</div>
              <div class="badge"><strong data-i18n="badge_decode">Decode</strong></div>
            </div>
            <div class="tool-desc" data-i18n="cube_tx_desc">Decode inputs + common events (Transfer/Approval) from a tx hash.</div>
            <div class="badge-row">
              <div class="badge"><strong data-i18n="badge_receipt">Receipt</strong></div>
              <div class="badge"><strong data-i18n="badge_events">Events</strong></div>
            </div>
          </div>

          <div class="tool-card" data-tool="dev">
            <div class="tool-head">
              <div class="tool-name" data-i18n="cube_dev_title">Dev Tools</div>
              <div class="badge"><strong data-i18n="badge_tools">Tools</strong></div>
            </div>
            <div class="tool-desc" data-i18n="cube_dev_desc">Bookmarklet generator + local contract monitor (no server).</div>
            <div class="badge-row">
              <div class="badge"><strong data-i18n="badge_bookmarklet">Bookmarklet</strong></div>
              <div class="badge"><strong data-i18n="badge_local">Local</strong></div>
            </div>
          </div>
        </div>
      </section>
      <!-- PANELS -->
      <section class="panel-shell" id="panel-quick">
        <div class="panel-head">
          <div>
            <div class="panel-kicker" data-i18n="p_quick_kicker">Quick Scan</div>
            <div class="panel-title" data-i18n="p_quick_title">Score a token in seconds</div>
            <div class="panel-sub" data-i18n="p_quick_sub">
              Paste a token address, choose network, run scan. Cached for 10 minutes. Generate shareable text + JSON + Markdown.
            </div>
          </div>
          <div class="panel-actions">
            <div class="pill"><span data-i18n="pill_wallet">Wallet</span>: <span class="mono" id="walletLabel" data-i18n="wallet_not_connected">not connected</span></div>
            <button class="btn btn-ghost" id="btnCloseQuick" data-i18n="btn_close">Close</button>
          </div>
        </div>

        <div class="grid-2">
          <div class="card">
            <h3 data-i18n="quick_input_title">Token Input</h3>

            <div class="field">
              <div class="label" data-i18n="net_label">Network</div>
              <select id="qs-net">
                <option value="bsc">BSC (BNB Chain)</option>
                <option value="eth">Ethereum</option>
              </select>
            </div>

            <div class="field">
              <div class="label" data-i18n="addr_label">Token contract</div>
              <input id="qs-token" class="mono" placeholder="0x..." />
              <div class="small" style="margin-top:8px" data-i18n="qs_tip">
                Tip: open with <span class="mono">?tool=quick&net=bsc&token=0x...</span> to auto-run (rate-limited).
              </div>
            </div>

            <div class="field">
              <div class="label" data-i18n="options_label">Options</div>
              <label class="toggle">
                <input type="checkbox" id="qs-require-liq">
                <span data-i18n="opt_require_liq">Require liquidity (stricter score)</span>
              </label>
              <label class="toggle" style="margin-top:10px">
                <input type="checkbox" id="qs-show-json" checked>
                <span data-i18n="opt_show_json">Enable JSON report (copy)</span>
              </label>
            </div>

            <div class="field" style="margin-top:14px">
              <div class="label" data-i18n="api_keys_label">Explorer API keys (optional)</div>
              <label class="toggle">
                <input type="checkbox" id="api-use">
                <span data-i18n="opt_use_explorer_apis">Use BscScan/Etherscan (adds Verified + ABI heuristics)</span>
              </label>

              <div class="row" style="margin-top:10px">
                <input id="api-bscscan" class="mono" placeholder="BscScan API key (stored locally)" data-i18n-placeholder="ph_bscscan_key" />
                <input id="api-etherscan" class="mono" placeholder="Etherscan API key (stored locally)" data-i18n-placeholder="ph_etherscan_key" />
              </div>

              <div class="row" style="margin-top:10px">
                <button class="btn btn-ghost" id="api-save" style="padding:10px 14px; font-size:12px;" data-i18n="btn_save">Save</button>
                <button class="btn btn-ghost" id="api-clear" style="padding:10px 14px; font-size:12px;" data-i18n="btn_clear">Clear</button>
              </div>

              <div class="small" style="margin-top:8px" data-i18n="api_keys_tip">
                Keys are saved in your browser (localStorage) only. Do not paste keys into public HTML.
              </div>
            </div>

            <div class="field">
  <div class="row qs-actions">
    <button class="btn btn-primary" id="qs-run" data-i18n="btn_scan">Scan</button>
    <button class="btn btn-ghost" id="qs-copy-link" data-i18n="btn_copy_link">Copy Share Link</button>
    <button class="btn btn-ghost" id="qs-copy-json" data-i18n="btn_copy_json">Copy JSON</button>
    <button class="btn btn-ghost" id="qs-copy-md" data-i18n="btn_copy_md">Copy Markdown</button>
  </div>
</div>

<div class="qs-share">
  <button class="btn btn-ghost" id="qs-share-x">Share to X</button>
  <button class="btn btn-ghost" id="qs-share-tg">Share to Telegram</button>
  <button class="btn btn-ghost" id="qs-copy-xtext" data-i18n="btn_copy_xtext">Copy X text</button>
</div>


            <div id="qs-status" class="status info"></div>
          </div>
          

          <div class="card">
            <h3 data-i18n="results_title">Results</h3>
            <div class="small" data-i18n="results_hint">
              Green / Yellow / Red signals. Not a guarantee ‚Äî just verifiable on-chain checks.
            </div>

         
  <!-- Score + Summary -->
  <div class="qs-scoreRow" id="qs-scoreRow"></div>

  <!-- Risk Table (6‚Äì8 columns) -->
  <div id="qs-riskTable" class="table">
    <div class="trow head risk">
      <div class="cell" data-i18n="th_liq">Liquidity</div>
      <div class="cell" data-i18n="th_owner">Owner</div>
      <div class="cell" data-i18n="th_sell">Sell</div>
      <div class="cell" data-i18n="th_tax">Tax</div>
      <div class="cell" data-i18n="th_supply">Supply</div>
      <div class="cell" data-i18n="th_upgrade">Upgrade</div>
      <div class="cell" data-i18n="th_verified">Verified</div>
      <div class="cell" data-i18n="th_notes">Notes</div>
    </div>

    <div class="trow risk" id="qs-riskRow">
      <div class="cell muted">‚Äî</div>
      <div class="cell muted">‚Äî</div>
      <div class="cell muted">‚Äî</div>
      <div class="cell muted">‚Äî</div>
      <div class="cell muted">‚Äî</div>
      <div class="cell muted">‚Äî</div>
      <div class="cell muted">‚Äî</div>
      <div class="cell muted">‚Äî</div>
    </div>
  </div>

  <!-- Red flags (human summary) -->
  <div id="qs-flags" class="flags-box"></div>

  <!-- Keep pairs (optional extra details) -->
  <div id="qs-pairsWrap" style="margin-top:12px;"></div>

  <!-- old output box becomes "ready" placeholder only -->
  <div id="qs-out" class="status info" style="display:block; margin-top:10px;" data-i18n="qs_ready_html">
    <strong>Ready.</strong><br>
    Paste a token address and click <b>Scan</b>.
  </div>

  <div class="qs-disclaimer" data-i18n="qs_disclaimer">
    Based on known on-chain risk patterns. Not an audit. Results may be incomplete or wrong ‚Äî always verify independently.
  </div>
</div>

          </div>
        </div>
      </section>

      <section class="panel-shell hidden" id="panel-liq">
        <div class="panel-head">
          <div>
            <div class="panel-kicker" data-i18n="p_liq_kicker">Token + Liquidity Scan</div>
            <div class="panel-title" data-i18n="p_liq_title">DEX Registry liquidity checks</div>
            <div class="panel-sub" data-i18n="p_liq_sub">
              We check PancakeSwap (BSC) / Uniswap (ETH) V2 + V3 factories. Pairs tested: token vs WBNB/WETH and token vs USDT.
            </div>
          </div>
          <div class="panel-actions">
            <div class="pill"><span data-i18n="pill_wallet">Wallet</span>: <span class="mono" id="liq-wallet" data-i18n="wallet_not_connected">not connected</span></div>
            <button class="btn btn-ghost" id="btnCloseLiq" data-i18n="btn_close">Close</button>
          </div>
        </div>

        <div class="grid-2">
          <div class="card">
            <h3 data-i18n="liq_input_title">Token + Network</h3>

            <div class="field">
              <div class="label" data-i18n="net_label">Network</div>
              <select id="liq-net">
                <option value="bsc">BSC (BNB Chain)</option>
                <option value="eth">Ethereum</option>
              </select>
            </div>

            <div class="field">
              <div class="label" data-i18n="addr_label">Token contract</div>
              <input id="liq-token" class="mono" placeholder="0x..." />
              <div class="small" style="margin-top:8px" data-i18n="liq_tip">
                Tip: open with <span class="mono">?tool=liq&net=bsc&token=0x...</span> to auto-run.
              </div>
            </div>

            <div class="field">
              <div class="label" data-i18n="liq_dex_label">DEX registry (checked)</div>
              <div class="small" id="liq-dex-note" style="margin-top:6px;"></div>
            </div>

            <div class="field">
              <div class="row">
                <button class="btn btn-primary" id="liq-run" data-i18n="btn_scan">Scan</button>
                <button class="btn btn-ghost" id="liq-copy-link" data-i18n="btn_copy_link">Copy Share Link</button>
                <button class="btn btn-ghost" id="liq-share-x" data-i18n="btn_share_x">Share to X</button>
              </div>
            </div>

            <div id="liq-status" class="status info"></div>
          </div>

          <div class="card">
            <h3 data-i18n="liq_results_title">Liquidity Results</h3>
            <div class="small" data-i18n="liq_results_hint">
              V2: pair + reserves snapshot. V3: pool existence + liquidity() + slot0 tick snapshot.
            </div>

            <div id="liq-out" class="status info" style="display:block; margin-top:10px;" data-i18n="liq_ready_html">
            <strong>Ready.</strong><br>
            Paste a token address and click <b>Scan</b>.
            </div>

            <div id="liq-risk" class="risk-badges"></div>
            <div id="liq-tablewrap" style="margin-top:10px;"></div>
          </div>
        </div>
      </section>

      <section class="panel-shell hidden" id="panel-approvals">
        <div class="panel-head">
          <div>
            <div class="panel-kicker" data-i18n="p_app_kicker">Approval Guardian</div>
            <div class="panel-title" data-i18n="p_app_title">Check and revoke allowances</div>
            <div class="panel-sub" data-i18n="p_app_sub">
              Provide spender + tokens (or seed common tokens). We read allowance(owner, spender) and revoke with approve(spender, 0).
            </div>
          </div>
          <div class="panel-actions">
            <div class="pill"><span data-i18n="pill_wallet">Wallet</span>: <span class="mono" id="ap-wallet" data-i18n="wallet_not_connected">not connected</span></div>
            <button class="btn btn-ghost" id="btnCloseApprovals" data-i18n="btn_close">Close</button>
          </div>
        </div>

        <div class="grid-2">
          <div class="card">
            <h3 data-i18n="ap_settings_title">Settings</h3>

            <div class="field">
              <div class="label" data-i18n="net_label">Network</div>
              <select id="ap-net">
                <option value="bsc" data-i18n="net_bsc">BSC (BNB Chain)</option>
                <option value="eth" data-i18n="net_eth">Ethereum</option>

              </select>
            </div>

            <div class="field">
              <div class="row" style="justify-content:space-between">
                <div class="pill"><span data-i18n="ap_connected">Connected:</span> <span id="ap-address" class="mono">‚Äî</span></div>
                <button class="btn btn-secondary" id="ap-connect" data-i18n="ap_connect">Connect / Refresh</button>
              </div>
            </div>

            <div class="field">
              <div class="label" data-i18n="ap_spender_label">Spender preset</div>
              <div class="row">
                <select id="ap-spender-preset">
                  <option value="pcs_router" data-i18n="spender_pcs_router">PancakeSwap Router (BSC)</option>
                  <option value="uni_router" data-i18n="spender_uni_router">Uniswap V2 Router (ETH)</option>
                  <option value="custom" data-i18n="spender_custom">Custom‚Ä¶</option>
                </select>
                <input id="ap-spender" class="mono" placeholder="0x spender..." data-i18n-placeholder="ph_spender" />
              </div>
              <div class="small" style="margin-top:8px" data-i18n="ap_spender_tip">
                Start with a router preset, then add tokens you want to clean up.
              </div>
            </div>

            <div class="field">
              <div class="label" data-i18n="ap_tokens_label">Token list (one per line)</div>
              <textarea id="ap-tokens" class="mono" placeholder="0x...\n0x...\n0x..." data-i18n-placeholder="ph_token_list"></textarea>
              <div class="row" style="margin-top:10px">
                <button class="btn btn-ghost" id="ap-seed-common" data-i18n="ap_seed">Seed common tokens</button>
                <button class="btn btn-ghost" id="ap-seed-history" data-i18n="ap_seed_history">Use scan history</button>
              </div>
            </div>

            <div class="field">
              <div class="row">
                <button class="btn btn-primary" id="ap-check" data-i18n="ap_check">Check Allowances</button>
                <button class="btn btn-ghost" id="ap-revoke-all" data-i18n="ap_revoke_all">Revoke All (non-zero)</button>
              </div>
              <div class="small" style="margin-top:8px" data-i18n="safe_mode_note">
                Safe mode: actions that require a signature are disabled until you connect a wallet.
              </div>
            </div>

            <div id="ap-status" class="status info"></div>
          </div>

          <div class="card">
            <h3 data-i18n="ap_results">Allowances</h3>
            <div class="small" data-i18n="ap_results_hint">
              If allowance is ‚Äúinfinite‚Äù, revoke is recommended unless you fully trust the spender.
            </div>

            <div id="ap-table" class="table" style="margin-top:12px;">
              <div class="trow head">
                <div class="cell">Token</div>
                <div class="cell">Allowance</div>
                <div class="cell hide-sm">Symbol</div>
                <div class="cell">Action</div>
              </div>
              <div class="trow">
                <div class="cell muted">‚Äî</div>
                <div class="cell muted">‚Äî</div>
                <div class="cell muted hide-sm">‚Äî</div>
                <div class="cell muted">‚Äî</div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <section class="panel-shell hidden" id="panel-rpc">
        <div class="panel-head">
          <div>
            <div class="panel-kicker" data-i18n="p_rpc_kicker">RPC Health Checker</div>
            <div class="panel-title" data-i18n="p_rpc_title">Find the best endpoint</div>
            <div class="panel-sub" data-i18n="p_rpc_sub">
              We test RPCs with latency + chainId + block + eth_call + read logs. Includes a developer custom logs test and saves the best RPC locally.
            </div>
          </div>
          <div class="panel-actions">
            <button class="btn btn-ghost" id="btnCloseRpc" data-i18n="btn_close">Close</button>
          </div>
        </div>

        <div class="grid-2">
          <div class="card">
            <h3 data-i18n="rpc_inputs">Inputs</h3>

            <div class="field">
              <div class="label" data-i18n="net_label">Network</div>
              <select id="rpc-net">
                <option value="bsc">BSC (BNB Chain)</option>
                <option value="eth">Ethereum</option>
              </select>
            </div>

            <div class="field">
              <div class="label" data-i18n="rpc_private_label">Private RPC (saved locally)</div>
              <input id="rpc-private" class="mono" placeholder="https://... (stored locally only)" data-i18n-placeholder="ph_rpc_private" />
              <div class="row" style="margin-top:10px">
                <button class="btn btn-ghost" id="rpc-private-save" style="padding:10px 14px; font-size:12px;" data-i18n="btn_save">Save</button>
                <button class="btn btn-ghost" id="rpc-private-clear" style="padding:10px 14px; font-size:12px;" data-i18n="btn_clear">Clear</button>
              </div>
              <div class="small" style="margin-top:8px" data-i18n="rpc_private_tip">
                Not embedded in HTML. Stored in your browser only (localStorage).
              </div>
            </div>

            <div class="field">
              <div class="label" data-i18n="rpc_custom_label">Optional custom RPC (top priority)</div>
              <input id="rpc-custom" class="mono" placeholder="https://..." data-i18n-placeholder="ph_rpc_custom" />
            </div>

            <div class="field">
              <div class="row">
                <button class="btn btn-primary" id="rpc-test" data-i18n="rpc_test">Test RPCs</button>
                <button class="btn btn-ghost" id="rpc-copy-best" data-i18n="rpc_copy_best">Copy Best RPC</button>
                <button class="btn btn-ghost" id="rpc-share-x" data-i18n="btn_share_x">Share to X</button>
              </div>
            </div>

            <div class="field" style="margin-top:14px">
              <h3 data-i18n="rpc_dev_title">Developer custom logs test</h3>
              <div class="small" data-i18n="rpc_dev_hint">
                Optional: test logs for a contract. This helps developers verify their own RPC stability.
              </div>

              <div class="field">
                <div class="label" data-i18n="rpc_dev_addr">Contract address (optional)</div>
                <input id="rpc-dev-addr" class="mono" placeholder="0x..." data-i18n-placeholder="ph_0x" />
              </div>

              <div class="field">
                <div class="label" data-i18n="rpc_dev_topic">Topic0 (optional)</div>
                <input id="rpc-dev-topic" class="mono" placeholder="0xddf252ad... (Transfer) or leave empty" data-i18n-placeholder="ph_rpc_dev_topic" />
              </div>

              <div class="row" style="margin-top:10px">
                <button class="btn btn-ghost" id="rpc-dev-run" style="padding:10px 14px; font-size:12px;" data-i18n="rpc_dev_run">Run custom test</button>
              </div>
            </div>

            <div id="rpc-status" class="status info"></div>
          </div>

          <div class="card">
            <h3 data-i18n="rpc_results">Results</h3>

            <div id="rpc-table" class="table">
              <div class="trow head rpc">
                <div class="cell">RPC</div>
                <div class="cell">ms</div>
                <div class="cell hide-sm">chain</div>
                <div class="cell hide-sm">block</div>
                <div class="cell hide-sm">call</div>
                <div class="cell hide-sm">logs</div>
                <div class="cell">status</div>
              </div>
            </div>

            <div class="small" style="margin-top:10px" data-i18n="rpc_tip">
              Tip: Some RPCs fail due to CORS/timeouts. Run the test and pick the stable fastest.
            </div>
          </div>
        </div>
      </section>

      <section class="panel-shell hidden" id="panel-tx">
        <div class="panel-head">
          <div>
            <div class="panel-kicker" data-i18n="p_tx_kicker">Tx Decoder</div>
            <div class="panel-title" data-i18n="p_tx_title">Decode a transaction</div>
            <div class="panel-sub" data-i18n="p_tx_sub">
              Paste a tx hash. We fetch tx + receipt and decode common inputs and events (Transfer / Approval + common swap calls).
            </div>
          </div>
          <div class="panel-actions">
            <button class="btn btn-ghost" id="btnCloseTx" data-i18n="btn_close">Close</button>
          </div>
        </div>

        <div class="grid-2">
          <div class="card">
            <h3 data-i18n="tx_input_title">Tx Input</h3>

            <div class="field">
              <div class="label" data-i18n="net_label">Network</div>
              <select id="tx-net">
                <option value="bsc">BSC (BNB Chain)</option>
                <option value="eth">Ethereum</option>
              </select>
            </div>

            <div class="field">
              <div class="label" data-i18n="tx_hash_label">Transaction hash</div>
              <input id="tx-hash" class="mono" placeholder="0x..." data-i18n-placeholder="ph_0x" />
              <div class="small" style="margin-top:8px" data-i18n="tx_tip">
                Tip: open with <span class="mono">?tool=tx&net=bsc&tx=0x...</span> to auto-run.
              </div>
            </div>

            <div class="field">
              <div class="row">
                <button class="btn btn-primary" id="tx-run" data-i18n="btn_decode">Decode</button>
                <button class="btn btn-ghost" id="tx-copy-md" data-i18n="btn_copy_md">Copy Markdown</button>
              </div>
            </div>

            <div id="tx-status" class="status info"></div>
          </div>

          <div class="card">
            <h3 data-i18n="tx_results_title">Decoded Output</h3>
            <div id="tx-out" class="status info" style="display:block; margin-top:10px;" data-i18n="tx_ready_html">
            <strong>Ready.</strong><br>
            Paste a tx hash and click <b>Decode</b>.
            </div>
            <div id="tx-events" style="margin-top:10px;"></div>
          </div>
        </div>
      </section>

      <section class="panel-shell hidden" id="panel-dev">
        <div class="panel-head">
          <div>
            <div class="panel-kicker" data-i18n="p_dev_kicker">Dev Tools</div>
            <div class="panel-title" data-i18n="p_dev_title">Bookmarklet + Local Monitor</div>
            <div class="panel-sub" data-i18n="p_dev_sub">
              Generate a bookmarklet that sends token/tx from explorers to CycleX Hub. Also includes a local contract monitor (watchlist stored in your browser).
            </div>
          </div>
          <div class="panel-actions">
            <button class="btn btn-ghost" id="btnCloseDev" data-i18n="btn_close">Close</button>
          </div>
        </div>

        <div class="grid-2">
          <div class="card">
            <h3 class="h3-row"><img src="/logo.png" alt="CycleX" /><span data-i18n="bm_title">Bookmarklet Generator</span></h3>
            <div class="small" data-i18n="bm_hint">
              Drag to bookmarks bar or copy the generated bookmarklet. Use it on BscScan/Etherscan pages.
            </div>

            <div class="field" style="margin-top:12px">
              <div class="label" data-i18n="bm_base_label">Hub URL (this page)</div>
              <input id="bm-base" class="mono" />
            </div>

            <div class="field">
              <div class="row">
                <button class="btn btn-primary" id="bm-generate" data-i18n="bm_generate">Generate</button>
                <button class="btn btn-ghost" id="bm-copy" data-i18n="bm_copy">Copy Bookmarklet</button>
              </div>
            </div>

            <div id="bm-out" class="status info"></div>
            <div id="bm-help" class="help-box">
  <strong data-i18n="bm_help_title">How to add it:</strong>
  <ol>
    <li data-i18n="bm_help_1">Click ‚ÄúGenerate‚Äù.</li>
    <li data-i18n="bm_help_2">Drag the button to your bookmarks bar (or copy it).</li>
    <li data-i18n="bm_help_3">Open BscScan/Etherscan token/tx page and click the bookmark.</li>
  </ol>
</div>

          </div>

          <div class="card">
            <h3 data-i18n="mon_list_title">Contract Monitor (local)</h3>
            <div class="small" data-i18n="mon_list_hint">Stored locally only. No server tracking.</div>

            <div class="field" style="margin-top:12px">
              <div class="label" data-i18n="net_label">Network</div>
              <select id="mon-net">
                <option value="bsc">BSC (BNB Chain)</option>
                <option value="eth">Ethereum</option>
              </select>
            </div>

            <div class="field">
              <div class="label" data-i18n="addr_label">Contract address</div>
              <input id="mon-addr" class="mono" placeholder="0x..." data-i18n-placeholder="ph_0x" />
            </div>

            <div class="field">
              <div class="row">
                <button class="btn btn-primary" id="mon-add" data-i18n="mon_add">Add</button>
                <button class="btn btn-ghost" id="mon-check" data-i18n="mon_check">Check all</button>
                <button class="btn btn-ghost" id="mon-export" data-i18n="mon_export">Copy JSON</button>
              </div>
            </div>

            <div id="mon-status" class="status info"></div>

            <div id="mon-table" class="table" style="margin-top:12px;">
              <div class="trow head">
                <div class="cell" data-i18n="th_contract">Contract</div>
                <div class="cell" data-i18n="th_network">Network</div>
                <div class="cell hide-sm" data-i18n="th_last_seen">Last seen</div>
                <div class="cell" data-i18n="th_status">Status</div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <footer class="footer">
        <div data-i18n="footer_left">
          CycleX Security Hub runs client-side and reads public on-chain data.
        </div>
        <div class="footer-tagline" data-i18n="footer_tagline">
          Verify twice. Connect only when you trust the page.
        </div>
      </footer>

    </main>
  </div>
  <!-- ethers -->
  <script src="https://cdn.jsdelivr.net/npm/ethers@6.7.1/dist/ethers.umd.min.js"></script>

  <!-- AppKit + App logic -->
  <script type="module">
    "use strict";

    const E = window.ethers;

    // =========================
    // AppKit (Reown)
    // =========================
    import { createAppKit } from "https://esm.sh/@reown/appkit@1.8.15";
    import { EthersAdapter } from "https://esm.sh/@reown/appkit-adapter-ethers@1.8.15";
    import { bsc, mainnet } from "https://esm.sh/@reown/appkit/networks";

    const APPKIT_PROJECT_ID = "7886bcb95105e9e47337cec481d5de75";

    const appkit = createAppKit({
      adapters: [new EthersAdapter()],
      networks: [bsc, mainnet],
      defaultNetwork: bsc,
      projectId: APPKIT_PROJECT_ID,
      analytics: false,
      metadata: {
        name: "CycleX",
        description: "CycleX Security Hub",
        url: window.location.origin,
        icons: [`${window.location.origin}/logo.png`]
      }
    });

    window.CxAppKitModal = appkit;

    async function waitForWalletProvider(timeoutMs = 12000) {
      const start = Date.now();
      while (Date.now() - start < timeoutMs) {
        try {
          const p = window.CxAppKitModal?.getWalletProvider?.();
          if (p) return p;
        } catch {}
        await new Promise(r => setTimeout(r, 250));
      }
      return null;
    }

   // =========================
// i18n (4 languages)
// =========================
const translations = {
  en: {
    // header / hero
    brand_sub: "On-Chain Security & Rewards",
    hero_kicker: "Security Hub",
    hero_title: "CycleX Security Tools",
    hero_subtitle:
      "A lightweight, client-side toolkit for safer swaps, approvals hygiene, liquidity checks, RPC health, and transaction decoding across BSC + Ethereum.",
    btn_back: "Back to Site",
    btn_connect: "Connect Wallet (optional)",
    wallet_not_connected: "not connected",
    btn_quick: "Run Quick Scan",
    hero_note:
      "Note: These checks are informational and do not guarantee safety. Always verify independently.",
    tools_kicker: "CHOOSE A TOOL",

    // tiles
    cube_quick_title: "Quick Scan",
    cube_quick_desc: "Fast token sanity-check + shareable report + cache.",
    cube_liq_title: "Token + Liquidity Scan",
    cube_liq_desc: "DEX registry checks (Pancake/Uni): token vs WBNB/WETH and USDT.",
    cube_approvals_title: "Approval Guardian",
    cube_approvals_desc: "Check and revoke ERC-20 allowances safely (approve ‚Üí 0).",
    cube_rpc_title: "RPC Health Checker",
    cube_rpc_desc: "Latency + chainId + block + eth_call + read logs + dev custom test.",
    cube_tx_title: "Tx Decoder",
    cube_tx_desc: "Decode inputs + common events (Transfer/Approval) from a tx hash.",
    cube_dev_title: "Dev Tools",
    cube_dev_desc: "Bookmarklet generator + local contract monitor (no server).",

    // tile badges
    badge_fast: "Fast",
    badge_share: "Share",
    badge_cache: "Cache",
    badge_dex: "DEX",
    badge_pairs: "Pairs",
    badge_wallet: "Wallet",
    badge_safe: "Safe",
    badge_copy: "Copy",
    badge_dev: "Dev",
    badge_decode: "Decode",
    badge_receipt: "Receipt",
    badge_events: "Events",
    badge_tools: "Tools",
    badge_bookmarklet: "Bookmarklet",
    badge_local: "Local",

    // generic
    pill_wallet: "Wallet",
    btn_close: "Close",
    btn_save: "Save",
    btn_clear: "Clear",
    btn_scan: "Scan",
    btn_decode: "Decode",
    btn_copy_md: "Copy Markdown",
    btn_copy_link: "Copy Share Link",
    btn_copy_json: "Copy JSON",
    btn_copy_xtext: "Copy X text",

    // quick panel
    p_quick_kicker: "Quick Scan",
    p_quick_title: "Score a token in seconds",
    p_quick_sub:
      "Paste a token address, choose network, run scan. Cached for 10 minutes. Generate shareable text + JSON + Markdown.",
    quick_input_title: "Token Input",
    net_label: "Network",
    addr_label: "Token contract",
    qs_tip:
      'Tip: open with <span class="mono">?tool=quick&net=bsc&token=0x...</span> to auto-run (rate-limited).',
    options_label: "Options",
    opt_require_liq: "Require liquidity (stricter score)",
    opt_show_json: "Enable JSON report (copy)",
    api_keys_label: "Explorer API keys (optional)",
    opt_use_explorer_apis: "Use BscScan/Etherscan (adds Verified + ABI heuristics)",
    api_keys_tip:
      "Keys are saved in your browser (localStorage) only. Do not paste keys into public HTML.",
    results_title: "Results",
    results_hint:
      "Green / Yellow / Red signals. Not a guarantee ‚Äî just verifiable on-chain checks.",

    // liquidity panel
    p_liq_kicker: "Token + Liquidity Scan",
    p_liq_title: "DEX registry liquidity checks",
    p_liq_sub:
      "We check PancakeSwap (BSC) / Uniswap (ETH) V2 + V3 factories. Pairs tested: token vs WBNB/WETH and token vs USDT.",
    liq_input_title: "Token + Network",
    liq_tip:
      'Tip: open with <span class="mono">?tool=liq&net=bsc&token=0x...</span> to auto-run.',
    liq_dex_label: "DEX registry (checked)",
    liq_results_title: "Liquidity Results",
    liq_results_hint:
      "V2: pair + reserves snapshot. V3: pool existence + liquidity() + slot0 tick snapshot.",

    
    // approvals panel
    p_app_kicker: "Approval Guardian",
    p_app_title: "Check and revoke allowances",
    p_app_sub:
      "Provide spender + tokens (or seed common tokens). We read allowance(owner, spender) and revoke with approve(spender, 0).",
    ap_settings_title: "Settings",
    ap_connected: "Connected:",
    ap_connect: "Connect / Refresh",
    ap_spender_label: "Spender preset",
    ap_spender_tip:
      "Start with a router preset, then add tokens you want to clean up.",
    ap_tokens_label: "Token list (one per line)",
    ap_seed: "Seed common tokens",
    ap_seed_history: "Use scan history",
    ap_check: "Check Allowances",
    ap_revoke_all: "Revoke All (non-zero)",
    ap_results: "Allowances",
    ap_results_hint:
      "If allowance is ‚Äúinfinite‚Äù, revoke is recommended unless you fully trust the spender.",
    safe_mode_note:
      "Safe mode: actions that require a signature are disabled until you connect a wallet.",

    // rpc panel
    p_rpc_kicker: "RPC Health Checker",
    p_rpc_title: "Find the best endpoint",
    p_rpc_sub:
      "We test RPCs with latency + chainId + block + eth_call + read logs. Includes a developer custom logs test and saves the best RPC locally.",
    rpc_inputs: "Inputs",
    rpc_private_label: "Private RPC (saved locally)",
    rpc_private_tip:
      "Not embedded in HTML. Stored in your browser only (localStorage).",
    rpc_custom_label: "Optional custom RPC (top priority)",
    rpc_test: "Test RPCs",
    rpc_copy_best: "Copy Best RPC",
    rpc_results: "Results",
    rpc_tip:
      "Tip: Some RPCs fail due to CORS/timeouts. Run the test and pick the stable fastest.",
    rpc_dev_title: "Developer custom logs test",
    rpc_dev_hint:
      "Optional: test logs for a contract. This helps developers verify their own RPC stability.",
    rpc_dev_addr: "Contract address (optional)",
    rpc_dev_topic: "Topic0 (optional)",
    rpc_dev_run: "Run custom test",

    // tx panel
    p_tx_kicker: "Tx Decoder",
    p_tx_title: "Decode a transaction",
    p_tx_sub:
      "Paste a tx hash. We fetch tx + receipt and decode common inputs and events (Transfer / Approval + common swap calls).",
    tx_input_title: "Tx Input",
    tx_hash_label: "Transaction hash",
    tx_tip:
      'Tip: open with <span class="mono">?tool=tx&net=bsc&tx=0x...</span> to auto-run.',
    tx_results_title: "Decoded Output",

    // dev panel
    p_dev_kicker: "Dev Tools",
    p_dev_title: "Bookmarklet + Local Monitor",
    p_dev_sub:
      "Generate a bookmarklet that sends token/tx from explorers to CycleX Hub. Also includes a local contract monitor (watchlist stored in your browser).",
    bm_title: "Bookmarklet Generator",
    bm_hint:
      "Drag to bookmarks bar or copy the generated bookmarklet. Use it on BscScan/Etherscan pages.",
    bm_base_label: "Hub URL (this page)",
    bm_generate: "Generate",
    bm_copy: "Copy Bookmarklet",

    mon_add_title: "Add to watchlist",
    mon_list_title: "Contract Monitor (local)",
    mon_list_hint: "Stored locally only. No server tracking.",
    mon_add: "Add",
    mon_check: "Check all",
    mon_export: "Copy JSON",

    // footer
    footer_left:
      "CycleX Security Hub runs client-side and reads public on-chain data.",
    footer_tagline: "Verify twice. Connect only when you trust the page.",
    // --- ADD THESE KEYS (EN) ---
title_back_to_cyclex: "Back to CycleX",
aria_lang_selector: "Language selector",
badge_table: "Table",
btn_share_x: "Share to X",
btn_share_tg: "Share to Telegram",
net_bsc: "BSC (BNB Chain)",
net_eth: "Ethereum",
spender_pcs_router: "PancakeSwap Router (BSC)",
spender_uni_router: "Uniswap V2 Router (ETH)",
spender_custom: "Custom‚Ä¶",

th_token: "Token",
th_allowance: "Allowance",
th_symbol: "Symbol",
th_action: "Action",
th_rpc: "RPC",
th_ms: "ms",
th_chain: "chain",
th_block: "block",
th_call: "call",
th_logs: "logs",
th_status: "status",
th_contract: "Contract",
th_network: "Network",
th_last_seen: "Last seen",
    th_pairpool: "Pair/Pool",
th_type: "Type",
th_target: "Target",
th_result: "Result",
btn_remove: "Remove",
toast_imported_token: "Imported token from explorer:",
toast_imported_tx: "Imported tx from explorer:",
err_no_working_rpc: "No working RPC found. Open RPC tool and set a working endpoint.",


qs_ready_html: "<strong>Ready.</strong><br>Paste a token address and click <b>Scan</b>.",
liq_ready_html: "<strong>Ready.</strong><br>Paste a token address and click <b>Scan</b>.",
tx_ready_html: "<strong>Ready.</strong><br>Paste a tx hash and click <b>Decode</b>.",

ph_0x: "0x...",
ph_spender: "0x spender...",
ph_token_list: "0x...\n0x...\n0x...",
ph_bscscan_key: "BscScan API key (stored locally)",
ph_etherscan_key: "Etherscan API key (stored locally)",
ph_rpc_private: "https://... (stored locally only)",
ph_rpc_custom: "https://...",
ph_rpc_dev_topic: "0xddf252ad... (Transfer) or leave empty"

    
  },

  zh: {
    // header / hero
    brand_sub: "Èìæ‰∏äÂÆâÂÖ®‰∏éÂ•ñÂä±",
    hero_kicker: "ÂÆâÂÖ®‰∏≠ÂøÉ",
    hero_title: "CycleX ÂÆâÂÖ®Â∑•ÂÖ∑",
    hero_subtitle:
      "ËΩªÈáèÁ∫ßÂÆ¢Êà∑Á´ØÂ∑•ÂÖ∑ÔºöÊõ¥ÂÆâÂÖ®ÁöÑ‰∫§Êç¢„ÄÅÊéàÊùÉÁÆ°ÁêÜ„ÄÅÊµÅÂä®ÊÄßÊ£ÄÊü•„ÄÅRPC ÂÅ•Â∫∑Ê£ÄÊµã‰∏é‰∫§ÊòìËß£Á†ÅÔºàBSC + ‰ª•Â§™ÂùäÔºâ„ÄÇ",
    btn_back: "ËøîÂõû‰∏ªÁ´ô",
    btn_connect: "ËøûÊé•Èí±ÂåÖÔºàÂèØÈÄâÔºâ",
    wallet_not_connected: "Êú™ËøûÊé•",
    btn_quick: "ËøêË°åÂø´ÈÄüÊâ´Êèè",
    hero_note:
      "ÊèêÁ§∫ÔºöËøô‰∫õÊ£ÄÊü•‰ªÖ‰æõÂèÇËÄÉÔºå‰∏ç‰øùËØÅÂÆâÂÖ®„ÄÇËØ∑Âä°ÂøÖËá™Ë°åÈ™åËØÅ„ÄÇ",
    tools_kicker: "ÈÄâÊã©Â∑•ÂÖ∑",

    // tiles
    cube_quick_title: "Âø´ÈÄüÊâ´Êèè",
    cube_quick_desc: "Âø´ÈÄü‰ª£Â∏Å‰ΩìÊ£Ä + ÂèØÂàÜ‰∫´Êä•Âëä + ÁºìÂ≠ò„ÄÇ",
    cube_liq_title: "‰ª£Â∏Å + ÊµÅÂä®ÊÄßÊâ´Êèè",
    cube_liq_desc: "DEX Ê£ÄÊü•ÔºàPancake/UniÔºâÔºö‰ª£Â∏Å vs WBNB/WETH ‰∏é USDT„ÄÇ",
    cube_approvals_title: "ÊéàÊùÉÂç´Â£´",
    cube_approvals_desc: "Ê£ÄÊü•Âπ∂ÂÆâÂÖ®Êí§ÈîÄ ERC-20 ÊéàÊùÉÔºàapprove ‚Üí 0Ôºâ„ÄÇ",
    cube_rpc_title: "RPC ÂÅ•Â∫∑Ê£ÄÊµã",
    cube_rpc_desc: "Âª∂Ëøü + chainId + Âå∫Âùó + eth_call + ËØªÂèñ logs + ÂºÄÂèëËá™ÂÆö‰πâÊµãËØï„ÄÇ",
    cube_tx_title: "‰∫§ÊòìËß£Á†Å",
    cube_tx_desc: "‰ªé‰∫§ÊòìÂìàÂ∏åËß£Á†ÅËæìÂÖ•‰∏éÂ∏∏ËßÅ‰∫ã‰ª∂ÔºàTransfer/ApprovalÔºâ„ÄÇ",
    cube_dev_title: "ÂºÄÂèëÂ∑•ÂÖ∑",
    cube_dev_desc: "‰π¶Á≠æËÑöÊú¨ÁîüÊàêÂô® + Êú¨Âú∞ÂêàÁ∫¶ÁõëÊéßÔºàÊó†ÊúçÂä°Âô®Ôºâ„ÄÇ",

    // tile badges
    badge_fast: "Âø´ÈÄü",
    badge_share: "ÂàÜ‰∫´",
    badge_cache: "ÁºìÂ≠ò",
    badge_dex: "DEX",
    badge_pairs: "‰∫§ÊòìÂØπ",
    badge_wallet: "Èí±ÂåÖ",
    badge_safe: "ÂÆâÂÖ®",
    badge_copy: "Â§çÂà∂",
    badge_dev: "ÂºÄÂèë",
    badge_decode: "Ëß£Á†Å",
    badge_receipt: "ÂõûÊâß",
    badge_events: "‰∫ã‰ª∂",
    badge_tools: "Â∑•ÂÖ∑",
    badge_bookmarklet: "‰π¶Á≠æËÑöÊú¨",
    badge_local: "Êú¨Âú∞",

    // generic
    pill_wallet: "Èí±ÂåÖ",
    btn_close: "ÂÖ≥Èó≠",
    btn_save: "‰øùÂ≠ò",
    btn_clear: "Ê∏ÖÈô§",
    btn_scan: "Êâ´Êèè",
    btn_decode: "Ëß£Á†Å",
    btn_copy_md: "Â§çÂà∂ Markdown",
    btn_copy_link: "Â§çÂà∂ÂàÜ‰∫´ÈìæÊé•",
    btn_copy_json: "Â§çÂà∂ JSON",
    btn_copy_xtext: "Â§çÂà∂ X ÊñáÊ°à",

    // quick panel
    p_quick_kicker: "Âø´ÈÄüÊâ´Êèè",
    p_quick_title: "Âá†ÁßíÂÜÖÁªô‰ª£Â∏ÅÊâìÂàÜ",
    p_quick_sub:
      "Á≤òË¥¥‰ª£Â∏ÅÂú∞ÂùÄÔºåÈÄâÊã©ÁΩëÁªúÂπ∂Êâ´Êèè„ÄÇÁºìÂ≠ò 10 ÂàÜÈíü„ÄÇÂèØÁîüÊàêÂèØÂàÜ‰∫´ÊñáÊú¨ + JSON + Markdown„ÄÇ",
    quick_input_title: "‰ª£Â∏ÅËæìÂÖ•",
    net_label: "ÁΩëÁªú",
    addr_label: "‰ª£Â∏ÅÂêàÁ∫¶",
    qs_tip:
      'ÊèêÁ§∫ÔºöÂèØÁî® <span class="mono">?tool=quick&net=bsc&token=0x...</span> ÊâìÂºÄËá™Âä®ËøêË°åÔºàÈôêÈÄüÔºâ„ÄÇ',
    options_label: "ÈÄâÈ°π",
    opt_require_liq: "Ë¶ÅÊ±ÇÊúâÊµÅÂä®ÊÄßÔºàÊõ¥‰∏•Ê†ºËØÑÂàÜÔºâ",
    opt_show_json: "ÂêØÁî® JSON Êä•ÂëäÔºàÂèØÂ§çÂà∂Ôºâ",
    api_keys_label: "Âå∫ÂùóÊµèËßàÂô® API KeyÔºàÂèØÈÄâÔºâ",
    opt_use_explorer_apis: "‰ΩøÁî® BscScan/EtherscanÔºàÂ¢ûÂä† Verified + ABI ËßÑÂàôÔºâ",
    api_keys_tip:
      "Key ‰ªÖ‰øùÂ≠òÂú®ÊµèËßàÂô®Êú¨Âú∞ÔºàlocalStorageÔºâ„ÄÇ‰∏çË¶ÅÊää Key ÂÜôËøõÂÖ¨ÂºÄ HTML„ÄÇ",
    results_title: "ÁªìÊûú",
    results_hint:
      "ÁªøËâ≤ / ÈªÑËâ≤ / Á∫¢Ëâ≤‰ø°Âè∑„ÄÇ‰∏çÊòØ‰øùËØÅ‚Äî‚ÄîÂè™ÊòØÂèØÈ™åËØÅÁöÑÈìæ‰∏äÊ£ÄÊü•„ÄÇ",

    // liquidity panel
    p_liq_kicker: "‰ª£Â∏Å + ÊµÅÂä®ÊÄßÊâ´Êèè",
    p_liq_title: "DEX Ê≥®ÂÜåË°®ÊµÅÂä®ÊÄßÊ£ÄÊü•",
    p_liq_sub:
      "Ê£ÄÊü• PancakeSwapÔºàBSCÔºâ/ UniswapÔºàETHÔºâV2 + V3 Â∑•ÂéÇ„ÄÇÊµãËØï‰∫§ÊòìÂØπÔºö‰ª£Â∏Å vs WBNB/WETH ‰∏é‰ª£Â∏Å vs USDT„ÄÇ",
    liq_input_title: "‰ª£Â∏Å + ÁΩëÁªú",
    liq_tip:
      'ÊèêÁ§∫ÔºöÂèØÁî® <span class="mono">?tool=liq&net=bsc&token=0x...</span> ÊâìÂºÄËá™Âä®ËøêË°å„ÄÇ',
    liq_dex_label: "DEX Ê≥®ÂÜåË°®ÔºàÂ∑≤Ê£ÄÊü•Ôºâ",
    liq_results_title: "ÊµÅÂä®ÊÄßÁªìÊûú",
    liq_results_hint:
      "V2Ôºö‰∫§ÊòìÂØπ + ÂÇ®Â§áÂø´ÁÖß„ÄÇV3ÔºöÊ±†Â≠êÂ≠òÂú®ÊÄß + liquidity() + slot0 tick Âø´ÁÖß„ÄÇ",

    // approvals panel
    p_app_kicker: "ÊéàÊùÉÂç´Â£´",
    p_app_title: "Ê£ÄÊü•Âπ∂Êí§ÈîÄÊéàÊùÉ",
    p_app_sub:
      "Â°´ÂÜô spender + ‰ª£Â∏ÅÂàóË°®ÔºàÊàñ‰∏ÄÈîÆÂ°´ÂÖ•Â∏∏Áî®‰ª£Â∏ÅÔºâ„ÄÇËØªÂèñ allowance(owner, spender)ÔºåÂπ∂Áî® approve(spender, 0) Êí§ÈîÄ„ÄÇ",
    ap_settings_title: "ËÆæÁΩÆ",
    ap_connected: "Â∑≤ËøûÊé•Ôºö",
    ap_connect: "ËøûÊé• / Âà∑Êñ∞",
    ap_spender_label: "Spender È¢ÑËÆæ",
    ap_spender_tip: "ÂÖàÈÄâË∑ØÁî±È¢ÑËÆæÔºåÂÜçÊ∑ªÂä†‰Ω†ÊÉ≥Ê∏ÖÁêÜÁöÑ‰ª£Â∏Å„ÄÇ",
    ap_tokens_label: "‰ª£Â∏ÅÂàóË°®ÔºàÊØèË°å‰∏Ä‰∏™Ôºâ",
    ap_seed: "Â°´ÂÖ•Â∏∏Áî®‰ª£Â∏Å",
    ap_seed_history: "‰ΩøÁî®Êâ´ÊèèÂéÜÂè≤",
    ap_check: "Ê£ÄÊü•ÊéàÊùÉ",
    ap_revoke_all: "Êí§ÈîÄÂÖ®ÈÉ®ÔºàÈùûÈõ∂Ôºâ",
    ap_results: "ÊéàÊùÉÂàóË°®",
    ap_results_hint:
      "Ëã•ÊéàÊùÉ‰∏∫‚ÄúÊó†Èôê‚ÄùÔºåÈô§Èùû‰Ω†ÂÆåÂÖ®‰ø°‰ªªËØ• spenderÔºåÂê¶ÂàôÂª∫ËÆÆÊí§ÈîÄ„ÄÇ",
    safe_mode_note:
      "ÂÆâÂÖ®Ê®°ÂºèÔºöÈúÄË¶ÅÁ≠æÂêçÁöÑÊìç‰Ωú‰ºöÂú®ËøûÊé•Èí±ÂåÖÂâçË¢´Á¶ÅÁî®„ÄÇ",

    // rpc panel
    p_rpc_kicker: "RPC ÂÅ•Â∫∑Ê£ÄÊµã",
    p_rpc_title: "ÊâæÂà∞ÊúÄ‰Ω≥ËäÇÁÇπ",
    p_rpc_sub:
      "ÊµãËØï RPCÔºöÂª∂Ëøü + chainId + Âå∫Âùó + eth_call + ËØªÂèñ logs„ÄÇÂåÖÂê´ÂºÄÂèëËÄÖËá™ÂÆö‰πâ logs ÊµãËØïÔºåÂπ∂ÊääÊúÄ‰Ω≥ RPC Â≠òÂà∞Êú¨Âú∞„ÄÇ",
    rpc_inputs: "ËæìÂÖ•",
    rpc_private_label: "ÁßÅÊúâ RPCÔºàÊú¨Âú∞‰øùÂ≠òÔºâ",
    rpc_private_tip:
      "‰∏ç‰ºöÂÜôËøõ HTMLÔºåÂè™‰øùÂ≠òÂú®‰Ω†ÁöÑÊµèËßàÂô®ÔºàlocalStorageÔºâ„ÄÇ",
    rpc_custom_label: "ÂèØÈÄâËá™ÂÆö‰πâ RPCÔºà‰ºòÂÖàÁ∫ßÊúÄÈ´òÔºâ",
    rpc_test: "ÊµãËØï RPC",
    rpc_copy_best: "Â§çÂà∂ÊúÄ‰Ω≥ RPC",
    rpc_results: "ÁªìÊûú",
    rpc_tip:
      "ÊèêÁ§∫ÔºöÈÉ®ÂàÜ RPC ‰ºöÂõ† CORS/Ë∂ÖÊó∂Â§±Ë¥•„ÄÇËøêË°åÊµãËØïÂπ∂ÈÄâÊã©Á®≥ÂÆö‰∏îÊúÄÂø´ÁöÑ„ÄÇ",
    rpc_dev_title: "ÂºÄÂèëËÄÖËá™ÂÆö‰πâ logs ÊµãËØï",
    rpc_dev_hint:
      "ÂèØÈÄâÔºöÂØπÊüêÂêàÁ∫¶ÊµãËØï logsÔºåÂ∏ÆÂä©ÂºÄÂèëËÄÖÈ™åËØÅ RPC ÁöÑÁ®≥ÂÆöÊÄß„ÄÇ",
    rpc_dev_addr: "ÂêàÁ∫¶Âú∞ÂùÄÔºàÂèØÈÄâÔºâ",
    rpc_dev_topic: "Topic0ÔºàÂèØÈÄâÔºâ",
    rpc_dev_run: "ËøêË°åËá™ÂÆö‰πâÊµãËØï",

    // tx panel
    p_tx_kicker: "‰∫§ÊòìËß£Á†Å",
    p_tx_title: "Ëß£Á†Å‰∏ÄÁ¨î‰∫§Êòì",
    p_tx_sub:
      "Á≤òË¥¥‰∫§ÊòìÂìàÂ∏å„ÄÇËé∑Âèñ tx + receiptÔºåÂπ∂Ëß£Á†ÅÂ∏∏ËßÅËæìÂÖ•‰∏é‰∫ã‰ª∂ÔºàTransfer / Approval + Â∏∏ËßÅ swap Ë∞ÉÁî®Ôºâ„ÄÇ",
    tx_input_title: "‰∫§ÊòìËæìÂÖ•",
    tx_hash_label: "‰∫§ÊòìÂìàÂ∏å",
    tx_tip:
      'ÊèêÁ§∫ÔºöÂèØÁî® <span class="mono">?tool=tx&net=bsc&tx=0x...</span> ÊâìÂºÄËá™Âä®ËøêË°å„ÄÇ',
    tx_results_title: "Ëß£Á†ÅËæìÂá∫",

    // dev panel
    p_dev_kicker: "ÂºÄÂèëÂ∑•ÂÖ∑",
    p_dev_title: "‰π¶Á≠æËÑöÊú¨ + Êú¨Âú∞ÁõëÊéß",
    p_dev_sub:
      "ÁîüÊàê‰π¶Á≠æËÑöÊú¨ÔºåÊääÊµèËßàÂô®È°µÈù¢‰∏äÁöÑ‰ª£Â∏Å/‰∫§Êòì‰∏ÄÈîÆÂèëÈÄÅÂà∞ CycleX Hub„ÄÇ‰πüÂåÖÂê´Êú¨Âú∞ÂêàÁ∫¶ÁõëÊéßÔºàÂàóË°®‰øùÂ≠òÂú®ÊµèËßàÂô®Ôºâ„ÄÇ",
    bm_title: "‰π¶Á≠æËÑöÊú¨ÁîüÊàêÂô®",
    bm_hint:
      "ÊãñÂà∞‰π¶Á≠æÊ†èÊàñÂ§çÂà∂ÁîüÊàêÁöÑ‰π¶Á≠æËÑöÊú¨„ÄÇÂú® BscScan/Etherscan È°µÈù¢‰ΩøÁî®„ÄÇ",
    bm_base_label: "Hub URLÔºàÂΩìÂâçÈ°µÈù¢Ôºâ",
    bm_generate: "ÁîüÊàê",
    bm_copy: "Â§çÂà∂‰π¶Á≠æËÑöÊú¨",

    mon_add_title: "Âä†ÂÖ•ÁõëÊéßÂàóË°®",
    mon_list_title: "ÂêàÁ∫¶ÁõëÊéßÔºàÊú¨Âú∞Ôºâ",
    mon_list_hint: "‰ªÖÊú¨Âú∞‰øùÂ≠ò„ÄÇÊó†ÊúçÂä°Âô®Ë∑üË∏™„ÄÇ",
    mon_add: "Ê∑ªÂä†",
    mon_check: "ÂÖ®ÈÉ®Ê£ÄÊü•",
    mon_export: "Â§çÂà∂ JSON",

    // footer
    footer_left: "CycleX ÂÆâÂÖ®‰∏≠ÂøÉÂú®Êú¨Âú∞ËøêË°åÔºåËØªÂèñÂÖ¨ÂºÄÈìæ‰∏äÊï∞ÊçÆ„ÄÇ",
    footer_tagline: "Â§öÈ™åËØÅ‰∏ÄÊ¨°„ÄÇÂè™Âú®‰ø°‰ªªÈ°µÈù¢Êó∂ËøûÊé•Èí±ÂåÖ„ÄÇ",
    // --- ADD THESE KEYS (ZH) ---
title_back_to_cyclex: "ËøîÂõû CycleX",
aria_lang_selector: "ËØ≠Ë®ÄÈÄâÊã©",
badge_table: "Ë°®Ê†º",
btn_share_x: "ÂàÜ‰∫´Âà∞ X",
btn_share_tg: "ÂàÜ‰∫´Âà∞ Telegram",
net_bsc: "BSCÔºàBNB ChainÔºâ",
net_eth: "‰ª•Â§™Âùä",
spender_pcs_router: "PancakeSwap Ë∑ØÁî±Âô®ÔºàBSCÔºâ",
spender_uni_router: "Uniswap V2 Ë∑ØÁî±Âô®ÔºàETHÔºâ",
spender_custom: "Ëá™ÂÆö‰πâ‚Ä¶",

th_token: "‰ª£Â∏Å",
th_allowance: "ÊéàÊùÉÈ¢ùÂ∫¶",
th_symbol: "Á¨¶Âè∑",
th_action: "Êìç‰Ωú",
th_rpc: "RPC",
th_ms: "ÊØ´Áßí",
th_chain: "Èìæ",
th_block: "Âå∫Âùó",
th_call: "Ë∞ÉÁî®",
th_logs: "Êó•Âøó",
th_status: "Áä∂ÊÄÅ",
th_contract: "ÂêàÁ∫¶",
th_network: "ÁΩëÁªú",
th_last_seen: "‰∏äÊ¨°Âá∫Áé∞",
    th_pairpool: "‰∫§ÊòìÂØπ/Ê±†",
th_type: "Á±ªÂûã",
th_target: "ÁõÆÊ†á",
th_result: "ÁªìÊûú",
btn_remove: "ÁßªÈô§",
toast_imported_token: "Â∑≤‰ªéÊµèËßàÂô®ÂØºÂÖ•‰ª£Â∏ÅÔºö",
toast_imported_tx: "Â∑≤‰ªéÊµèËßàÂô®ÂØºÂÖ•‰∫§ÊòìÔºö",
err_no_working_rpc: "Êú™ÊâæÂà∞ÂèØÁî® RPC„ÄÇËØ∑Âú® RPC Â∑•ÂÖ∑‰∏≠ËÆæÁΩÆÂèØÁî®ËäÇÁÇπ„ÄÇ",


qs_ready_html: "<strong>ÂáÜÂ§áÂ∞±Áª™„ÄÇ</strong><br>Á≤òË¥¥‰ª£Â∏ÅÂú∞ÂùÄÂπ∂ÁÇπÂáª <b>Êâ´Êèè</b>„ÄÇ",
liq_ready_html: "<strong>ÂáÜÂ§áÂ∞±Áª™„ÄÇ</strong><br>Á≤òË¥¥‰ª£Â∏ÅÂú∞ÂùÄÂπ∂ÁÇπÂáª <b>Êâ´Êèè</b>„ÄÇ",
tx_ready_html: "<strong>ÂáÜÂ§áÂ∞±Áª™„ÄÇ</strong><br>Á≤òË¥¥‰∫§ÊòìÂìàÂ∏åÂπ∂ÁÇπÂáª <b>Ëß£Á†Å</b>„ÄÇ",

ph_0x: "0x...",
ph_spender: "0x spender...",
ph_token_list: "0x...\n0x...\n0x...",
ph_bscscan_key: "BscScan API KeyÔºàÊú¨Âú∞‰øùÂ≠òÔºâ",
ph_etherscan_key: "Etherscan API KeyÔºàÊú¨Âú∞‰øùÂ≠òÔºâ",
ph_rpc_private: "https://...Ôºà‰ªÖÊú¨Âú∞‰øùÂ≠òÔºâ",
ph_rpc_custom: "https://...",
ph_rpc_dev_topic: "0xddf252ad...ÔºàTransferÔºâÊàñÁïôÁ©∫"

  },

  ar: {
    // header / hero
    brand_sub: "ÿ£ŸÖÿßŸÜ ŸàŸÖŸÉÿßŸÅÿ¢ÿ™ ÿπŸÑŸâ ÿßŸÑÿ≥ŸÑÿ≥ŸÑÿ©",
    hero_kicker: "ŸÖÿ±ŸÉÿ≤ ÿßŸÑÿ£ŸÖÿßŸÜ",
    hero_title: "ÿ£ÿØŸàÿßÿ™ CycleX ÿßŸÑÿ£ŸÖŸÜŸäÿ©",
    hero_subtitle:
      "ŸÖÿ¨ŸÖŸàÿπÿ© ÿÆŸÅŸäŸÅÿ© ÿ™ÿπŸÖŸÑ ÿπŸÑŸâ ÿßŸÑŸÖÿ™ÿµŸÅÿ≠: swaps ÿ£ŸÉÿ´ÿ± ÿ£ŸÖÿßŸÜÿßŸãÿå ÿ•ÿØÿßÿ±ÿ© approvalsÿå ŸÅÿ≠ÿµ ÿßŸÑÿ≥ŸäŸàŸÑÿ©ÿå ÿµÿ≠ÿ© RPCÿå ŸàŸÅŸÉ ÿ™ÿ¥ŸÅŸäÿ± ÿßŸÑŸÖÿπÿßŸÖŸÑÿßÿ™ ÿπÿ®ÿ± BSC + Ethereum.",
    btn_back: "ÿßŸÑÿπŸàÿØÿ© ŸÑŸÑŸÖŸàŸÇÿπ",
    btn_connect: "ÿßÿ™ÿµÿßŸÑ ÿßŸÑŸÖÿ≠ŸÅÿ∏ÿ© (ÿßÿÆÿ™Ÿäÿßÿ±Ÿä)",
    wallet_not_connected: "ÿ∫Ÿäÿ± ŸÖÿ™ÿµŸÑ",
    btn_quick: "ÿ™ÿ¥ÿ∫ŸäŸÑ ŸÅÿ≠ÿµ ÿ≥ÿ±Ÿäÿπ",
    hero_note:
      "ŸÖŸÑÿßÿ≠ÿ∏ÿ©: Ÿáÿ∞Ÿá ÿßŸÑŸÅÿ≠Ÿàÿµÿßÿ™ ŸÖÿπŸÑŸàŸÖÿßÿ™Ÿäÿ© ŸàŸÑÿß ÿ™ÿ∂ŸÖŸÜ ÿßŸÑÿ£ŸÖÿßŸÜ. ÿ™ÿ≠ŸÇŸÇ ÿØÿßÿ¶ŸÖÿßŸã ÿ®ŸÜŸÅÿ≥ŸÉ.",
    tools_kicker: "ÿßÿÆÿ™ÿ± ÿ£ÿØÿßÿ©",

    // tiles
    cube_quick_title: "ŸÅÿ≠ÿµ ÿ≥ÿ±Ÿäÿπ",
    cube_quick_desc: "ŸÅÿ≠ÿµ ÿ≥ÿ±Ÿäÿπ ŸÑŸÑÿ™ŸàŸÉŸÜ + ÿ™ŸÇÿ±Ÿäÿ± ŸÇÿßÿ®ŸÑ ŸÑŸÑŸÖÿ¥ÿßÿ±ŸÉÿ© + ŸÉÿßÿ¥.",
    cube_liq_title: "ŸÅÿ≠ÿµ ÿßŸÑÿ™ŸàŸÉŸÜ + ÿßŸÑÿ≥ŸäŸàŸÑÿ©",
    cube_liq_desc: "ŸÅÿ≠ÿµ DEX (Pancake/Uni): ÿßŸÑÿ™ŸàŸÉŸÜ ŸÖŸÇÿßÿ®ŸÑ WBNB/WETH Ÿà USDT.",
    cube_approvals_title: "ÿ≠ÿßÿ±ÿ≥ ÿßŸÑÿµŸÑÿßÿ≠Ÿäÿßÿ™",
    cube_approvals_desc: "ÿ™ÿ≠ŸÇŸÇ Ÿàÿ£ŸÑÿ∫Ÿê ÿµŸÑÿßÿ≠Ÿäÿßÿ™ ERC-20 ÿ®ÿ£ŸÖÿßŸÜ (approve ‚Üí 0).",
    cube_rpc_title: "ŸÅÿ≠ÿµ ÿµÿ≠ÿ© RPC",
    cube_rpc_desc: "ÿ≤ŸÖŸÜ ÿßŸÑÿßÿ≥ÿ™ÿ¨ÿßÿ®ÿ© + chainId + ÿ®ŸÑŸàŸÉ + eth_call + ŸÇÿ±ÿßÿ°ÿ© logs + ÿßÿÆÿ™ÿ®ÿßÿ± ŸÖÿ∑ŸàŸëÿ±.",
    cube_tx_title: "ŸÅŸÉ ÿ™ÿ¥ŸÅŸäÿ± Tx",
    cube_tx_desc: "ŸÅŸÉ ÿ™ÿ¥ŸÅŸäÿ± ÿßŸÑŸÖÿØÿÆŸÑÿßÿ™ + ÿ£ÿ≠ÿØÿßÿ´ ÿ¥ÿßÿ¶ÿπÿ© (Transfer/Approval) ŸÖŸÜ tx hash.",
    cube_dev_title: "ÿ£ÿØŸàÿßÿ™ ÿßŸÑŸÖÿ∑ŸàŸëÿ±",
    cube_dev_desc: "ŸÖŸàŸÑŸëÿØ Bookmarklet + ŸÖÿ±ÿßŸÇÿ®ÿ© ÿπŸÇÿØ ŸÖÿ≠ŸÑŸäÿ© (ÿ®ÿØŸàŸÜ ÿ≥Ÿäÿ±ŸÅÿ±).",

    // tile badges
    badge_fast: "ÿ≥ÿ±Ÿäÿπ",
    badge_share: "ŸÖÿ¥ÿßÿ±ŸÉÿ©",
    badge_cache: "ŸÉÿßÿ¥",
    badge_dex: "DEX",
    badge_pairs: "ÿ£ÿ≤Ÿàÿßÿ¨",
    badge_wallet: "ŸÖÿ≠ŸÅÿ∏ÿ©",
    badge_safe: "ÿ¢ŸÖŸÜ",
    badge_copy: "ŸÜÿ≥ÿÆ",
    badge_dev: "ŸÖÿ∑ŸàŸëÿ±",
    badge_decode: "ŸÅŸÉ",
    badge_receipt: "ÿ•ŸäÿµÿßŸÑ",
    badge_events: "ÿ£ÿ≠ÿØÿßÿ´",
    badge_tools: "ÿ£ÿØŸàÿßÿ™",
    badge_bookmarklet: "Bookmarklet",
    badge_local: "ŸÖÿ≠ŸÑŸä",

    // generic
    pill_wallet: "ŸÖÿ≠ŸÅÿ∏ÿ©",
    btn_close: "ÿ•ÿ∫ŸÑÿßŸÇ",
    btn_save: "ÿ≠ŸÅÿ∏",
    btn_clear: "ŸÖÿ≥ÿ≠",
    btn_scan: "ŸÅÿ≠ÿµ",
    btn_decode: "ŸÅŸÉ ÿßŸÑÿ™ÿ¥ŸÅŸäÿ±",
    btn_copy_md: "ŸÜÿ≥ÿÆ Markdown",
    btn_copy_link: "ŸÜÿ≥ÿÆ ÿ±ÿßÿ®ÿ∑ ÿßŸÑŸÖÿ¥ÿßÿ±ŸÉÿ©",
    btn_copy_json: "ŸÜÿ≥ÿÆ JSON",
    btn_copy_xtext: "ŸÜÿ≥ÿÆ ŸÜÿµ X",

    // quick panel
    p_quick_kicker: "ŸÅÿ≠ÿµ ÿ≥ÿ±Ÿäÿπ",
    p_quick_title: "ŸÇŸäŸëŸÖ ÿ™ŸàŸÉŸÜ ÿÆŸÑÿßŸÑ ÿ´ŸàÿßŸÜŸç",
    p_quick_sub:
      "ÿ£ŸÑÿµŸÇ ÿπŸÜŸàÿßŸÜ ÿßŸÑÿ™ŸàŸÉŸÜÿå ÿßÿÆÿ™ÿ± ÿßŸÑÿ¥ÿ®ŸÉÿ©ÿå ÿ¥ÿ∫ŸëŸÑ ÿßŸÑŸÅÿ≠ÿµ. ŸäŸèÿ≠ŸÅÿ∏ ÿ®ÿßŸÑŸÉÿßÿ¥ ŸÑŸÖÿØÿ© 10 ÿØŸÇÿßÿ¶ŸÇ. ÿ£ŸÜÿ¥ÿ¶ ŸÜÿµÿßŸã ŸÇÿßÿ®ŸÑÿßŸã ŸÑŸÑŸÖÿ¥ÿßÿ±ŸÉÿ© + JSON + Markdown.",
    quick_input_title: "ÿ•ÿØÿÆÿßŸÑ ÿßŸÑÿ™ŸàŸÉŸÜ",
    net_label: "ÿßŸÑÿ¥ÿ®ŸÉÿ©",
    addr_label: "ÿπŸÇÿØ ÿßŸÑÿ™ŸàŸÉŸÜ",
    qs_tip:
      'ŸÜÿµŸäÿ≠ÿ©: ÿßŸÅÿ™ÿ≠ <span class="mono">?tool=quick&net=bsc&token=0x...</span> ŸÑŸÑÿ™ÿ¥ÿ∫ŸäŸÑ ÿßŸÑÿ™ŸÑŸÇÿßÿ¶Ÿä (ŸÖÿ≠ÿØŸàÿØ).',
    options_label: "ÿßŸÑÿÆŸäÿßÿ±ÿßÿ™",
    opt_require_liq: "Ÿäÿ™ÿ∑ŸÑÿ® ÿ≥ŸäŸàŸÑÿ© (ÿ™ŸÇŸäŸäŸÖ ÿ£ŸÉÿ´ÿ± ÿµÿ±ÿßŸÖÿ©)",
    opt_show_json: "ÿ™ŸÅÿπŸäŸÑ ÿ™ŸÇÿ±Ÿäÿ± JSON (ŸÜÿ≥ÿÆ)",
    api_keys_label: "ŸÖŸÅÿßÿ™Ÿäÿ≠ API ŸÑŸÑŸÖÿ≥ÿ™ŸÉÿ¥ŸÅ (ÿßÿÆÿ™Ÿäÿßÿ±Ÿä)",
    opt_use_explorer_apis: "ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ BscScan/Etherscan (Ÿäÿ≤ŸäÿØ Verified + ŸÇŸàÿßÿπÿØ ABI)",
    api_keys_tip:
      "ÿßŸÑŸÖŸÅÿßÿ™Ÿäÿ≠ ÿ™Ÿèÿ≠ŸÅÿ∏ ŸÖÿ≠ŸÑŸäÿßŸã ŸÅŸä ÿßŸÑŸÖÿ™ÿµŸÅÿ≠ (localStorage) ŸÅŸÇÿ∑. ŸÑÿß ÿ™ÿ∂ÿπŸáÿß ÿØÿßÿÆŸÑ HTML ÿπÿßŸÖ.",
    results_title: "ÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨",
    results_hint:
      "ÿ•ÿ¥ÿßÿ±ÿßÿ™ ÿÆÿ∂ÿ±ÿßÿ°/ÿµŸÅÿ±ÿßÿ°/ÿ≠ŸÖÿ±ÿßÿ°. ŸÑŸäÿ≥ÿ™ ÿ∂ŸÖÿßŸÜÿßŸã ‚Äî ŸÖÿ¨ÿ±ÿØ ŸÅÿ≠Ÿàÿµÿßÿ™ ÿπŸÑŸâ ÿßŸÑÿ≥ŸÑÿ≥ŸÑÿ© ŸÇÿßÿ®ŸÑÿ© ŸÑŸÑÿ™ÿ≠ŸÇŸÇ.",

    // liquidity panel
    p_liq_kicker: "ŸÅÿ≠ÿµ ÿßŸÑÿ™ŸàŸÉŸÜ + ÿßŸÑÿ≥ŸäŸàŸÑÿ©",
    p_liq_title: "ŸÅÿ≠ÿµ ÿ≥ŸäŸàŸÑÿ© DEX",
    p_liq_sub:
      "ŸÜŸèÿ¨ÿ±Ÿä ŸÅÿ≠ÿµ PancakeSwap (BSC) / Uniswap (ETH) V2 + V3. ÿßŸÑÿ£ÿ≤Ÿàÿßÿ¨: ÿßŸÑÿ™ŸàŸÉŸÜ ŸÖŸÇÿßÿ®ŸÑ WBNB/WETH Ÿà USDT.",
    liq_input_title: "ÿ™ŸàŸÉŸÜ + ÿ¥ÿ®ŸÉÿ©",
    liq_tip:
      'ŸÜÿµŸäÿ≠ÿ©: ÿßŸÅÿ™ÿ≠ <span class="mono">?tool=liq&net=bsc&token=0x...</span> ŸÑŸÑÿ™ÿ¥ÿ∫ŸäŸÑ ÿßŸÑÿ™ŸÑŸÇÿßÿ¶Ÿä.',
    liq_dex_label: "ÿ≥ÿ¨ŸÑ DEX (ŸÖŸÅÿ≠Ÿàÿµ)",
    liq_results_title: "ŸÜÿ™ÿßÿ¶ÿ¨ ÿßŸÑÿ≥ŸäŸàŸÑÿ©",
    liq_results_hint:
      "V2: ÿ≤Ÿàÿ¨ + ŸÑŸÇÿ∑ÿ© ÿßŸÑÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿä. V3: Ÿàÿ¨ŸàÿØ ÿßŸÑÿ≠Ÿàÿ∂ + liquidity() + ŸÑŸÇÿ∑ÿ© slot0/tick.",

    // approvals panel
    p_app_kicker: "ÿ≠ÿßÿ±ÿ≥ ÿßŸÑÿµŸÑÿßÿ≠Ÿäÿßÿ™",
    p_app_title: "ÿ™ÿ≠ŸÇŸÇ Ÿàÿ£ŸÑÿ∫Ÿê ÿßŸÑÿµŸÑÿßÿ≠Ÿäÿßÿ™",
    p_app_sub:
      "ÿ£ÿØÿÆŸÑ spender + ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿ™ŸàŸÉŸÜÿßÿ™ (ÿ£Ÿà ÿ£ÿ∂ŸÅ ÿßŸÑÿ¥ÿßÿ¶ÿπÿ©). ŸÜŸÇÿ±ÿ£ allowance(owner, spender) ŸàŸÜŸÑÿ∫Ÿä ÿπÿ®ÿ± approve(spender, 0).",
    ap_settings_title: "ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™",
    ap_connected: "ŸÖÿ™ÿµŸÑ:",
    ap_connect: "ÿßÿ™ÿµÿßŸÑ / ÿ™ÿ≠ÿØŸäÿ´",
    ap_spender_label: "ÿ•ÿπÿØÿßÿØ spender",
    ap_spender_tip:
      "ÿßÿ®ÿØÿ£ ÿ®ÿßÿÆÿ™Ÿäÿßÿ± ÿ±ÿßŸàÿ™ÿ± ÿ¨ÿßŸáÿ≤ÿå ÿ´ŸÖ ÿ£ÿ∂ŸÅ ÿßŸÑÿ™ŸàŸÉŸÜÿßÿ™ ÿßŸÑÿ™Ÿä ÿ™ÿ±ŸäÿØ ÿ™ŸÜÿ∏ŸäŸÅŸáÿß.",
    ap_tokens_label: "ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿ™ŸàŸÉŸÜÿßÿ™ (ŸÉŸÑ ÿ≥ÿ∑ÿ± ÿπŸÜŸàÿßŸÜ)",
    ap_seed: "ÿ•ÿ∂ÿßŸÅÿ© ÿ™ŸàŸÉŸÜÿßÿ™ ÿ¥ÿßÿ¶ÿπÿ©",
    ap_seed_history: "ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿ≥ÿ¨ŸÑ ÿßŸÑŸÅÿ≠ÿµ",
    ap_check: "ŸÅÿ≠ÿµ ÿßŸÑÿµŸÑÿßÿ≠Ÿäÿßÿ™",
    ap_revoke_all: "ÿ•ŸÑÿ∫ÿßÿ° ÿßŸÑŸÉŸÑ (ÿ∫Ÿäÿ± ÿßŸÑÿµŸÅÿ±Ÿäÿ©)",
    ap_results: "ÿßŸÑÿµŸÑÿßÿ≠Ÿäÿßÿ™",
    ap_results_hint:
      "ÿ•ÿ∞ÿß ŸÉÿßŸÜÿ™ ÿßŸÑÿµŸÑÿßÿ≠Ÿäÿ© ‚Äúÿ∫Ÿäÿ± ŸÖÿ≠ÿØŸàÿØÿ©‚Äùÿå ŸäŸèŸÜÿµÿ≠ ÿ®ÿßŸÑÿ•ŸÑÿ∫ÿßÿ° ŸÖÿß ŸÑŸÖ ÿ™ŸÉŸÜ ÿ™ÿ´ŸÇ ÿ™ŸÖÿßŸÖÿßŸã ÿ®ÿßŸÑŸÄ spender.",
    safe_mode_note:
      "ÿßŸÑŸàÿ∂ÿπ ÿßŸÑÿ¢ŸÖŸÜ: ÿßŸÑÿπŸÖŸÑŸäÿßÿ™ ÿßŸÑÿ™Ÿä ÿ™ÿ™ÿ∑ŸÑÿ® ÿ™ŸàŸÇŸäÿπÿßŸã ŸÖÿπÿ∑ŸÑÿ© ÿ≠ÿ™Ÿâ ÿ™ÿ™ÿµŸÑ ÿ®ÿßŸÑŸÖÿ≠ŸÅÿ∏ÿ©.",

    // rpc panel
    p_rpc_kicker: "ŸÅÿ≠ÿµ ÿµÿ≠ÿ© RPC",
    p_rpc_title: "ÿßÿπÿ´ÿ± ÿπŸÑŸâ ÿ£ŸÅÿ∂ŸÑ Endpoint",
    p_rpc_sub:
      "ŸÜÿÆÿ™ÿ®ÿ± RPC: ÿ≤ŸÖŸÜ ÿßŸÑÿßÿ≥ÿ™ÿ¨ÿßÿ®ÿ© + chainId + ÿ®ŸÑŸàŸÉ + eth_call + ŸÇÿ±ÿßÿ°ÿ© logs. Ÿäÿ™ÿ∂ŸÖŸÜ ÿßÿÆÿ™ÿ®ÿßÿ± logs ŸÑŸÑŸÖÿ∑Ÿàÿ± ŸàŸäÿ≠ŸÅÿ∏ ÿ£ŸÅÿ∂ŸÑ RPC ŸÖÿ≠ŸÑŸäÿßŸã.",
    rpc_inputs: "ÿßŸÑŸÖÿØÿÆŸÑÿßÿ™",
    rpc_private_label: "RPC ÿÆÿßÿµ (ŸÖÿ≠ŸÅŸàÿ∏ ŸÖÿ≠ŸÑŸäÿßŸã)",
    rpc_private_tip:
      "ÿ∫Ÿäÿ± ŸÖÿØŸÖÿ¨ ŸÅŸä HTML. ŸÖÿ≠ŸÅŸàÿ∏ ŸÅŸä ŸÖÿ™ÿµŸÅÿ≠ŸÉ ŸÅŸÇÿ∑ (localStorage).",
    rpc_custom_label: "RPC ŸÖÿÆÿµÿµ (ÿ£ŸàŸÑŸàŸäÿ© ÿ£ÿπŸÑŸâ)",
    rpc_test: "ÿßÿÆÿ™ÿ®ÿßÿ± RPCs",
    rpc_copy_best: "ŸÜÿ≥ÿÆ ÿ£ŸÅÿ∂ŸÑ RPC",
    rpc_results: "ÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨",
    rpc_tip:
      "ŸÜÿµŸäÿ≠ÿ©: ÿ®ÿπÿ∂ RPCs ÿ™ŸÅÿ¥ŸÑ ÿ®ÿ≥ÿ®ÿ® CORS/ŸÖŸáŸÑÿ©. ÿ¥ÿ∫ŸëŸÑ ÿßŸÑÿßÿÆÿ™ÿ®ÿßÿ± ŸàÿßÿÆÿ™ÿ± ÿßŸÑÿ£ÿ≥ÿ±ÿπ ŸàÿßŸÑÿ£ŸÉÿ´ÿ± ÿßÿ≥ÿ™ŸÇÿ±ÿßÿ±ÿßŸã.",
    rpc_dev_title: "ÿßÿÆÿ™ÿ®ÿßÿ± logs ŸÖÿÆÿµÿµ ŸÑŸÑŸÖÿ∑Ÿàÿ±",
    rpc_dev_hint:
      "ÿßÿÆÿ™Ÿäÿßÿ±Ÿä: ÿßÿÆÿ™ÿ®ÿ± logs ŸÑÿπŸÇÿØ ŸÖÿ≠ÿØÿØ ŸÑŸÑÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿßÿ≥ÿ™ŸÇÿ±ÿßÿ± ÿßŸÑŸÄ RPC.",
    rpc_dev_addr: "ÿπŸÜŸàÿßŸÜ ÿßŸÑÿπŸÇÿØ (ÿßÿÆÿ™Ÿäÿßÿ±Ÿä)",
    rpc_dev_topic: "Topic0 (ÿßÿÆÿ™Ÿäÿßÿ±Ÿä)",
    rpc_dev_run: "ÿ™ÿ¥ÿ∫ŸäŸÑ ÿßŸÑÿßÿÆÿ™ÿ®ÿßÿ±",

    // tx panel
    p_tx_kicker: "ŸÅŸÉ ÿ™ÿ¥ŸÅŸäÿ± Tx",
    p_tx_title: "ŸÅŸÉ ÿ™ÿ¥ŸÅŸäÿ± ŸÖÿπÿßŸÖŸÑÿ©",
    p_tx_sub:
      "ÿ£ŸÑÿµŸÇ tx hash. ŸÜÿ¨ŸÑÿ® tx + receipt ŸàŸÜŸÅŸÉ ÿ™ÿ¥ŸÅŸäÿ± ÿßŸÑŸÖÿØÿÆŸÑÿßÿ™ ŸàÿßŸÑÿ£ÿ≠ÿØÿßÿ´ ÿßŸÑÿ¥ÿßÿ¶ÿπÿ© (Transfer / Approval + ÿßÿ≥ÿ™ÿØÿπÿßÿ°ÿßÿ™ swap).",
    tx_input_title: "ÿ•ÿØÿÆÿßŸÑ Tx",
    tx_hash_label: "Ÿáÿßÿ¥ ÿßŸÑŸÖÿπÿßŸÖŸÑÿ©",
    tx_tip:
      'ŸÜÿµŸäÿ≠ÿ©: ÿßŸÅÿ™ÿ≠ <span class="mono">?tool=tx&net=bsc&tx=0x...</span> ŸÑŸÑÿ™ÿ¥ÿ∫ŸäŸÑ ÿßŸÑÿ™ŸÑŸÇÿßÿ¶Ÿä.',
    tx_results_title: "ÿßŸÑŸÖÿÆÿ±ÿ¨ÿßÿ™",

    // dev panel
    p_dev_kicker: "ÿ£ÿØŸàÿßÿ™ ÿßŸÑŸÖÿ∑ŸàŸëÿ±",
    p_dev_title: "Bookmarklet + ŸÖÿ±ÿßŸÇÿ®ÿ© ŸÖÿ≠ŸÑŸäÿ©",
    p_dev_sub:
      "ÿ£ŸÜÿ¥ÿ¶ Bookmarklet Ÿäÿ±ÿ≥ŸÑ ÿßŸÑÿ™ŸàŸÉŸÜ/ÿßŸÑŸÖÿπÿßŸÖŸÑÿ© ŸÖŸÜ ÿßŸÑŸÖÿ≥ÿ™ŸÉÿ¥ŸÅ ÿ•ŸÑŸâ CycleX Hub. ŸàŸäÿ™ÿ∂ŸÖŸÜ ŸÖÿ±ÿßŸÇÿ®ÿ© ÿπŸÇÿØ ŸÖÿ≠ŸÑŸäÿ© (ŸÇÿßÿ¶ŸÖÿ© ŸÖÿ≠ŸÅŸàÿ∏ÿ© ŸÅŸä ŸÖÿ™ÿµŸÅÿ≠ŸÉ).",
    bm_title: "ŸÖŸàŸÑŸëÿØ Bookmarklet",
    bm_hint:
      "ÿßÿ≥ÿ≠ÿ® ÿ•ŸÑŸâ ÿ¥ÿ±Ÿäÿ∑ ÿßŸÑÿ•ÿ¥ÿßÿ±ÿßÿ™ ÿ£Ÿà ÿßŸÜÿ≥ÿÆ ÿßŸÑŸÄ Bookmarklet. ÿßÿ≥ÿ™ÿÆÿØŸÖŸá ŸÅŸä ÿµŸÅÿ≠ÿßÿ™ BscScan/Etherscan.",
    bm_base_label: "ÿ±ÿßÿ®ÿ∑ Hub (Ÿáÿ∞Ÿá ÿßŸÑÿµŸÅÿ≠ÿ©)",
    bm_generate: "ÿ•ŸÜÿ¥ÿßÿ°",
    bm_copy: "ŸÜÿ≥ÿÆ Bookmarklet",

    mon_add_title: "ÿ•ÿ∂ÿßŸÅÿ© ŸÑŸÇÿßÿ¶ŸÖÿ© ÿßŸÑŸÖÿ±ÿßŸÇÿ®ÿ©",
    mon_list_title: "ŸÖÿ±ÿßŸÇÿ®ÿ© ÿßŸÑÿπŸÇŸàÿØ (ŸÖÿ≠ŸÑŸä)",
    mon_list_hint: "ŸÖÿ≠ŸÅŸàÿ∏ ŸÖÿ≠ŸÑŸäÿßŸã ŸÅŸÇÿ∑. ÿ®ÿØŸàŸÜ ÿ™ÿ™ÿ®ÿπ ÿ≥Ÿäÿ±ŸÅÿ±.",
    mon_add: "ÿ•ÿ∂ÿßŸÅÿ©",
    mon_check: "ŸÅÿ≠ÿµ ÿßŸÑŸÉŸÑ",
    mon_export: "ŸÜÿ≥ÿÆ JSON",

    // footer
    footer_left:
      "CycleX Security Hub ŸäÿπŸÖŸÑ ÿπŸÑŸâ ÿßŸÑŸÖÿ™ÿµŸÅÿ≠ ŸàŸäŸÇÿ±ÿ£ ÿ®ŸäÿßŸÜÿßÿ™ ÿπÿßŸÖÿ© ÿπŸÑŸâ ÿßŸÑÿ≥ŸÑÿ≥ŸÑÿ©.",
    footer_tagline: "ÿ™ÿ≠ŸÇŸÇ ŸÖÿ±ÿ™ŸäŸÜ. ŸÑÿß ÿ™ÿ™ÿµŸÑ ÿ•ŸÑÿß ÿπŸÜÿØŸÖÿß ÿ™ÿ´ŸÇ ÿ®ÿßŸÑÿµŸÅÿ≠ÿ©.",
    // --- ADD THESE KEYS (AR) ---
title_back_to_cyclex: "ÿßŸÑÿπŸàÿØÿ© ÿ•ŸÑŸâ CycleX",
aria_lang_selector: "ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑŸÑÿ∫ÿ©",
badge_table: "ÿ¨ÿØŸàŸÑ",
btn_share_x: "ŸÖÿ¥ÿßÿ±ŸÉÿ© ÿπŸÑŸâ X",
btn_share_tg: "ŸÖÿ¥ÿßÿ±ŸÉÿ© ÿπŸÑŸâ ÿ™ŸäŸÑŸäÿ¨ÿ±ÿßŸÖ",
net_bsc: "BSC (BNB Chain)",
net_eth: "ÿ•Ÿäÿ´ÿ±ŸäŸàŸÖ",
spender_pcs_router: "ÿ±ÿßŸàÿ™ÿ± PancakeSwap (BSC)",
spender_uni_router: "ÿ±ÿßŸàÿ™ÿ± Uniswap V2 (ETH)",
spender_custom: "ŸÖÿÆÿµÿµ‚Ä¶",

th_token: "ÿßŸÑÿ™ŸàŸÉŸÜ",
th_allowance: "ÿßŸÑÿµŸÑÿßÿ≠Ÿäÿ©",
th_symbol: "ÿßŸÑÿ±ŸÖÿ≤",
th_action: "ÿ•ÿ¨ÿ±ÿßÿ°",
th_rpc: "RPC",
th_ms: "ŸÖŸÑŸÑŸä ÿ´ÿßŸÜŸäÿ©",
th_chain: "ÿßŸÑÿ≥ŸÑÿ≥ŸÑÿ©",
th_block: "ÿ®ŸÑŸàŸÉ",
th_call: "ÿßÿ≥ÿ™ÿØÿπÿßÿ°",
th_logs: "ÿ≥ÿ¨ŸÑÿßÿ™",
th_status: "ÿßŸÑÿ≠ÿßŸÑÿ©",
th_contract: "ÿßŸÑÿπŸÇÿØ",
th_network: "ÿßŸÑÿ¥ÿ®ŸÉÿ©",
th_last_seen: "ÿ¢ÿÆÿ± ÿ∏ŸáŸàÿ±",
    th_pairpool: "ÿ≤Ÿàÿ¨/ŸÖÿ¨ŸÖÿπ",
th_type: "ÿßŸÑŸÜŸàÿπ",
th_target: "ÿßŸÑŸáÿØŸÅ",
th_result: "ÿßŸÑŸÜÿ™Ÿäÿ¨ÿ©",
btn_remove: "ÿ•ÿ≤ÿßŸÑÿ©",
toast_imported_token: "ÿ™ŸÖ ÿßÿ≥ÿ™Ÿäÿ±ÿßÿØ ÿßŸÑÿ™ŸàŸÉŸÜ ŸÖŸÜ ÿßŸÑŸÖÿ≥ÿ™ŸÉÿ¥ŸÅ:",
toast_imported_tx: "ÿ™ŸÖ ÿßÿ≥ÿ™Ÿäÿ±ÿßÿØ ÿßŸÑŸÖÿπÿßŸÖŸÑÿ© ŸÖŸÜ ÿßŸÑŸÖÿ≥ÿ™ŸÉÿ¥ŸÅ:",
err_no_working_rpc: "ŸÑŸÖ Ÿäÿ™ŸÖ ÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸâ RPC ŸäÿπŸÖŸÑ. ÿßŸÅÿ™ÿ≠ ÿ£ÿØÿßÿ© RPC Ÿàÿßÿ∂ÿ®ÿ∑ endpoint ÿµÿßŸÑÿ≠.",


qs_ready_html: "<strong>ÿ¨ÿßŸáÿ≤.</strong><br>ÿ£ŸÑÿµŸÇ ÿπŸÜŸàÿßŸÜ ÿßŸÑÿ™ŸàŸÉŸÜ ÿ´ŸÖ ÿßÿ∂ÿ∫ÿ∑ <b>ŸÅÿ≠ÿµ</b>.",
liq_ready_html: "<strong>ÿ¨ÿßŸáÿ≤.</strong><br>ÿ£ŸÑÿµŸÇ ÿπŸÜŸàÿßŸÜ ÿßŸÑÿ™ŸàŸÉŸÜ ÿ´ŸÖ ÿßÿ∂ÿ∫ÿ∑ <b>ŸÅÿ≠ÿµ</b>.",
tx_ready_html: "<strong>ÿ¨ÿßŸáÿ≤.</strong><br>ÿ£ŸÑÿµŸÇ tx hash ÿ´ŸÖ ÿßÿ∂ÿ∫ÿ∑ <b>ŸÅŸÉ ÿßŸÑÿ™ÿ¥ŸÅŸäÿ±</b>.",

ph_0x: "0x...",
ph_spender: "0x spender...",
ph_token_list: "0x...\n0x...\n0x...",
ph_bscscan_key: "ŸÖŸÅÿ™ÿßÿ≠ BscScan API (ŸÖÿ≠ŸÅŸàÿ∏ ŸÖÿ≠ŸÑŸäÿßŸã)",
ph_etherscan_key: "ŸÖŸÅÿ™ÿßÿ≠ Etherscan API (ŸÖÿ≠ŸÅŸàÿ∏ ŸÖÿ≠ŸÑŸäÿßŸã)",
ph_rpc_private: "https://... (ŸÖÿ≠ŸÅŸàÿ∏ ŸÖÿ≠ŸÑŸäÿßŸã ŸÅŸÇÿ∑)",
ph_rpc_custom: "https://...",
ph_rpc_dev_topic: "0xddf252ad... (Transfer) ÿ£Ÿà ÿßÿ™ÿ±ŸÉŸá ŸÅÿßÿ±ÿ∫ÿßŸã"

  },

  ru: {
    // header / hero
    brand_sub: "–û–Ω—á–µ–π–Ω –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –Ω–∞–≥—Ä–∞–¥—ã",
    hero_kicker: "Security Hub",
    hero_title: "–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ CycleX",
    hero_subtitle:
      "–õ—ë–≥–∫–∏–π –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π –Ω–∞–±–æ—Ä: –±–æ–ª–µ–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ swaps, –≥–∏–≥–∏–µ–Ω–∞ approvals, –ø—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏, –∑–¥–æ—Ä–æ–≤—å–µ RPC –∏ –¥–µ–∫–æ–¥–µ—Ä —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –¥–ª—è BSC + Ethereum.",
    btn_back: "–ù–∞–∑–∞–¥ –Ω–∞ —Å–∞–π—Ç",
    btn_connect: "–ü–æ–¥–∫–ª—é—á–∏—Ç—å –∫–æ—à–µ–ª—ë–∫ (–æ–ø—Ü.)",
    wallet_not_connected: "–Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω",
    btn_quick: "–ó–∞–ø—É—Å—Ç–∏—Ç—å –±—ã—Å—Ç—Ä—ã–π —Å–∫–∞–Ω",
    hero_note:
      "–í–∞–∂–Ω–æ: –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–æ—Å—è—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä –∏ –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—é—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å. –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ.",
    tools_kicker: "–í–´–ë–ï–†–ò–¢–ï –ò–ù–°–¢–†–£–ú–ï–ù–¢",

    // tiles
    cube_quick_title: "–ë—ã—Å—Ç—Ä—ã–π —Å–∫–∞–Ω",
    cube_quick_desc: "–ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞ + —à–∞—Ä–∏–º—ã–π –æ—Ç—á—ë—Ç + –∫—ç—à.",
    cube_liq_title: "–¢–æ–∫–µ–Ω + –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å",
    cube_liq_desc: "–ü—Ä–æ–≤–µ—Ä–∫–∞ DEX (Pancake/Uni): —Ç–æ–∫–µ–Ω vs WBNB/WETH –∏ USDT.",
    cube_approvals_title: "Approval Guardian",
    cube_approvals_desc:
      "–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –æ—Ç–∑—ã–≤ ERC-20 allowance (approve ‚Üí 0).",
    cube_rpc_title: "–ü—Ä–æ–≤–µ—Ä–∫–∞ RPC",
    cube_rpc_desc:
      "Latency + chainId + block + eth_call + —á—Ç–µ–Ω–∏–µ logs + dev custom test.",
    cube_tx_title: "–î–µ–∫–æ–¥–µ—Ä Tx",
    cube_tx_desc:
      "–î–µ–∫–æ–¥–∏—Ä—É–µ—Ç input –∏ —Å–æ–±—ã—Ç–∏—è (Transfer/Approval) –ø–æ tx hash.",
    cube_dev_title: "Dev Tools",
    cube_dev_desc:
      "–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä bookmarklet + –ª–æ–∫–∞–ª—å–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤ (–±–µ–∑ —Å–µ—Ä–≤–µ—Ä–∞).",

    // tile badges
    badge_fast: "–ë—ã—Å—Ç—Ä–æ",
    badge_share: "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è",
    badge_cache: "–ö—ç—à",
    badge_dex: "DEX",
    badge_pairs: "–ü–∞—Ä—ã",
    badge_wallet: "–ö–æ—à–µ–ª—ë–∫",
    badge_safe: "–ë–µ–∑–æ–ø–∞—Å–Ω–æ",
    badge_copy: "–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å",
    badge_dev: "Dev",
    badge_decode: "Decode",
    badge_receipt: "Receipt",
    badge_events: "Events",
    badge_tools: "Tools",
    badge_bookmarklet: "Bookmarklet",
    badge_local: "Local",

    // generic
    pill_wallet: "–ö–æ—à–µ–ª—ë–∫",
    btn_close: "–ó–∞–∫—Ä—ã—Ç—å",
    btn_save: "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å",
    btn_clear: "–û—á–∏—Å—Ç–∏—Ç—å",
    btn_scan: "–°–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å",
    btn_decode: "–î–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å",
    btn_copy_md: "–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å Markdown",
    btn_copy_link: "–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É",
    btn_copy_json: "–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å JSON",
    btn_copy_xtext: "–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç –¥–ª—è X",

    // quick panel
    p_quick_kicker: "–ë—ã—Å—Ç—Ä—ã–π —Å–∫–∞–Ω",
    p_quick_title: "–û—Ü–µ–Ω–∏—Ç–µ —Ç–æ–∫–µ–Ω –∑–∞ —Å–µ–∫—É–Ω–¥—ã",
    p_quick_sub:
      "–í—Å—Ç–∞–≤—å—Ç–µ –∞–¥—Ä–µ—Å —Ç–æ–∫–µ–Ω–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Å–µ—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫–∞–Ω. –ö—ç—à –Ω–∞ 10 –º–∏–Ω—É—Ç. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ –¥–ª—è —à–∞—Ä–∏–Ω–≥–∞ + JSON + Markdown.",
    quick_input_title: "–í–≤–æ–¥ —Ç–æ–∫–µ–Ω–∞",
    net_label: "–°–µ—Ç—å",
    addr_label: "–ö–æ–Ω—Ç—Ä–∞–∫—Ç —Ç–æ–∫–µ–Ω–∞",
    qs_tip:
      '–°–æ–≤–µ—Ç: –æ—Ç–∫—Ä–æ–π—Ç–µ <span class="mono">?tool=quick&net=bsc&token=0x...</span> –¥–ª—è –∞–≤—Ç–æ-—Å—Ç–∞—Ä—Ç–∞ (–ª–∏–º–∏—Ç–∏—Ä–æ–≤–∞–Ω–æ).',
    options_label: "–û–ø—Ü–∏–∏",
    opt_require_liq: "–¢—Ä–µ–±–æ–≤–∞—Ç—å –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å (—Å—Ç—Ä–æ–∂–µ)",
    opt_show_json: "–í–∫–ª—é—á–∏—Ç—å JSON –æ—Ç—á—ë—Ç (–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ)",
    api_keys_label: "API –∫–ª—é—á–∏ Explorer (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)",
    opt_use_explorer_apis:
      "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å BscScan/Etherscan (Verified + ABI —ç–≤—Ä–∏—Å—Ç–∏–∫–∏)",
    api_keys_tip:
      "–ö–ª—é—á–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –≤–∞—à–µ–º –±—Ä–∞—É–∑–µ—Ä–µ (localStorage). –ù–µ –≤—Å—Ç–∞–≤–ª—è–π—Ç–µ –∫–ª—é—á–∏ –≤ –ø—É–±–ª–∏—á–Ω—ã–π HTML.",
    results_title: "–†–µ–∑—É–ª—å—Ç–∞—Ç—ã",
    results_hint:
      "–ó–µ–ª—ë–Ω—ã–µ / –∂—ë–ª—Ç—ã–µ / –∫—Ä–∞—Å–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã. –≠—Ç–æ –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—è ‚Äî —Ç–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä—è–µ–º—ã–µ –æ–Ω—á–µ–π–Ω-–ø—Ä–æ–≤–µ—Ä–∫–∏.",

    // liquidity panel
    p_liq_kicker: "–¢–æ–∫–µ–Ω + –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å",
    p_liq_title: "–ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏ DEX",
    p_liq_sub:
      "–ü—Ä–æ–≤–µ—Ä—è–µ–º PancakeSwap (BSC) / Uniswap (ETH) V2 + V3 —Ñ–∞–±—Ä–∏–∫–∏. –ü–∞—Ä—ã: —Ç–æ–∫–µ–Ω vs WBNB/WETH –∏ —Ç–æ–∫–µ–Ω vs USDT.",
    liq_input_title: "–¢–æ–∫–µ–Ω + —Å–µ—Ç—å",
    liq_tip:
      '–°–æ–≤–µ—Ç: –æ—Ç–∫—Ä–æ–π—Ç–µ <span class="mono">?tool=liq&net=bsc&token=0x...</span> –¥–ª—è –∞–≤—Ç–æ-—Å—Ç–∞—Ä—Ç–∞.',
    liq_dex_label: "DEX —Ä–µ–µ—Å—Ç—Ä (–ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è)",
    liq_results_title: "–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏",
    liq_results_hint:
      "V2: –ø–∞—Ä–∞ + snapshot —Ä–µ–∑–µ—Ä–≤–æ–≤. V3: –Ω–∞–ª–∏—á–∏–µ –ø—É–ª–∞ + liquidity() + slot0/tick snapshot.",

    // approvals panel
    p_app_kicker: "Approval Guardian",
    p_app_title: "–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –æ—Ç–∑—ã–≤ allowance",
    p_app_sub:
      "–£–∫–∞–∂–∏—Ç–µ spender + —Ç–æ–∫–µ–Ω—ã (–∏–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ). –ß–∏—Ç–∞–µ–º allowance(owner, spender) –∏ –æ—Ç–∑—ã–≤–∞–µ–º —á–µ—Ä–µ–∑ approve(spender, 0).",
    ap_settings_title: "–ù–∞—Å—Ç—Ä–æ–π–∫–∏",
    ap_connected: "–ü–æ–¥–∫–ª—é—á–µ–Ω–æ:",
    ap_connect: "–ü–æ–¥–∫–ª—é—á–∏—Ç—å / –û–±–Ω–æ–≤–∏—Ç—å",
    ap_spender_label: "Spender preset",
    ap_spender_tip:
      "–ù–∞—á–Ω–∏—Ç–µ —Å —Ä–æ—É—Ç–µ—Ä–∞, –∑–∞—Ç–µ–º –¥–æ–±–∞–≤—å—Ç–µ —Ç–æ–∫–µ–Ω—ã –¥–ª—è –æ—á–∏—Å—Ç–∫–∏.",
    ap_tokens_label: "–°–ø–∏—Å–æ–∫ —Ç–æ–∫–µ–Ω–æ–≤ (–ø–æ –æ–¥–Ω–æ–º—É –≤ —Å—Ç—Ä–æ–∫–µ)",
    ap_seed: "–î–æ–±–∞–≤–∏—Ç—å –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã",
    ap_seed_history: "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é —Å–∫–∞–Ω–æ–≤",
    ap_check: "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å allowance",
    ap_revoke_all: "–û—Ç–æ–∑–≤–∞—Ç—å –≤—Å–µ (–Ω–µ–Ω—É–ª–µ–≤—ã–µ)",
    ap_results: "Allowances",
    ap_results_hint:
      "–ï—Å–ª–∏ allowance ‚Äú–±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π‚Äù, –ª—É—á—à–µ –æ—Ç–æ–∑–≤–∞—Ç—å, –µ—Å–ª–∏ –≤—ã –Ω–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –¥–æ–≤–µ—Ä—è–µ—Ç–µ spender.",
    safe_mode_note:
      "Safe mode: –¥–µ–π—Å—Ç–≤–∏—è, —Ç—Ä–µ–±—É—é—â–∏–µ –ø–æ–¥–ø–∏—Å—å, –æ—Ç–∫–ª—é—á–µ–Ω—ã –¥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫–æ—à–µ–ª—å–∫–∞.",

    // rpc panel
    p_rpc_kicker: "–ü—Ä–æ–≤–µ—Ä–∫–∞ RPC",
    p_rpc_title: "–ù–∞–π–¥–∏—Ç–µ –ª—É—á—à–∏–π endpoint",
    p_rpc_sub:
      "–¢–µ—Å—Ç–∏—Ä—É–µ–º RPC: latency + chainId + block + eth_call + —á—Ç–µ–Ω–∏–µ logs. –ï—Å—Ç—å dev custom logs test, –ª—É—á—à–∏–π RPC —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ.",
    rpc_inputs: "–í–≤–æ–¥",
    rpc_private_label: "–ü—Ä–∏–≤–∞—Ç–Ω—ã–π RPC (–ª–æ–∫–∞–ª—å–Ω–æ)",
    rpc_private_tip:
      "–ù–µ –≤—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤ HTML. –•—Ä–∞–Ω–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –≤–∞—à–µ–º –±—Ä–∞—É–∑–µ—Ä–µ (localStorage).",
    rpc_custom_label: "–ö–∞—Å—Ç–æ–º–Ω—ã–π RPC (–≤—ã—Å—à–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)",
    rpc_test: "–¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å RPC",
    rpc_copy_best: "–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ª—É—á—à–∏–π RPC",
    rpc_results: "–†–µ–∑—É–ª—å—Ç–∞—Ç—ã",
    rpc_tip:
      "–°–æ–≤–µ—Ç: –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ RPC –ø–∞–¥–∞—é—Ç –∏–∑-–∑–∞ CORS/timeout. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç –∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –∏ –±—ã—Å—Ç—Ä—ã–π.",
    rpc_dev_title: "Dev custom logs test",
    rpc_dev_hint:
      "–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: —Ç–µ—Å—Ç logs –ø–æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—É, —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å RPC.",
    rpc_dev_addr: "–ê–¥—Ä–µ—Å –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)",
    rpc_dev_topic: "Topic0 (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)",
    rpc_dev_run: "–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç",

    // tx panel
    p_tx_kicker: "Tx Decoder",
    p_tx_title: "–î–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é",
    p_tx_sub:
      "–í—Å—Ç–∞–≤—å—Ç–µ tx hash. –ü–æ–ª—É—á–∏–º tx + receipt –∏ –¥–µ–∫–æ–¥–∏—Ä—É–µ–º input –∏ —Å–æ–±—ã—Ç–∏—è (Transfer / Approval + –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ swap –≤—ã–∑–æ–≤—ã).",
    tx_input_title: "–í–≤–æ–¥ Tx",
    tx_hash_label: "–•—ç—à —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏",
    tx_tip:
      '–°–æ–≤–µ—Ç: –æ—Ç–∫—Ä–æ–π—Ç–µ <span class="mono">?tool=tx&net=bsc&tx=0x...</span> –¥–ª—è –∞–≤—Ç–æ-—Å—Ç–∞—Ä—Ç–∞.',
    tx_results_title: "–î–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤—ã–≤–æ–¥",

    // dev panel
    p_dev_kicker: "Dev Tools",
    p_dev_title: "Bookmarklet + –ª–æ–∫–∞–ª—å–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä",
    p_dev_sub:
      "–°–æ–∑–¥–∞–π—Ç–µ bookmarklet, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç token/tx —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü explorer –≤ CycleX Hub. –¢–∞–∫–∂–µ –µ—Å—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤ (—Å–ø–∏—Å–æ–∫ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ).",
    bm_title: "–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä Bookmarklet",
    bm_hint:
      "–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –≤ –ø–∞–Ω–µ–ª—å –∑–∞–∫–ª–∞–¥–æ–∫ –∏–ª–∏ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ bookmarklet. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–∞ BscScan/Etherscan.",
    bm_base_label: "Hub URL (—ç—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞)",
    bm_generate: "–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å",
    bm_copy: "–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å Bookmarklet",

    mon_add_title: "–î–æ–±–∞–≤–∏—Ç—å –≤ —Å–ø–∏—Å–æ–∫",
    mon_list_title: "–ú–æ–Ω–∏—Ç–æ—Ä –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤ (–ª–æ–∫–∞–ª—å–Ω–æ)",
    mon_list_hint: "–•—Ä–∞–Ω–∏—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ. –ë–µ–∑ —Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ —Ç—Ä–µ–∫–∏–Ω–≥–∞.",
    mon_add: "–î–æ–±–∞–≤–∏—Ç—å",
    mon_check: "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ",
    mon_export: "–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å JSON",

    // footer
    footer_left:
      "CycleX Security Hub —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ –∏ —á–∏—Ç–∞–µ—Ç –ø—É–±–ª–∏—á–Ω—ã–µ –æ–Ω—á–µ–π–Ω-–¥–∞–Ω–Ω—ã–µ.",
    footer_tagline: "–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –¥–≤–∞–∂–¥—ã. –ü–æ–¥–∫–ª—é—á–∞–π—Ç–µ—Å—å —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –¥–æ–≤–µ—Ä—è–µ—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü–µ.",
    // --- ADD THESE KEYS (RU) ---
title_back_to_cyclex: "–ù–∞–∑–∞–¥ –∫ CycleX",
aria_lang_selector: "–í—ã–±–æ—Ä —è–∑—ã–∫–∞",
badge_table: "–¢–∞–±–ª–∏—Ü–∞",
btn_share_x: "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –≤ X",
btn_share_tg: "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –≤ Telegram",
net_bsc: "BSC (BNB Chain)",
net_eth: "–≠—Ñ–∏—Ä–∏—É–º",
spender_pcs_router: "PancakeSwap Router (BSC)",
spender_uni_router: "Uniswap V2 Router (ETH)",
spender_custom: "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π‚Ä¶",

th_token: "–¢–æ–∫–µ–Ω",
th_allowance: "–õ–∏–º–∏—Ç",
th_symbol: "–°–∏–º–≤–æ–ª",
th_action: "–î–µ–π—Å—Ç–≤–∏–µ",
th_rpc: "RPC",
th_ms: "–º—Å",
th_chain: "—Å–µ—Ç—å",
th_block: "–±–ª–æ–∫",
th_call: "call",
th_logs: "–ª–æ–≥–∏",
th_status: "—Å—Ç–∞—Ç—É—Å",
th_contract: "–ö–æ–Ω—Ç—Ä–∞–∫—Ç",
th_network: "–°–µ—Ç—å",
th_last_seen: "–ü–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–∑",
    th_pairpool: "–ü–∞—Ä–∞/–ü—É–ª",
th_type: "–¢–∏–ø",
th_target: "–¶–µ–ª—å",
th_result: "–†–µ–∑—É–ª—å—Ç–∞—Ç",
btn_remove: "–£–¥–∞–ª–∏—Ç—å",
toast_imported_token: "–ò–º–ø–æ—Ä—Ç —Ç–æ–∫–µ–Ω–∞ –∏–∑ explorer:",
toast_imported_tx: "–ò–º–ø–æ—Ä—Ç tx –∏–∑ explorer:",
err_no_working_rpc: "–ù–µ –Ω–∞–π–¥–µ–Ω —Ä–∞–±–æ—á–∏–π RPC. –û—Ç–∫—Ä–æ–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç RPC –∏ –∑–∞–¥–∞–π—Ç–µ —Ä–∞–±–æ—á–∏–π endpoint.",


qs_ready_html: "<strong>–ì–æ—Ç–æ–≤–æ.</strong><br>–í—Å—Ç–∞–≤—å—Ç–µ –∞–¥—Ä–µ—Å —Ç–æ–∫–µ–Ω–∞ –∏ –Ω–∞–∂–º–∏—Ç–µ <b>–°–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å</b>.",
liq_ready_html: "<strong>–ì–æ—Ç–æ–≤–æ.</strong><br>–í—Å—Ç–∞–≤—å—Ç–µ –∞–¥—Ä–µ—Å —Ç–æ–∫–µ–Ω–∞ –∏ –Ω–∞–∂–º–∏—Ç–µ <b>–°–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å</b>.",
tx_ready_html: "<strong>–ì–æ—Ç–æ–≤–æ.</strong><br>–í—Å—Ç–∞–≤—å—Ç–µ tx hash –∏ –Ω–∞–∂–º–∏—Ç–µ <b>–î–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å</b>.",

ph_0x: "0x...",
ph_spender: "0x spender...",
ph_token_list: "0x...\n0x...\n0x...",
ph_bscscan_key: "BscScan API key (–ª–æ–∫–∞–ª—å–Ω–æ)",
ph_etherscan_key: "Etherscan API key (–ª–æ–∫–∞–ª—å–Ω–æ)",
ph_rpc_private: "https://... (—Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ)",
ph_rpc_custom: "https://...",
ph_rpc_dev_topic: "0xddf252ad... (Transfer) –∏–ª–∏ –æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º"

  }
};
// =========================
// i18n (after translations)
// =========================
let currentLang = "en";
const $ = (sel) => document.querySelector(sel);
const $$ = (sel) => Array.from(document.querySelectorAll(sel));

function normalizeLang(x){
  const v = String(x || "").trim().toLowerCase();
  const map = { "cn":"zh", "zh-cn":"zh", "zh-hans":"zh" };
  return map[v] || v;
}

function setDirForLang(lang) {
  const html = document.documentElement;
  html.setAttribute("lang", lang === "zh" ? "zh" : lang);
  html.setAttribute("dir", lang === "ar" ? "rtl" : "ltr");
}

// ‚úÖ t(lang,key) with EN fallback
function t(lang, key) {
  return (translations?.[lang]?.[key] ?? translations?.en?.[key] ?? "");
}

function applyI18n(lang) {
  const L = normalizeLang(lang || currentLang);
  currentLang = translations?.[L] ? L : "en";

  if (document.body) {
    document.body.classList.add("lang-switching");
    setTimeout(() => document.body && document.body.classList.remove("lang-switching"), 260);
  }

  // normal text/HTML
  $$("[data-i18n]").forEach((el) => {
    const key = el.getAttribute("data-i18n");
    const val = t(currentLang, key);
    if (val) el.innerHTML = val;
  });

  // placeholders
  $$("[data-i18n-placeholder]").forEach((el) => {
    const key = el.getAttribute("data-i18n-placeholder");
    const val = t(currentLang, key);
    if (val) el.setAttribute("placeholder", val);
  });

  // title attr
  $$("[data-i18n-title]").forEach((el) => {
    const key = el.getAttribute("data-i18n-title");
    const val = t(currentLang, key);
    if (val) el.setAttribute("title", val);
  });

  // aria-label attr
  $$("[data-i18n-aria-label]").forEach((el) => {
    const key = el.getAttribute("data-i18n-aria-label");
    const val = t(currentLang, key);
    if (val) el.setAttribute("aria-label", val);
  });

  setDirForLang(currentLang);

  // keep your existing behavior
  try { renderWalletLabels && renderWalletLabels(); } catch {}
}

function setLang(lang) {
  const picked = normalizeLang(lang);
  currentLang = translations?.[picked] ? picked : "en";

  try { localStorage.setItem("cx_sec_lang", currentLang); } catch {}

  $$(".lang-btn").forEach((b) => {
    const bl = normalizeLang(b.dataset?.lang || b.getAttribute("data-lang") || "");
    b.classList.toggle("active", bl === currentLang);
  });

  applyI18n(currentLang);
}

function initLang() {
  let saved = null;
  try { saved = localStorage.getItem("cx_sec_lang"); } catch {}

  const s = normalizeLang(saved);
  setLang(translations?.[s] ? s : "en");
}

// =========================
// i18n buttons wiring (FIX)
// =========================
function bindLangButtons(){
  $$(".lang-btn").forEach(btn => {
    btn.addEventListener("click", (e) => {
      try { e.preventDefault(); } catch {}

      const raw = btn.dataset?.lang || btn.getAttribute("data-lang") || "";
      const lang = normalizeLang(raw);

      setLang(lang);
      try { gtagEvent && gtagEvent("sec_lang_change", { lang }); } catch {}
    }, { passive: false });
  });
}

  // =========================
  // Utils
  // =========================
  const clamp = (n, a, b) => Math.max(a, Math.min(b, n));
  const nowTs = () => Math.floor(Date.now() / 1000);

  function shortAddr(a) {
    return (!a || typeof a !== "string") ? "‚Äî" : `${a.slice(0, 6)}‚Ä¶${a.slice(-4)}`;
  }
  function safeJson(obj) {
    try { return JSON.stringify(obj, null, 2); } catch { return "{}"; }
  }

  async function copyText(text) {
    try {
      await navigator.clipboard.writeText(text);
      return true;
    } catch {
      try {
        const ta = document.createElement("textarea");
        ta.value = text;
        document.body.appendChild(ta);
        ta.select();
        document.execCommand("copy");
        ta.remove();
        return true;
      } catch {
        return false;
      }
    }
  }
  

  function setStatus(el, type, html) {
    if (!el) return;
    el.classList.remove("ok", "warn", "bad", "info");
    el.classList.add(type);
    el.style.display = "block";
    el.innerHTML = html;
  }
  function clearStatus(el) {
    if (!el) return;
    el.style.display = "none";
    el.innerHTML = "";
    el.classList.remove("ok", "warn", "bad", "info");
  }

  function gtagEvent(name, params = {}) {
    try {
      if (typeof window.gtag === "function") window.gtag("event", name, params);
    } catch {}
  }

  function parseQuery() {
  const u = new URL(location.href);
  const sp = u.searchParams;

  let tool = (sp.get("tool") || "").toLowerCase();

  // accept more net aliases (incl chainId)
  let net = (sp.get("net") || sp.get("chain") || sp.get("network") || sp.get("chainId") || "").toLowerCase();
  if (net === "56" || net === "bsc" || net === "bnb" || net === "bnbchain" || net === "bnb-chain") net = "bsc";
  if (net === "1" || net === "eth" || net === "ethereum") net = "eth";

  // accept more params for token/tx
  const token = sp.get("token") || sp.get("addr") || sp.get("address") || sp.get("contract") || sp.get("a") || "";
  const tx = sp.get("tx") || sp.get("hash") || sp.get("txhash") || "";

  // infer tool if missing
  if (!tool) {
    if (/^0x[a-fA-F0-9]{64}$/.test(String(tx).trim())) tool = "tx";
    else if (E.isAddress(String(token).trim())) tool = "quick";
  }

  return { tool, net, token, tx };
}

  // =========================
  // Panels / Tiles
  // =========================
  let toolCards = [];
  let panels = {};

  function initPanels() {
    toolCards = $$("#toolGrid .tool-card");
    panels = {
      quick: $("#panel-quick"),
      liq: $("#panel-liq"),
      approvals: $("#panel-approvals"),
      rpc: $("#panel-rpc"),
      tx: $("#panel-tx"),
      dev: $("#panel-dev")
    };

    function showPanel(key) {
      Object.entries(panels).forEach(([k, el]) => {
        if (el) el.classList.toggle("hidden", k !== key);
      });
      toolCards.forEach((c) => c.classList.toggle("active", c.dataset.tool === key));
      if (key) gtagEvent("sec_tool_open", { tool: key });
    }
    window.showPanel = showPanel;

    toolCards.forEach((card) => card.addEventListener("click", () => showPanel(card.dataset.tool)));

    $("#btnCloseQuick")?.addEventListener("click", () => showPanel(null));
    $("#btnCloseLiq")?.addEventListener("click", () => showPanel(null));
    $("#btnCloseApprovals")?.addEventListener("click", () => showPanel(null));
    $("#btnCloseRpc")?.addEventListener("click", () => showPanel(null));
    $("#btnCloseTx")?.addEventListener("click", () => showPanel(null));
    $("#btnCloseDev")?.addEventListener("click", () => showPanel(null));

    $("#btn-quick")?.addEventListener("click", () => {
      showPanel("quick");
      $("#qs-token")?.focus();
      gtagEvent("sec_quick_btn");
    });
  }

  // =========================
  // Wallet (AppKit) ‚Äî single global state
  // =========================
  const wallet = {
    providerRaw: null,     // EIP-1193
    browserProvider: null, // ethers BrowserProvider
    signer: null,
    address: "",
    chainId: 0
  };

  function renderWalletLabels() {
    const notConn = translations?.[currentLang]?.wallet_not_connected
      ?? translations?.en?.wallet_not_connected
      ?? "not connected";

    const labelTxt = wallet.address ? wallet.address : notConn;

    const w1 = $("#walletLabel");
    if (w1) w1.textContent = labelTxt;

    const w2 = $("#ap-wallet");
    if (w2) w2.textContent = labelTxt;

    const w3 = $("#liq-wallet");
    if (w3) w3.textContent = labelTxt;

    const w4 = $("#ap-address");
    if (w4) w4.textContent = wallet.address ? shortAddr(wallet.address) : "‚Äî";
  }

  function attachProviderListeners(p) {
    try {
      if (!p || typeof p.on !== "function") return;

      p.removeAllListeners?.("accountsChanged");
      p.removeAllListeners?.("chainChanged");

      p.on("accountsChanged", async (accs) => {
        const a = (accs && accs[0]) ? E.getAddress(accs[0]) : "";
        wallet.address = a;
        renderWalletLabels();
      });

      p.on("chainChanged", async (hex) => {
        try { wallet.chainId = Number(hex); } catch { wallet.chainId = 0; }
        renderWalletLabels();
      });
    } catch {}
  }

  async function cxConnectWallet({ silent = false } = {}) {
    const stQuick = $("#qs-status");
    try {
      await window.CxAppKitModal?.open?.({ view: "ConnectWallet" });

      const providerRaw = await waitForWalletProvider(12000);
      if (!providerRaw) {
        if (!silent) setStatus(stQuick, "warn", "Wallet provider not ready (timeout). Try again.");
        return false;
      }

      wallet.providerRaw = providerRaw;
      attachProviderListeners(providerRaw);

      const bp = new E.BrowserProvider(providerRaw);
      wallet.browserProvider = bp;

      const signer = await bp.getSigner();
      wallet.signer = signer;

      const addr = await signer.getAddress();
      const net = await bp.getNetwork();

      wallet.address = E.getAddress(addr);
      wallet.chainId = Number(net.chainId || 0);

      renderWalletLabels();
      if (!silent) setStatus(stQuick, "ok", `Wallet connected: <span class="mono">${wallet.address}</span>`);
      gtagEvent("sec_wallet_connected", { chainId: wallet.chainId });

      return true;
    } catch (e) {
      if (!silent) setStatus(stQuick, "bad", `Wallet connect failed: ${String(e?.message || e)}`);
      return false;
    }
  }

  async function ensureChain(targetChainId) {
    const p = wallet.providerRaw;
    if (!p?.request) return false;
    try {
      await p.request({
        method: "wallet_switchEthereumChain",
        params: [{ chainId: "0x" + Number(targetChainId).toString(16) }]
      });
      await cxConnectWallet({ silent: true });
      return true;
    } catch {
      return false;
    }
  }

  // connect buttons
  function initWalletButtons() {
    $("#btn-connect")?.addEventListener("click", async () => { await cxConnectWallet(); });
    $("#ap-connect")?.addEventListener("click", async () => { await cxConnectWallet(); });
  }

  // =========================
  // Explorer API keys (local)
  // =========================
  const LS_KEYS = "cx_sec_explorer_keys";

  function loadApiKeys() {
    try {
      const raw = localStorage.getItem(LS_KEYS);
      if (!raw) return { bscscan: "", etherscan: "", use: false };
      const o = JSON.parse(raw);
      return { bscscan: o?.bscscan || "", etherscan: o?.etherscan || "", use: !!o?.use };
    } catch {
      return { bscscan: "", etherscan: "", use: false };
    }
  }
  function saveApiKeys(keys) {
    try { localStorage.setItem(LS_KEYS, JSON.stringify(keys)); } catch {}
  }

  function initApiKeysUi() {
    const keys = loadApiKeys();

    const useEl = $("#api-use");
    if (useEl) useEl.checked = keys.use;

    const b1 = $("#api-bscscan");
    if (b1) b1.value = keys.bscscan;

    const b2 = $("#api-etherscan");
    if (b2) b2.value = keys.etherscan;

    $("#api-save")?.addEventListener("click", () => {
      const nk = {
        use: !!$("#api-use")?.checked,
        bscscan: ($("#api-bscscan")?.value || "").trim(),
        etherscan: ($("#api-etherscan")?.value || "").trim()
      };
      saveApiKeys(nk);
      setStatus($("#qs-status"), "ok", "Saved keys to localStorage.");
      gtagEvent("sec_keys_saved", { use: nk.use ? 1 : 0 });
    });

    $("#api-clear")?.addEventListener("click", () => {
      saveApiKeys({ use: false, bscscan: "", etherscan: "" });

      const u = $("#api-use");
      if (u) u.checked = false;

      const i1 = $("#api-bscscan");
      if (i1) i1.value = "";

      const i2 = $("#api-etherscan");
      if (i2) i2.value = "";

      setStatus($("#qs-status"), "ok", "Cleared keys.");
      gtagEvent("sec_keys_cleared");
    });
  }

  // =========================
  // Network + DEX Registry (BNB / ETH + USDT)
  // =========================
  const CHAINS = {
    bsc: {
      chainId: 56,
      name: "BSC",
      wrapped: "0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c", // WBNB
      usdt: "0x55d398326f99059ff775485246999027b3197955", // USDT (BSC)
      explorer: "https://bscscan.com",
      addressUrl: (a) => `https://bscscan.com/address/${a}`,
      txUrl: (h) => `https://bscscan.com/tx/${h}`,
      publicRpcs: [
        "https://bsc-dataseed.binance.org",
        "https://bsc-dataseed1.bnbchain.org",
        "https://bsc-dataseed2.bnbchain.org",
        "https://bsc-dataseed3.bnbchain.org",
        "https://bsc.publicnode.com",
        "https://bsc-rpc.publicnode.com"
      ]
    },
    eth: {
      chainId: 1,
      name: "Ethereum",
      wrapped: "0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2", // WETH
      usdt: "0xdAC17F958D2ee523a2206206994597C13D831ec7", // USDT (ETH)
      explorer: "https://etherscan.io",
      addressUrl: (a) => `https://etherscan.io/address/${a}`,
      txUrl: (h) => `https://etherscan.io/tx/${h}`,
      publicRpcs: [
        "https://cloudflare-eth.com",
        "https://rpc.ankr.com/eth",
        "https://ethereum.publicnode.com",
        "https://eth.llamarpc.com"
      ]
    }
  };

  const DEX = {
    bsc: {
      v2Factory: "0xca143ce32fe78f1f7019d7d551a6402fc5350c73", // Pancake V2 Factory
      v3Factory: "0x0BFbCF9fa4f9C56B0F40a671Ad40E0805A091865", // Pancake V3 Factory
      routerV2: "0x10ED43C718714eb63d5aA57B78B54704E256024E", // Pancake V2 Router
      label: "PancakeSwap"
    },
    eth: {
      v2Factory: "0x5C69bEe701ef814a2B6a3EDD4B1652CB9cc5aA6f", // Uniswap V2 Factory
      v3Factory: "0x1F98431c8aD98523631AE4a59f267346ea31F984", // Uniswap V3 Factory
      routerV2: "0x7a250d5630B4cF539739dF2C5dAcb4c659F2488D", // Uniswap V2 Router
      label: "Uniswap"
    }
  };

  // =========================
  // ABIs (minimal)
  // =========================
  const ERC20_ABI = [
    "function name() view returns (string)",
    "function symbol() view returns (string)",
    "function decimals() view returns (uint8)",
    "function totalSupply() view returns (uint256)",
    "function balanceOf(address) view returns (uint256)",
    "function allowance(address,address) view returns (uint256)",
    "function approve(address,uint256) returns (bool)"
  ];

  const V2_FACTORY_ABI = [
    "function getPair(address tokenA, address tokenB) external view returns (address pair)"
  ];
  const V2_PAIR_ABI = [
    "function token0() view returns (address)",
    "function token1() view returns (address)",
    "function getReserves() view returns (uint112 reserve0, uint112 reserve1, uint32 blockTimestampLast)"
  ];

  const V3_FACTORY_ABI = [
    "function getPool(address tokenA, address tokenB, uint24 fee) external view returns (address pool)"
  ];
  const V3_POOL_ABI = [
  "function token0() view returns (address)",
  "function token1() view returns (address)",
  "function fee() view returns (uint24)",
  "function liquidity() view returns (uint128)",
  "function slot0() view returns (uint160 sqrtPriceX96,int24 tick,uint16 observationIndex,uint16 observationCardinality,uint16 observationCardinalityNext,uint8 feeProtocol,bool unlocked)"
];


  const TRANSFER_TOPIC0 = "0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef";
  const APPROVAL_TOPIC0 = "0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925";

  // =========================
  // Local storage keys
  // =========================
  const LS_BEST_RPC = (net) => `cx_sec_best_rpc_${net}`;
  const LS_PRIV_RPC = (net) => `cx_sec_private_rpc_${net}`;
  const LS_QS_CACHE = "cx_sec_qs_cache_v1";
  const LS_QS_HISTORY = "cx_sec_qs_history_v1";

  // =========================
  // RPC helpers (raw fetch)
  // =========================
  async function rpcRequest(url, method, params = [], timeoutMs = 9000) {
    const ctrl = new AbortController();
    const tmr = setTimeout(() => ctrl.abort(), timeoutMs);
    const body = JSON.stringify({ jsonrpc: "2.0", id: 1, method, params });

    try {
      const res = await fetch(url, {
        method: "POST",
        headers: { "content-type": "application/json" },
        body,
        signal: ctrl.signal
      });
      if (!res.ok) throw new Error(`HTTP ${res.status}`);
      const j = await res.json();
      if (j.error) throw new Error(j.error.message || "RPC error");
      return j.result;
    } finally {
      clearTimeout(tmr);
    }
  }

  function uniq(arr) {
    const s = new Set();
    const out = [];
    for (const x of arr) {
      const k = String(x || "").trim();
      if (!k) continue;
      if (s.has(k)) continue;
      s.add(k);
      out.push(k);
    }
    return out;
  }

  function getSavedBestRpc(net) {
    try { return localStorage.getItem(LS_BEST_RPC(net)) || ""; } catch { return ""; }
  }
  function setSavedBestRpc(net, url) {
    try { localStorage.setItem(LS_BEST_RPC(net), url); } catch {}
  }

  function getSavedPrivateRpc(net) {
    try { return localStorage.getItem(LS_PRIV_RPC(net)) || ""; } catch { return ""; }
  }
  function setSavedPrivateRpc(net, url) {
    try { localStorage.setItem(LS_PRIV_RPC(net), url); } catch {}
  }

  function buildRpcCandidates(net) {
    const chain = CHAINS[net];
    const custom = ($("#rpc-custom")?.value || "").trim();
    const privSaved = getSavedPrivateRpc(net);
    const privInput = ($("#rpc-private")?.value || "").trim();
    const bestSaved = getSavedBestRpc(net);

    return uniq([
      custom,
      privInput,
      privSaved,
      bestSaved,
      ...(chain?.publicRpcs || [])
    ]);
  }

  function getReadProvider(net) {
    const chain = CHAINS[net];
    const custom = ($("#rpc-custom")?.value || "").trim();
    const bestSaved = getSavedBestRpc(net);
    const privSaved = getSavedPrivateRpc(net);

    const url = custom || privSaved || bestSaved || (chain?.publicRpcs?.[0] || "");
    if (!url) return null;

    try { return new E.JsonRpcProvider(url, chain.chainId); } catch { return null; }
  }
    // =========================
// Unified RPC + Provider per network (single source of truth)
// =========================
const _cxProviders = { bsc: null, eth: null };
const _cxProviderUrl = { bsc: "", eth: "" };

function cxGetRpcCandidates(net){
  const n = (net === "eth") ? "eth" : "bsc";
  const arr = [];

  // 1) Custom RPC (UI top priority)
  const custom = ($("#rpc-custom")?.value || "").trim();
  if (custom) arr.push(custom);

  // 2) Saved private RPC (per network)
  const priv = (getSavedPrivateRpc(n) || "").trim();
  if (priv) arr.push(priv);

  // 3) Best RPC from last test (per network)
  const best = (getSavedBestRpc(n) || "").trim();
  if (best) arr.push(best);

  // 4) Public list per chain
  arr.push(...(CHAINS?.[n]?.publicRpcs || []));

  return uniq(arr);
}

async function cxPickWorkingRpc(net, timeoutMs = 8500){
  const n = (net === "eth") ? "eth" : "bsc";
  const candidates = cxGetRpcCandidates(n);

  for (const url of candidates){
    try{
      // chainId sanity check (prevents "using BSC rpc for ETH")
      const cidHex = await rpcRequest(url, "eth_chainId", [], timeoutMs);
      const cid = Number(cidHex);
      if (cid !== Number(CHAINS[n].chainId)) continue;

      // latest block sanity
      await rpcRequest(url, "eth_blockNumber", [], timeoutMs);

      _cxProviderUrl[n] = url;
      return url;
    }catch{}
  }
  return "";
}

async function cxGetProvider(net){
  const n = (net === "eth") ? "eth" : "bsc";

  // reuse if already good
  if (_cxProviders[n] && _cxProviderUrl[n]) return _cxProviders[n];

  const url = await cxPickWorkingRpc(n);
  if (!url) throw new Error(`No working ${n.toUpperCase()} RPC found`);

  _cxProviderUrl[n] = url;
  _cxProviders[n] = new E.JsonRpcProvider(url, CHAINS[n].chainId);
  return _cxProviders[n];
}

function cxResetProvider(net){
  const n = (net === "eth") ? "eth" : "bsc";
  _cxProviders[n] = null;
  _cxProviderUrl[n] = "";
}


  // =========================
  // Explorer APIs (optional)
  // =========================
  function explorerApiBase(net) {
    return net === "bsc" ? "https://api.bscscan.com/api" : "https://api.etherscan.io/api";
  }

  async function explorerGetSource(net, addr, apiKey) {
    const base = explorerApiBase(net);
    const u = new URL(base);
    u.searchParams.set("module", "contract");
    u.searchParams.set("action", "getsourcecode");
    u.searchParams.set("address", addr);
    if (apiKey) u.searchParams.set("apikey", apiKey);

    const r = await fetch(u.toString());
    const j = await r.json();
    if (!j || j.status !== "1" || !j.result || !j.result[0]) return { ok: false, raw: j };

    const row = j.result[0];
    return {
      ok: true,
      verified: !!(row.SourceCode && String(row.SourceCode).trim().length > 0),
      contractName: row.ContractName || "",
      isProxy: String(row.Proxy || "").toLowerCase() === "1",
      impl: row.Implementation || "",
      abi: row.ABI || ""
    };
  }

  // =========================
  // Heuristic bytecode checks
  // =========================
  function codeHasSelector(codeHex, selectorNo0x) {
    if (!codeHex || codeHex === "0x") return false;
    const s = selectorNo0x.toLowerCase();
    return codeHex.toLowerCase().includes("63" + s);
  }

  const SEL = {
    owner: "8da5cb5b",
    pause: "8456cb59",
    unpause: "3f4ba83a",
    paused: "5c975abb",
    mint: "40c10f19",
    blacklist1: "5c0e5f47",
    blacklist2: "9a5c0d65",
    setTax1: "b21d7b0b"
  };

  async function tryReadOwner(provider, addr) {
    try {
      const data = "0x" + SEL.owner;
      const r = await provider.call({ to: addr, data });
      if (!r || r === "0x") return "";
      const a = "0x" + r.slice(-40);
      if (E.isAddress(a)) return E.getAddress(a);
      return "";
    } catch { return ""; }
  }

  async function tryEip1967Impl(provider, addr) {
    const slot = "0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc";
    try {
      const v = await provider.getStorage(addr, slot);
      if (!v || v === "0x" || /^0x0+$/.test(v)) return "";
      const a = "0x" + v.slice(-40);
      if (E.isAddress(a) && a !== "0x0000000000000000000000000000000000000000") return E.getAddress(a);
      return "";
    } catch { return ""; }
  }

  // =========================
  // UI helpers: risk badges
  // =========================
  function riskBadge(type, label, detail = "") {
    const div = document.createElement("div");
    div.className = `risk ${type}`;
    div.innerHTML = `<span class="dot"></span><span><b>${label}</b>${detail ? ` ‚Äî ${detail}` : ""}</span>`;
    return div;
  }

  function setPairsWrap(el, rowsHtml) {
    if (!el) return;
    el.innerHTML = rowsHtml || "";
  }

  function fmtNum(n) {
    try {
      if (n === null || n === undefined) return "‚Äî";
      const x = Number(n);
      if (!isFinite(x)) return String(n);
      if (x >= 1e9) return (x / 1e9).toFixed(2) + "B";
      if (x >= 1e6) return (x / 1e6).toFixed(2) + "M";
      if (x >= 1e3) return (x / 1e3).toFixed(2) + "K";
      return x.toFixed(0);
    } catch {
      return String(n);
    }
  }

  function netFromSelect(selId) {
    const v = ($(selId)?.value || "bsc").toLowerCase();
    return (v === "eth") ? "eth" : "bsc";
  }

  function explorerKeyFor(net) {
    const keys = loadApiKeys();
    if (!keys.use) return "";
    if (net === "bsc") return (keys.bscscan || "").trim();
    return (keys.etherscan || "").trim();
  }

  // =========================
  // Quick Scan (score + report + cache)
  // =========================
  function qsCacheGet(key) {
    try {
      const raw = localStorage.getItem(LS_QS_CACHE);
      if (!raw) return null;
      const obj = JSON.parse(raw);
      return obj?.[key] || null;
    } catch { return null; }
  }
  function qsCacheSet(key, payload) {
    try {
      const raw = localStorage.getItem(LS_QS_CACHE);
      const obj = raw ? JSON.parse(raw) : {};
      obj[key] = payload;
      localStorage.setItem(LS_QS_CACHE, JSON.stringify(obj));
    } catch {}
  }

  function qsAddHistory(net, token) {
    try {
      const raw = localStorage.getItem(LS_QS_HISTORY);
      const obj = raw ? JSON.parse(raw) : { bsc: [], eth: [] };
      const arr = Array.isArray(obj[net]) ? obj[net] : [];
      const tt = E.getAddress(token);
      const next = [tt, ...arr.filter(x => String(x).toLowerCase() !== tt.toLowerCase())].slice(0, 30);
      obj[net] = next;
      localStorage.setItem(LS_QS_HISTORY, JSON.stringify(obj));
    } catch {}
  }
  function qsGetHistory(net) {
    try {
      const raw = localStorage.getItem(LS_QS_HISTORY);
      const obj = raw ? JSON.parse(raw) : { bsc: [], eth: [] };
      return Array.isArray(obj[net]) ? obj[net] : [];
    } catch { return []; }
  }

  function qsBuildShareLink(net, token) {
    const u = new URL(location.href);
    u.searchParams.set("tool", "quick");
    u.searchParams.set("net", net);
    u.searchParams.set("token", token);
    return u.toString();
  }

  function qsBuildXText(summary) {
    const base =
      `${summary.title}\nScore: ${summary.score}/100\n${summary.net.toUpperCase()} ‚Ä¢ ${summary.tokenShort}\n` +
      `${summary.flags.join(" ‚Ä¢ ")}\n` +
      `Verify on explorers + don't sign blind approvals.`;
    return base.slice(0, 270);
  }

  function qsBuildMarkdown(summary) {
    return [
      `## CycleX Quick Scan`,
      ``,
      `- **Network:** ${summary.net.toUpperCase()}`,
      `- **Token:** \`${summary.token}\``,
      `- **Score:** **${summary.score}/100**`,
      `- **Verified:** ${summary.verified ? "Yes" : "No / Unknown"}`,
      `- **Proxy:** ${summary.isProxy ? "Yes" : "No / Unknown"}${summary.impl ? ` (impl: \`${summary.impl}\`)` : ""}`,
      `- **Owner:** ${summary.owner ? `\`${summary.owner}\`` : "Unknown"}`,
      `- **Liquidity (V2/V3):** ${summary.liqHint}`,
      ``,
      `### Flags`,
      `${summary.flags.map(x => `- ${x}`).join("\n")}`,
      ``,
      `### Notes`,
      `These checks are informational and do not guarantee safety. Always verify independently.`,
    ].join("\n");
  }

  async function runQuickScan({ auto = false } = {}) {
    const st = $("#qs-status");
    const out = $("#qs-out");
    const risk = $("#qs-risk");
    const pairsWrap = $("#qs-pairsWrap");

    clearStatus(st);
    if (risk) risk.innerHTML = "";
    if (pairsWrap) pairsWrap.innerHTML = "";

    const net = netFromSelect("#qs-net");
    const tokenRaw = ($("#qs-token")?.value || "").trim();
    if (!E.isAddress(tokenRaw)) {
      setStatus(st, "warn", "Invalid token address.");
      return;
    }
    const token = E.getAddress(tokenRaw);

        let provider = null;
    try { provider = await cxGetProvider(net); } catch {}
    if (!provider) {
      setStatus(st, "bad", t(currentLang, "err_no_working_rpc") || "No working RPC found. Open RPC tool and set a working endpoint.");
      return;
    }

    const requireLiq = !!$("#qs-require-liq")?.checked;
    const cacheKey = `${net}:${token}:${requireLiq ? 1 : 0}:${explorerKeyFor(net) ? 1 : 0}`;
    const cached = qsCacheGet(cacheKey);

    const now = Date.now();
    if (cached && (now - (cached.ts || 0) < 10 * 60 * 1000)) {
      renderQuickScanResult(cached.data, { cached: true });
      setStatus(st, "ok", `Loaded cached result (‚â§10 min).`);
      return;
    }

    setStatus(st, "info", "Scanning‚Ä¶");

    try {
      const code = await provider.getCode(token);
      if (!code || code === "0x") {
        setStatus(st, "bad", "Address has no contract code.");
        return;
      }

      const tokenC = new E.Contract(token, ERC20_ABI, provider);
      let symbol = "?", decimals = 18, name = "";
      try { symbol = await tokenC.symbol(); } catch {}
      try { decimals = await tokenC.decimals(); } catch {}
      try { name = await tokenC.name(); } catch {}

      const impl1967 = await tryEip1967Impl(provider, token);
      const owner = await tryReadOwner(provider, token);

      const apiKey = explorerKeyFor(net);
      let verified = false, isProxy = !!impl1967, impl = impl1967, contractName = "";
      if (apiKey) {
        const s = await explorerGetSource(net, token, apiKey);
        if (s.ok) {
          verified = !!s.verified;
          contractName = s.contractName || "";
          if (s.isProxy) isProxy = true;
          if (s.impl && E.isAddress(s.impl)) impl = E.getAddress(s.impl);
        }
      }

      const liq = await liqCheckBasic(net, token, provider);

      const hasMint = codeHasSelector(code, SEL.mint);
      const hasPause = codeHasSelector(code, SEL.pause) || codeHasSelector(code, SEL.paused);
      const hasBlacklist = codeHasSelector(code, SEL.blacklist1) || codeHasSelector(code, SEL.blacklist2);
      const hasTax = codeHasSelector(code, SEL.setTax1);

      let score = 100;
      const flags = [];

      if (!apiKey) flags.push("Explorer API keys not enabled (proxy/verified limited).");
      if (apiKey && !verified) { score -= 18; flags.push("Not verified on explorer (or cannot read)."); }
      if (verified) flags.push("Verified source on explorer.");

      if (isProxy) { score -= 8; flags.push("Proxy detected (verify implementation)."); }
      else flags.push("No proxy flag detected.");

      if (!owner) { score -= 6; flags.push("Owner unknown (no owner() or read failed)."); }
      else {
        const zero = "0x0000000000000000000000000000000000000000";
        if (owner.toLowerCase() === zero) flags.push("Owner is renounced (0x0).");
        else { score -= 10; flags.push("Owner is set (centralized control possible)."); }
      }

      if (hasMint) { score -= 18; flags.push("Mint-like selector detected in bytecode (possible inflation)."); }
      if (hasPause) { score -= 10; flags.push("Pause-like selector detected (trading can be halted)."); }
      if (hasBlacklist) { score -= 10; flags.push("Blacklist-like selectors detected (addresses can be blocked)."); }
      if (hasTax) { score -= 8; flags.push("Tax-setting selector detected (fees can change)."); }

      if (!liq.any) {
        score -= requireLiq ? 35 : 18;
        flags.push("No liquidity detected (V2/V3 vs Wrapped/USDT).");
      } else {
        flags.push(`Liquidity detected: ${liq.hint}`);
      }

      score = clamp(score, 0, 100);

      const data = {
        ts: Date.now(),
        net,
        token,
        tokenShort: shortAddr(token),
        symbol,
        decimals,
        name,
        score,
        verified,
        isProxy,
        impl,
        contractName,
        owner,
        hasMint, hasPause, hasBlacklist, hasTax,
        liq
      };

      qsCacheSet(cacheKey, { ts: Date.now(), data });
      qsAddHistory(net, token);

      renderQuickScanResult(data, { cached: false });
      setStatus(st, "ok", `Done. Score: <b>${score}/100</b>`);
      gtagEvent("sec_quick_scan", { net, score });

    } catch (e) {
      setStatus(st, "bad", `Scan failed: ${String(e?.message || e)}`);
    }

    function renderQuickScanResult(d, { cached }) {
      const lines = [];
      lines.push(`<b>${d.symbol || "TOKEN"}</b> ${d.name ? `‚Äî ${d.name}` : ""}`);
      lines.push(`<div class="small" style="margin-top:6px">Network: <b>${d.net.toUpperCase()}</b> ‚Ä¢ Score: <b>${d.score}/100</b>${cached ? " ‚Ä¢ <b>(cached)</b>" : ""}</div>`);
      lines.push(`<div class="small" style="margin-top:6px">Token: <span class="mono">${d.token}</span></div>`);
      lines.push(`<div class="small" style="margin-top:6px">Explorer: <a href="${CHAINS[d.net].addressUrl(d.token)}" target="_blank" rel="noopener">open</a></div>`);
      if (out) out.innerHTML = lines.join("");

      if (risk) {
        risk.innerHTML = "";
        if (d.score >= 75) risk.appendChild(riskBadge("ok", "Overall", "Higher signal"));
        else if (d.score >= 50) risk.appendChild(riskBadge("warn", "Overall", "Mixed signals"));
        else risk.appendChild(riskBadge("bad", "Overall", "High risk signals"));

        risk.appendChild(riskBadge(d.verified ? "ok" : "warn", "Verified", d.verified ? "Yes" : "No/Unknown"));
        risk.appendChild(riskBadge(d.isProxy ? "warn" : "ok", "Proxy", d.isProxy ? "Yes" : "No/Unknown"));
        risk.appendChild(riskBadge(d.owner ? "info" : "warn", "Owner", d.owner ? shortAddr(d.owner) : "Unknown"));
        risk.appendChild(riskBadge(d.liq?.any ? "ok" : "warn", "Liquidity", d.liq?.any ? d.liq.hint : "None"));
        if (d.hasMint) risk.appendChild(riskBadge("bad", "Mint", "Detected"));
        if (d.hasPause) risk.appendChild(riskBadge("warn", "Pause", "Detected"));
        if (d.hasBlacklist) risk.appendChild(riskBadge("warn", "Blacklist", "Detected"));
        if (d.hasTax) risk.appendChild(riskBadge("warn", "Tax", "Detected"));
      }

      if (pairsWrap) {
        const html = `
          <div class="table">
            <div class="trow head">
  <div class="cell" data-i18n="th_pairpool">Pair/Pool</div>
  <div class="cell" data-i18n="th_type">Type</div>
  <div class="cell hide-sm" data-i18n="th_target">Target</div>
  <div class="cell" data-i18n="th_result">Result</div>
</div>
            ${(d.liq?.rows || []).map(r => `
              <div class="trow">
                <div class="cell wrap"><span class="mono">${r.addr ? shortAddr(r.addr) : "‚Äî"}</span></div>
                <div class="cell">${r.type}</div>
                <div class="cell hide-sm">${r.target}</div>
                <div class="cell">${r.ok ? "‚úÖ" : "‚Äî"} ${r.note || ""}</div>
              </div>
            `).join("")}
          </div>
        `;
        pairsWrap.innerHTML = html;
        try { applyI18n(currentLang); } catch {}
      }

      $("#qs-copy-link")?.addEventListener("click", async () => {
        const link = qsBuildShareLink(d.net, d.token);
        const ok = await copyText(link);
        setStatus($("#qs-status"), ok ? "ok" : "warn", ok ? "Copied share link." : "Copy failed.");
      }, { once: true });

      $("#qs-copy-json")?.addEventListener("click", async () => {
        const enable = !!$("#qs-show-json")?.checked;
        if (!enable) { setStatus($("#qs-status"), "warn", "JSON report disabled (toggle in options)."); return; }
        const ok = await copyText(safeJson(d));
        setStatus($("#qs-status"), ok ? "ok" : "warn", ok ? "Copied JSON." : "Copy failed.");
      }, { once: true });

      $("#qs-copy-md")?.addEventListener("click", async () => {
        const md = qsBuildMarkdown({
          net: d.net,
          token: d.token,
          score: d.score,
          verified: d.verified,
          isProxy: d.isProxy,
          impl: d.impl,
          owner: d.owner,
          liqHint: d.liq?.hint || "‚Äî",
          flags: buildFlags(d),
          tokenShort: d.tokenShort,
          title: `CycleX Quick Scan ‚Äî ${d.symbol || "TOKEN"}`
        });
        const ok = await copyText(md);
        setStatus($("#qs-status"), ok ? "ok" : "warn", ok ? "Copied Markdown." : "Copy failed.");
      }, { once: true });

      $("#qs-share-x")?.addEventListener("click", () => {
        const summary = buildSummary(d);
        const text = qsBuildXText(summary);
        const u = new URL("https://twitter.com/intent/tweet");
        u.searchParams.set("text", text);
        u.searchParams.set("url", qsBuildShareLink(d.net, d.token));
        window.open(u.toString(), "_blank", "noopener");
      }, { once: true });

      $("#qs-copy-xtext")?.addEventListener("click", async () => {
        const summary = buildSummary(d);
        const ok = await copyText(qsBuildXText(summary));
        setStatus($("#qs-status"), ok ? "ok" : "warn", ok ? "Copied X text." : "Copy failed.");
      }, { once: true });

      $("#qs-share-tg")?.addEventListener("click", () => {
        const link = qsBuildShareLink(d.net, d.token);
        const summary = buildSummary(d);
        const text = qsBuildXText(summary);
        const u = new URL("https://t.me/share/url");
        u.searchParams.set("url", link);
        u.searchParams.set("text", text);
        window.open(u.toString(), "_blank", "noopener");
      }, { once: true });

      const b1 = $("#qs-copy-link");
      if (b1) b1.disabled = false;
      const b2 = $("#qs-copy-json");
      if (b2) b2.disabled = false;
      const b3 = $("#qs-copy-md");
      if (b3) b3.disabled = false;
    }

    function buildFlags(d) {
      const f = [];
      if (d.verified) f.push("Verified");
      if (d.isProxy) f.push("Proxy");
      if (d.hasMint) f.push("Mint");
      if (d.hasPause) f.push("Pause");
      if (d.hasBlacklist) f.push("Blacklist");
      if (d.hasTax) f.push("Tax");
      if (d.liq?.any) f.push("Liquidity");
      return f.length ? f : ["No strong flags"];
    }

    function buildSummary(d) {
      return {
        title: `CycleX Quick Scan ‚Äî ${d.symbol || "TOKEN"}`,
        score: d.score,
        net: d.net,
        tokenShort: d.tokenShort,
        flags: buildFlags(d)
      };
    }
  }
// ===== QuickScan: human number formatting for reserves/liquidity =====
const CX_ERC20_META_ABI = [
  "function decimals() view returns (uint8)",
  "function symbol() view returns (string)",
  "function balanceOf(address) view returns (uint256)"
];

const _cxErc20MetaCache = new Map();

function cxToBI(x){
  try { return (typeof x === "bigint") ? x : BigInt(x); } catch { return 0n; }
}

async function cxGetErc20Meta(addr, provider){
  const key = String(addr || "").toLowerCase();
  if (_cxErc20MetaCache.has(key)) return _cxErc20MetaCache.get(key);

  const c = new E.Contract(addr, CX_ERC20_META_ABI, provider);
  let decimals = 18;
  let symbol = shortAddr(addr);

  try { decimals = Number(await c.decimals()); } catch {}
  try {
    const s = await c.symbol();
    if (s && String(s).trim()) symbol = String(s).trim();
  } catch {}

  const meta = { decimals, symbol };
  _cxErc20MetaCache.set(key, meta);
  return meta;
}

function cxCompactDecimalString(str, dp = 2){
  if (str == null) return "0";
  let s = String(str).trim();
  if (!s) return "0";

  let neg = false;
  if (s[0] === "-") { neg = true; s = s.slice(1); }

  const parts = s.split(".");
  let intp = (parts[0] || "0").replace(/^0+(?=\d)/, "");
  const frac = parts[1] || "";

  // Decide suffix by integer length
  const len = intp.length;
  let pow = 0, suf = "";
  if (len >= 16) { pow = 15; suf = "Q"; }
  else if (len >= 13) { pow = 12; suf = "T"; }
  else if (len >= 10) { pow = 9;  suf = "B"; }
  else if (len >= 7)  { pow = 6;  suf = "M"; }
  else if (len >= 4)  { pow = 3;  suf = "K"; }

  // No suffix: show up to 6 decimals trimmed
  if (pow === 0){
    const frac6 = frac.slice(0, 6).replace(/0+$/,"");
    const out = frac6 ? `${intp}.${frac6}` : intp;
    return (neg ? "-" : "") + out;
  }

  // With suffix: build X.YY + suf from digits (string-safe)
  const wholeLen = len - pow;
  const whole = intp.slice(0, wholeLen) || "0";
  const rest = intp.slice(wholeLen);

  const dec = (rest + "0".repeat(dp)).slice(0, dp).replace(/0+$/,"");
  const out = dec ? `${whole}.${dec}${suf}` : `${whole}${suf}`;
  return (neg ? "-" : "") + out;
}

function cxFmtUnits(amount, decimals, dp = 2){
  try {
    const s = E.formatUnits(amount, decimals);
    return cxCompactDecimalString(s, dp);
  } catch {
    return "0";
  }
}

function cxFmtBigInt(amount, dp = 2){
  const bi = cxToBI(amount);
  return cxCompactDecimalString(bi.toString(), dp);
}

  async function liqCheckBasic(net, token, provider) {
  const chain = CHAINS[net];
  const dex = DEX[net];
  const rows = [];
  let any = false;

  const ZERO = "0x0000000000000000000000000000000000000000";

  // Preload token/targets meta (best effort)
  let metaToken = { decimals: 18, symbol: "TOKEN" };
  try { metaToken = await cxGetErc20Meta(token, provider); } catch {}

  // ---------- V2: show RESERVES in human units + symbols ----------
  try {
    const fac = new E.Contract(dex.v2Factory, V2_FACTORY_ABI, provider);
    const targets = [
      { label: "Wrapped", addr: chain.wrapped },
      { label: "USDT", addr: chain.usdt }
    ];

    for (const t of targets) {
      const pair = await fac.getPair(token, t.addr);

      if (pair && pair !== ZERO) {
        const p = new E.Contract(pair, V2_PAIR_ABI, provider);

        // Try to detect token0/token1 order (optional, depends on ABI)
        let token0 = token, token1 = t.addr;
        try { token0 = await p.token0(); } catch {}
        try { token1 = await p.token1(); } catch {}

        const [r0Raw, r1Raw] = await p.getReserves();
        const r0 = cxToBI(r0Raw), r1 = cxToBI(r1Raw);

        const m0 = await cxGetErc20Meta(token0, provider).catch(() => ({ decimals: 18, symbol: shortAddr(token0) }));
        const m1 = await cxGetErc20Meta(token1, provider).catch(() => ({ decimals: 18, symbol: shortAddr(token1) }));

        const ok = (r0 > 0n || r1 > 0n);
        any = any || ok;

        const a0 = cxFmtUnits(r0, m0.decimals, 2);
        const a1 = cxFmtUnits(r1, m1.decimals, 2);

        rows.push({
          type: "V2",
          target: t.label,
          addr: pair,
          ok,
          note: ok
            ? `reserves: ${a0} ${m0.symbol} / ${a1} ${m1.symbol}`
            : "empty"
        });
      } else {
        rows.push({ type: "V2", target: t.label, addr: "", ok: false, note: "no pair" });
      }
    }
  } catch {
    rows.push({ type: "V2", target: "Wrapped/USDT", addr: "", ok: false, note: "factory call failed" });
  }

  // ---------- V3: show POOL BALANCES (human) + also show L units (small) ----------
  try {
    const fac3 = new E.Contract(dex.v3Factory, V3_FACTORY_ABI, provider);
    const feeTiers = [500, 3000, 10000];
    const targets = [
      { label: "Wrapped", addr: chain.wrapped },
      { label: "USDT", addr: chain.usdt }
    ];

    for (const t of targets) {
      for (const fee of feeTiers) {
        const pool = await fac3.getPool(token, t.addr, fee);

        if (pool && pool !== ZERO) {
          const p = new E.Contract(pool, V3_POOL_ABI, provider);

          let token0 = token, token1 = t.addr;
          try { token0 = await p.token0(); } catch {}
          try { token1 = await p.token1(); } catch {}

          const m0 = await cxGetErc20Meta(token0, provider).catch(() => ({ decimals: 18, symbol: shortAddr(token0) }));
          const m1 = await cxGetErc20Meta(token1, provider).catch(() => ({ decimals: 18, symbol: shortAddr(token1) }));

          // Actual balances inside the pool (much more ‚Äúhuman‚Äù than liquidity units)
          const c0 = new E.Contract(token0, CX_ERC20_META_ABI, provider);
          const c1 = new E.Contract(token1, CX_ERC20_META_ABI, provider);

          let b0 = 0n, b1 = 0n;
          try { b0 = cxToBI(await c0.balanceOf(pool)); } catch {}
          try { b1 = cxToBI(await c1.balanceOf(pool)); } catch {}

          let liq = 0n;
          try { liq = cxToBI(await p.liquidity()); } catch {}

          const ok = (b0 > 0n || b1 > 0n || liq > 0n);
          any = any || ok;

          const fb0 = cxFmtUnits(b0, m0.decimals, 2);
          const fb1 = cxFmtUnits(b1, m1.decimals, 2);

          rows.push({
            type: `V3 ${fee}`,
            target: t.label,
            addr: pool,
            ok,
            note: ok
  ? `balances: ${fb0} ${m0.symbol} / ${fb1} ${m1.symbol} ¬∑ V3 active`
  : "0"

          });
        }
      }
    }
  } catch {
    rows.push({ type: "V3", target: "Wrapped/USDT", addr: "", ok: false, note: "factory call failed" });
  }

  const hint = any ? "V2/V3 pairs exist" : "none";
  return { any, hint, rows };
}

  // =========================
  // Token + Liquidity Panel (detailed)
  // =========================
  async function runLiqScan({ auto = false } = {}) {
    const st = $("#liq-status");
    const out = $("#liq-out");
    const risk = $("#liq-risk");
    const wrap = $("#liq-tablewrap");

    clearStatus(st);
    if (risk) risk.innerHTML = "";
    if (wrap) wrap.innerHTML = "";

    const net = netFromSelect("#liq-net");
    const tokenRaw = ($("#liq-token")?.value || "").trim();
    if (!E.isAddress(tokenRaw)) { setStatus(st, "warn", "Invalid token address."); return; }
    const token = E.getAddress(tokenRaw);

        let provider = null;
    try { provider = await cxGetProvider(net); } catch {}
    if (!provider) { setStatus(st, "bad", t(currentLang, "err_no_working_rpc") || "No working RPC found. Set a working endpoint in RPC tool."); return; }

    const dn = $("#liq-dex-note");
    if (dn) dn.textContent = `${DEX[net].label} V2+V3 factories ‚Ä¢ targets: Wrapped + USDT`;

    setStatus(st, "info", "Scanning liquidity‚Ä¶");

    try {
      const liq = await liqCheckBasic(net, token, provider);

      if (out) {
        out.innerHTML = `<b>${shortAddr(token)}</b><div class="small" style="margin-top:6px">${net.toUpperCase()} ‚Ä¢ ${liq.any ? "‚úÖ liquidity found" : "‚Äî no liquidity found"}</div>`;
      }

      if (risk) {
        risk.appendChild(riskBadge(liq.any ? "ok" : "warn", "Liquidity", liq.any ? "Detected" : "Not detected"));
        risk.appendChild(riskBadge("info", "Targets", "Wrapped + USDT (V2/V3)"));
      }

      if (wrap) {
        wrap.innerHTML = `
          <div class="table">
            <div class="trow head">
  <div class="cell" data-i18n="th_pairpool">Pair/Pool</div>
  <div class="cell" data-i18n="th_type">Type</div>
  <div class="cell hide-sm" data-i18n="th_target">Target</div>
  <div class="cell" data-i18n="th_result">Result</div>
</div>

            ${liq.rows.map(r => `
              <div class="trow">
                <div class="cell wrap">${r.addr ? `<a class="mono" href="${CHAINS[net].addressUrl(r.addr)}" target="_blank" rel="noopener">${r.addr}</a>` : `<span class="muted">‚Äî</span>`}</div>
                <div class="cell">${r.type}</div>
                <div class="cell hide-sm">${r.target}</div>
                <div class="cell">${r.ok ? "‚úÖ" : "‚Äî"} ${r.note || ""}</div>
              </div>
            `).join("")}
          </div>
        `;
      }

      $("#liq-copy-link")?.addEventListener("click", async () => {
        const u = new URL(location.href);
        u.searchParams.set("tool", "liq");
        u.searchParams.set("net", net);
        u.searchParams.set("token", token);
        const ok = await copyText(u.toString());
        setStatus(st, ok ? "ok" : "warn", ok ? "Copied share link." : "Copy failed.");
      }, { once: true });

      $("#liq-share-x")?.addEventListener("click", () => {
        const u = new URL("https://twitter.com/intent/tweet");
        u.searchParams.set("text", `Liquidity scan (${net.toUpperCase()}): ${shortAddr(token)} ‚Ä¢ ${liq.any ? "liquidity found" : "no liquidity found"} ‚Äî CycleX Security Hub`);
        const link = new URL(location.href);
        link.searchParams.set("tool", "liq");
        link.searchParams.set("net", net);
        link.searchParams.set("token", token);
        u.searchParams.set("url", link.toString());
        window.open(u.toString(), "_blank", "noopener");
      }, { once: true });

      setStatus(st, "ok", "Done.");
      gtagEvent("sec_liq_scan", { net, any: liq.any ? 1 : 0 });

    } catch (e) {
      setStatus(st, "bad", `Liquidity scan failed: ${String(e?.message || e)}`);
    }
  }

  // =========================
  // Approval Guardian
  // =========================
  function presetSpender(net, preset) {
    if (preset === "pcs_router") return DEX.bsc.routerV2;
    if (preset === "uni_router") return DEX.eth.routerV2;
    return "";
  }

  function parseTokenLines(text) {
    const lines = String(text || "").split("\n").map(x => x.trim()).filter(Boolean);
    const out = [];
    for (const l of lines) if (E.isAddress(l)) out.push(E.getAddress(l));
    return uniq(out);
  }

  async function apCheckAllowances() {
    const st = $("#ap-status");
    clearStatus(st);

    const net = netFromSelect("#ap-net");
    const spenderPreset = ($("#ap-spender-preset")?.value || "");
    const spenderCustom = ($("#ap-spender")?.value || "").trim();
    const spender = E.isAddress(spenderCustom) ? E.getAddress(spenderCustom) : (presetSpender(net, spenderPreset) || "");
    if (!spender || !E.isAddress(spender)) {
      setStatus(st, "warn", "Invalid spender. Pick a preset or paste a valid address.");
      return;
    }
    const spEl = $("#ap-spender");
    if (spEl) spEl.value = spender;

    if (!wallet.address || !wallet.signer || !wallet.browserProvider) {
      setStatus(st, "warn", "Connect a wallet first (Safe mode is on).");
      return;
    }

    const targetChainId = CHAINS[net].chainId;
    if (wallet.chainId && wallet.chainId !== targetChainId) {
      const ok = await ensureChain(targetChainId);
      if (!ok) { setStatus(st, "warn", `Please switch network to ${CHAINS[net].name} in your wallet.`); return; }
    }

    const tokens = parseTokenLines($("#ap-tokens")?.value || "");
    if (!tokens.length) { setStatus(st, "warn", "Paste token addresses (one per line)."); return; }

    setStatus(st, "info", "Reading allowances‚Ä¶");

    const table = $("#ap-table");
    if (table) {
      table.innerHTML = `
        <div class="trow head">
          <div class="cell" data-i18n="th_token">Token</div>
          <div class="cell" data-i18n="th_allowance">Allowance</div>
          <div class="cell hide-sm" data-i18n="th_symbol">Symbol</div>
          <div class="cell" data-i18n="th_action">Action</div>
        </div>
      `;
    }

    try {
      const rp = getReadProvider(net);
      if (!rp) { setStatus(st, "bad", "No RPC for reads. Set best RPC first."); return; }

      const ownerAddr = wallet.address;
      let nonZero = 0;

      for (const tAddr of tokens) {
        const cRead = new E.Contract(tAddr, ERC20_ABI, rp);
        let sym = "?", dec = 18;
        try { sym = await cRead.symbol(); } catch {}
        try { dec = await cRead.decimals(); } catch {}

        let allowance = 0n;
        try { allowance = BigInt(await cRead.allowance(ownerAddr, spender)); } catch { allowance = 0n; }

        const isZero = allowance === 0n;
        if (!isZero) nonZero++;

        const human = allowance.toString();
        const inf = (allowance > (2n ** 255n));

        const row = document.createElement("div");
        row.className = "trow";
        row.innerHTML = `
          <div class="cell wrap"><a href="${CHAINS[net].addressUrl(tAddr)}" target="_blank" rel="noopener" class="mono">${shortAddr(tAddr)}</a></div>
          <div class="cell">${inf ? "‚àû" : `<span class="mono">${human}</span>`}</div>
          <div class="cell hide-sm">${sym}</div>
          <div class="cell">
            <button class="btn btn-ghost" style="padding:10px 14px; font-size:12px;" ${isZero ? "disabled" : ""}>Revoke</button>
          </div>
        `;
        const btn = row.querySelector("button");
        btn?.addEventListener("click", async () => { await apRevokeOne(net, tAddr, spender); });

        table?.appendChild(row);
      }

      setStatus(st, "ok", `Done. Non-zero allowances: <b>${nonZero}</b>`);
      gtagEvent("sec_allowances_checked", { net, count: tokens.length });

    } catch (e) {
      setStatus(st, "bad", `Allowance read failed: ${String(e?.message || e)}`);
    }
  }

  async function apRevokeOne(net, token, spender) {
    const st = $("#ap-status");
    try {
      if (!wallet.signer) { setStatus(st, "warn", "Connect wallet first."); return; }

      const targetChainId = CHAINS[net].chainId;
      if (wallet.chainId && wallet.chainId !== targetChainId) {
        const ok = await ensureChain(targetChainId);
        if (!ok) { setStatus(st, "warn", `Switch wallet to ${CHAINS[net].name}.`); return; }
      }

      setStatus(st, "info", `Revoking‚Ä¶ ${shortAddr(token)}`);

      const c = new E.Contract(token, ERC20_ABI, wallet.signer);
      const tx = await c.approve(spender, 0);
      setStatus(st, "info", `Sent tx: <a href="${CHAINS[net].txUrl(tx.hash)}" target="_blank" rel="noopener">${tx.hash.slice(0, 10)}‚Ä¶</a>`);
      await tx.wait();

      setStatus(st, "ok", "Revoke confirmed ‚úÖ");
      gtagEvent("sec_allowance_revoked", { net });

      await apCheckAllowances();
    } catch (e) {
      setStatus(st, "bad", `Revoke failed: ${String(e?.message || e)}`);
    }
  }

  async function apRevokeAll() {
    const st = $("#ap-status");
    const net = netFromSelect("#ap-net");
    const spender = ($("#ap-spender")?.value || "").trim();
    if (!E.isAddress(spender)) { setStatus(st, "warn", "Invalid spender."); return; }

    if (!wallet.address || !wallet.signer) { setStatus(st, "warn", "Connect a wallet first."); return; }

    const tokens = parseTokenLines($("#ap-tokens")?.value || "");
    if (!tokens.length) { setStatus(st, "warn", "Paste token addresses (one per line)."); return; }

    setStatus(st, "info", "Revoking all non-zero allowances‚Ä¶");

    const rp = getReadProvider(net);
    if (!rp) { setStatus(st, "bad", "No RPC for reads. Set best RPC first."); return; }

    let did = 0;
    for (const tAddr of tokens) {
      try {
        const cRead = new E.Contract(tAddr, ERC20_ABI, rp);
        const allowance = BigInt(await cRead.allowance(wallet.address, spender));
        if (allowance === 0n) continue;
        await apRevokeOne(net, tAddr, spender);
        did++;
      } catch {}
    }

    setStatus(st, "ok", `Revoke-all done. Updated: ${did}`);
  }

  function initApprovalsUi() {
    $("#ap-spender-preset")?.addEventListener("change", () => {
      const net = netFromSelect("#ap-net");
      const p = ($("#ap-spender-preset")?.value || "");
      if (p === "custom") return;
      const v = presetSpender(net, p);
      const el = $("#ap-spender");
      if (v && el) el.value = v;
    });

    $("#ap-seed-common")?.addEventListener("click", () => {
      const net = netFromSelect("#ap-net");
      const chain = CHAINS[net];
      const common = uniq([chain.wrapped, chain.usdt]);
      const el = $("#ap-tokens");
      if (el) el.value = common.join("\n");
      setStatus($("#ap-status"), "ok", "Seeded common tokens (Wrapped + USDT).");
    });

    $("#ap-seed-history")?.addEventListener("click", () => {
      const net = netFromSelect("#ap-net");
      const hist = qsGetHistory(net);
      if (!hist.length) { setStatus($("#ap-status"), "warn", "No scan history yet."); return; }
      const el = $("#ap-tokens");
      if (el) el.value = hist.join("\n");
      setStatus($("#ap-status"), "ok", "Loaded tokens from scan history.");
    });

    $("#ap-check")?.addEventListener("click", apCheckAllowances);
    $("#ap-revoke-all")?.addEventListener("click", apRevokeAll);
  }

  // =========================
  // RPC Health Checker
  // =========================
  function rpcRowHtml(r) {
    const statusTxt = r.ok ? "OK" : (r.status || "FAIL");
    const msTxt = (r.ms === null || r.ms === undefined) ? "‚Äî" : String(r.ms);
    const chainTxt = r.chainOk ? "‚úÖ" : "‚Äî";
    const blockTxt = r.blockOk ? "‚úÖ" : "‚Äî";
    const callTxt = r.callOk ? "‚úÖ" : "‚Äî";
    const logsTxt = r.logsOk ? "‚úÖ" : "‚Äî";

    return `
      <div class="trow rpc ${r.highlight ? "highlight" : ""}">
        <div class="cell wrap"><span class="mono">${r.url}</span></div>
        <div class="cell">${msTxt}</div>
        <div class="cell hide-sm">${chainTxt}</div>
        <div class="cell hide-sm">${blockTxt}</div>
        <div class="cell hide-sm">${callTxt}</div>
        <div class="cell hide-sm">${logsTxt}</div>
        <div class="cell">${r.ok ? "‚úÖ" : "‚Äî"} ${statusTxt}</div>
      </div>
    `;
  }

  async function testOneRpc(url, net) {
    const chain = CHAINS[net];
    const start = performance.now();

    let chainOk = false, blockOk = false, callOk = false, logsOk = false;
    let blockNumHex = "0x0";

    try {
      const chainIdHex = await rpcRequest(url, "eth_chainId", [], 6500);
      const chainId = Number(chainIdHex);
      chainOk = (chainId === chain.chainId);

      blockNumHex = await rpcRequest(url, "eth_blockNumber", [], 6500);
      blockOk = !!blockNumHex;

      const data = "0x313ce567";
      const callRes = await rpcRequest(url, "eth_call", [{ to: chain.usdt, data }, "latest"], 6500);
      callOk = !!callRes;

      let latest = parseInt(blockNumHex, 16);
      if (!isFinite(latest) || latest <= 0) latest = 0;
      const from = Math.max(0, latest - 200);

      const logs = await rpcRequest(url, "eth_getLogs", [{
        fromBlock: "0x" + from.toString(16),
        toBlock: "0x" + latest.toString(16),
        address: chain.usdt,
        topics: [TRANSFER_TOPIC0]
      }], 8000);

      logsOk = Array.isArray(logs);

      const ms = Math.round(performance.now() - start);
      const ok = chainOk && blockOk && callOk && logsOk;
      return { url, ms, ok, chainOk, blockOk, callOk, logsOk, blockNumHex };
    } catch (e) {
      const ms = Math.round(performance.now() - start);
      return { url, ms, ok: false, chainOk, blockOk, callOk, logsOk, status: String(e?.message || e) };
    }
  }

  async function runRpcTests() {
    const st = $("#rpc-status");
    clearStatus(st);

    const net = netFromSelect("#rpc-net");
    const candidates = buildRpcCandidates(net);
    if (!candidates.length) { setStatus(st, "warn", "No RPC URLs to test."); return; }

    const table = $("#rpc-table");
    if (table) {
      table.innerHTML = `
        <div class="trow head rpc">
          <div class="cell" data-i18n="th_rpc">RPC</div>
          <div class="cell" data-i18n="th_ms">ms</div>
          <div class="cell hide-sm" data-i18n="th_chain">chain</div>
          <div class="cell hide-sm" data-i18n="th_block">block</div>
          <div class="cell hide-sm" data-i18n="th_call">call</div>
          <div class="cell hide-sm" data-i18n="th_logs">logs</div>
          <div class="cell" data-i18n="th_status">status</div>
        </div>
      `;
    }

    setStatus(st, "info", `Testing ${candidates.length} RPCs‚Ä¶`);

    const results = [];
    for (const url of candidates) {
      const r = await testOneRpc(url, net);
      results.push(r);

      // ‚úÖ no "&& assignment" here (prevents Invalid left-hand side issues)
      if (table) table.innerHTML += rpcRowHtml(r);
    }

    const good = results.filter(r => r.ok).sort((a, b) => a.ms - b.ms);
    if (good.length) {
      const best = good[0];
      setSavedBestRpc(net, best.url);

      if (table) {
        table.innerHTML = `
          <div class="trow head rpc">
            <div class="cell">RPC</div>
            <div class="cell">ms</div>
            <div class="cell hide-sm">chain</div>
            <div class="cell hide-sm">block</div>
            <div class="cell hide-sm">call</div>
            <div class="cell hide-sm">logs</div>
            <div class="cell">status</div>
          </div>
        `;
        for (const r of results) {
          r.highlight = (r.url === best.url);
          table.innerHTML += rpcRowHtml(r);
        }
      }

      setStatus(st, "ok", `Best RPC saved locally ‚úÖ <span class="mono">${best.url}</span>`);
      gtagEvent("sec_rpc_best_saved", { net });
    } else {
      setStatus(st, "warn", "No fully working RPC found (CORS/timeouts/logs). Try a different endpoint.");
    }
  }

  async function runRpcDevLogsTest() {
    const st = $("#rpc-status");
    const net = netFromSelect("#rpc-net");
    const url = ((($("#rpc-custom")?.value || "").trim()) || getSavedPrivateRpc(net) || getSavedBestRpc(net) || CHAINS[net].publicRpcs[0]);

    if (!url) { setStatus(st, "warn", "Set an RPC first."); return; }

    const addr = ($("#rpc-dev-addr")?.value || "").trim();
    const topic0 = ($("#rpc-dev-topic")?.value || "").trim();

    if (addr && !E.isAddress(addr)) { setStatus(st, "warn", "Invalid contract address."); return; }
    if (topic0 && !/^0x[0-9a-fA-F]{64}$/.test(topic0)) { setStatus(st, "warn", "Topic0 must be 32 bytes hex (0x + 64)."); return; }

    setStatus(st, "info", "Running custom logs test‚Ä¶");

    try {
      const latestHex = await rpcRequest(url, "eth_blockNumber", [], 6500);
      let latest = parseInt(latestHex, 16);
      if (!isFinite(latest) || latest <= 0) latest = 0;
      const from = Math.max(0, latest - 2000);

      const logs = await rpcRequest(url, "eth_getLogs", [{
        fromBlock: "0x" + from.toString(16),
        toBlock: "0x" + latest.toString(16),
        ...(addr ? { address: E.getAddress(addr) } : {}),
        ...(topic0 ? { topics: [topic0] } : {})
      }], 9000);

      setStatus(st, "ok", `Custom logs OK ‚úÖ returned <b>${Array.isArray(logs) ? logs.length : 0}</b> logs`);
      gtagEvent("sec_rpc_dev_logs_ok", { net });

    } catch (e) {
      setStatus(st, "bad", `Custom logs failed: ${String(e?.message || e)}`);
    }
  }

  function initRpcUi() {
    $("#rpc-test")?.addEventListener("click", runRpcTests);
    $("#rpc-dev-run")?.addEventListener("click", runRpcDevLogsTest);

    $("#rpc-copy-best")?.addEventListener("click", async () => {
      const net = netFromSelect("#rpc-net");
      const best = getSavedBestRpc(net);
      if (!best) { setStatus($("#rpc-status"), "warn", "No saved best RPC yet. Run tests first."); return; }
      const ok = await copyText(best);
      setStatus($("#rpc-status"), ok ? "ok" : "warn", ok ? "Copied best RPC." : "Copy failed.");
    });

    $("#rpc-share-x")?.addEventListener("click", () => {
      const net = netFromSelect("#rpc-net");
      const best = getSavedBestRpc(net);
      const u = new URL("https://twitter.com/intent/tweet");
      u.searchParams.set("text", `RPC Health (${net.toUpperCase()}): best endpoint found ‚úÖ ${best ? best : "(none yet)"} ‚Äî CycleX Security Hub`);
      window.open(u.toString(), "_blank", "noopener");
    });

    $("#rpc-private-save")?.addEventListener("click", () => {
      const net = netFromSelect("#rpc-net");
      const v = ($("#rpc-private")?.value || "").trim();
      if (v && !/^https?:\/\//i.test(v)) { setStatus($("#rpc-status"), "warn", "RPC must start with https://"); return; }
      setSavedPrivateRpc(net, v);
      setStatus($("#rpc-status"), "ok", "Saved private RPC locally.");
    });

    $("#rpc-private-clear")?.addEventListener("click", () => {
      const net = netFromSelect("#rpc-net");
      setSavedPrivateRpc(net, "");
      const el = $("#rpc-private");
      if (el) el.value = "";
      setStatus($("#rpc-status"), "ok", "Cleared private RPC.");
    });

    $("#rpc-net")?.addEventListener("change", () => {
      const net = netFromSelect("#rpc-net");
      const v = getSavedPrivateRpc(net);
      const el = $("#rpc-private");
      if (el) el.value = v;
    });

    // init private input on load
    const net = netFromSelect("#rpc-net");
    const v = getSavedPrivateRpc(net);
    const el = $("#rpc-private");
    if (el) el.value = v;
  }

  // =========================
  // Tx Decoder
  // =========================
  function decodeErc20Input(data) {
    if (!data || data.length < 10) return null;
    const sig = data.slice(0, 10).toLowerCase();

    if (sig === "0xa9059cbb" && data.length >= 10 + 64 + 64) {
      const to = "0x" + data.slice(10 + 24, 10 + 64);
      const val = BigInt("0x" + data.slice(10 + 64, 10 + 64 + 64));
      return { type: "ERC20.transfer", to: E.isAddress(to) ? E.getAddress(to) : to, value: val.toString() };
    }
    if (sig === "0x095ea7b3" && data.length >= 10 + 64 + 64) {
      const sp = "0x" + data.slice(10 + 24, 10 + 64);
      const val = BigInt("0x" + data.slice(10 + 64, 10 + 64 + 64));
      return { type: "ERC20.approve", spender: E.isAddress(sp) ? E.getAddress(sp) : sp, value: val.toString() };
    }
    return { type: "Unknown", selector: sig, bytes: data.length };
  }

  async function runTxDecode({ auto = false } = {}) {
    const st = $("#tx-status");
    const out = $("#tx-out");
    const eventsEl = $("#tx-events");

    clearStatus(st);
    if (eventsEl) eventsEl.innerHTML = "";

    const net = netFromSelect("#tx-net");
    const hash = ($("#tx-hash")?.value || "").trim();
    if (!/^0x[0-9a-fA-F]{64}$/.test(hash)) { setStatus(st, "warn", "Invalid tx hash."); return; }

    const best = getSavedBestRpc(net);
    const providerUrl = ((($("#rpc-custom")?.value || "").trim()) || getSavedPrivateRpc(net) || best || CHAINS[net].publicRpcs[0]);
    if (!providerUrl) { setStatus(st, "bad", "No RPC available. Run RPC tests first."); return; }

    setStatus(st, "info", "Fetching tx + receipt‚Ä¶");

    try {
      const tx = await rpcRequest(providerUrl, "eth_getTransactionByHash", [hash], 9000);
      const rc = await rpcRequest(providerUrl, "eth_getTransactionReceipt", [hash], 9000);

      if (!tx) { setStatus(st, "warn", "Transaction not found."); return; }

      const decoded = decodeErc20Input(tx.input || "");
      const from = tx.from ? E.getAddress(tx.from) : "";
      const to = tx.to ? E.getAddress(tx.to) : "";
      const status = rc?.status === "0x1" ? "‚úÖ success" : (rc?.status === "0x0" ? "‚ùå failed" : "‚Äî");
      const block = rc?.blockNumber ? parseInt(rc.blockNumber, 16) : null;

      if (out) {
        out.innerHTML = `
          <b>Tx</b>: <a href="${CHAINS[net].txUrl(hash)}" target="_blank" rel="noopener" class="mono">${hash}</a><br>
          <span class="small">Status: <b>${status}</b>${block ? ` ‚Ä¢ Block: <b>${block}</b>` : ""}</span><br><br>
          <div class="small">From: <span class="mono">${from}</span></div>
          <div class="small">To: <span class="mono">${to || "‚Äî"}</span></div>
          <div class="small" style="margin-top:10px"><b>Input</b>: <span class="mono">${decoded?.type || "‚Äî"}</span></div>
          <div class="small" style="margin-top:6px"><span class="mono">${safeJson(decoded)}</span></div>
        `;
      }

      const iface = new E.Interface([
        "event Transfer(address indexed from, address indexed to, uint256 value)",
        "event Approval(address indexed owner, address indexed spender, uint256 value)"
      ]);

      const logs = Array.isArray(rc?.logs) ? rc.logs : [];
      const rendered = [];

      for (const lg of logs) {
        try {
          const topic0 = (lg.topics && lg.topics[0]) ? String(lg.topics[0]).toLowerCase() : "";
          if (topic0 !== TRANSFER_TOPIC0 && topic0 !== APPROVAL_TOPIC0) continue;

          const parsed = iface.parseLog({ topics: lg.topics, data: lg.data });
          rendered.push({
            address: lg.address ? E.getAddress(lg.address) : "",
            name: parsed?.name || "",
            args: parsed?.args
              ? Array.from(parsed.args).map(x => (typeof x === "bigint" ? x.toString() : String(x)))
              : []
          });
        } catch {}
      }

      if (eventsEl) {
        if (!rendered.length) {
          eventsEl.innerHTML = `<div class="small muted">No standard Transfer/Approval events decoded.</div>`;
        } else {
          eventsEl.innerHTML = rendered.map(ev => `
            <div class="status info" style="display:block; margin-top:10px;">
              <b>${ev.name}</b><br>
              <span class="small">Contract: <a href="${CHAINS[net].addressUrl(ev.address)}" target="_blank" rel="noopener" class="mono">${ev.address}</a></span><br>
              <span class="mono">${safeJson(ev.args)}</span>
            </div>
          `).join("");
        }
      }

      $("#tx-copy-md")?.addEventListener("click", async () => {
        const md = [
          `## Tx Decode (CycleX Security Hub)`,
          ``,
          `- Network: ${net.toUpperCase()}`,
          `- Tx: \`${hash}\``,
          `- Explorer: ${CHAINS[net].txUrl(hash)}`,
          `- Status: ${status}`,
          ``,
          `### Decoded Input`,
          "```json",
          safeJson(decoded),
          "```",
          ``,
          `### Decoded Events (Transfer/Approval)`,
          "```json",
          safeJson(rendered),
          "```"
        ].join("\n");
        const ok = await copyText(md);
        setStatus(st, ok ? "ok" : "warn", ok ? "Copied Markdown." : "Copy failed.");
      }, { once: true });

      setStatus(st, "ok", "Done.");
      gtagEvent("sec_tx_decode", { net });

    } catch (e) {
      setStatus(st, "bad", `Tx decode failed: ${String(e?.message || e)}`);
    }
  }

  function initTxUi() {
    $("#tx-run")?.addEventListener("click", runTxDecode);
  }

  // =========================
  // Dev Tools: Bookmarklet + Monitor
  // =========================
  function buildBookmarklet(baseUrl) {
    const js = `
(function(){
  try{
    var u=location.href;
    var base="${baseUrl.replace(/"/g, '\\"')}";
    var net = (u.includes("bscscan.com") ? "bsc" : "eth");
    var m1 = u.match(/\\/address\\/(0x[a-fA-F0-9]{40})/);
    var m2 = u.match(/\\/token\\/(0x[a-fA-F0-9]{40})/);
    var m3 = u.match(/\\/tx\\/(0x[a-fA-F0-9]{64})/);
    var to="";
    if(m3){
      to = base + "?tool=tx&net=" + net + "&tx=" + m3[1];
    } else {
      var a = (m2 && m2[1]) || (m1 && m1[1]) || "";
      if(!a){ alert("No token address detected"); return; }
      to = base + "?tool=quick&net=" + net + "&token=" + a;
    }
    window.open(to, "_blank");
  }catch(e){ alert("Bookmarklet error: " + e); }
})();`.trim();
    return "javascript:" + encodeURIComponent(js);
  }

  function initDevUi() {
    $("#bm-generate")?.addEventListener("click", () => {
      const base = ($("#bm-base")?.value || location.origin + location.pathname).trim();
      const bm = buildBookmarklet(base);
      setStatus($("#bm-out"), "ok", `Generated. Copy it using the button below.`);
      const out = $("#bm-out");
      if (out) out.dataset.bm = bm;
    });

    $("#bm-copy")?.addEventListener("click", async () => {
      const bm = $("#bm-out")?.dataset?.bm || "";
      if (!bm) { setStatus($("#bm-out"), "warn", "Generate first."); return; }
      const ok = await copyText(decodeURIComponent(bm.replace(/^javascript:/, "javascript:")));
      setStatus($("#bm-out"), ok ? "ok" : "warn", ok ? "Copied bookmarklet code." : "Copy failed.");
    });

    const baseEl = $("#bm-base");
    if (baseEl) baseEl.value = location.origin + location.pathname;

    monRender();
    $("#mon-add")?.addEventListener("click", monAdd);
    $("#mon-check")?.addEventListener("click", monCheckAll);
    $("#mon-export")?.addEventListener("click", async () => {
      const list = monLoad();
      const ok = await copyText(safeJson(list));
      setStatus($("#mon-status"), ok ? "ok" : "warn", ok ? "Copied JSON." : "Copy failed.");
    });
  }

  // Monitor
  const LS_MON = "cx_sec_mon_v1";

  function monLoad() {
    try { return JSON.parse(localStorage.getItem(LS_MON) || "[]"); } catch { return []; }
  }
  function monSave(list) {
    try { localStorage.setItem(LS_MON, JSON.stringify(list)); } catch {}
  }

  function monRender() {
  const table = $("#mon-table");
  if (!table) return;

  const list = monLoad();

  table.innerHTML = `
    <div class="trow head">
      <div class="cell" data-i18n="th_contract">Contract</div>
      <div class="cell" data-i18n="th_network">Network</div>
      <div class="cell hide-sm" data-i18n="th_last_seen">Last seen</div>
      <div class="cell" data-i18n="th_status">Status</div>
    </div>
  `;

  for (const it of list) {
    const row = document.createElement("div");
    row.className = "trow";

    const url = CHAINS?.[it.net]?.addressUrl ? CHAINS[it.net].addressUrl(it.addr) : "#";
    const statusText = it.status || "‚Äî";

    row.innerHTML = `
      <div class="cell wrap">
        <a href="${url}" target="_blank" rel="noopener" class="mono">${shortAddr(it.addr)}</a>
      </div>
      <div class="cell">${String(it.net || "").toUpperCase()}</div>
      <div class="cell hide-sm">${it.last || "‚Äî"}</div>

      <div class="cell">
        <div style="display:flex; align-items:center; justify-content:space-between; gap:10px;">
          <span>${statusText}</span>

          <button class="chip chip-danger"
                  title="Remove"
                  data-i18n-title="btn_remove"
                  data-mon-remove="1"
                  data-addr="${it.addr}"
                  data-net="${it.net}">
            ‚úï
          </button>
        </div>
      </div>
    `;

    table.appendChild(row);
  }

  // bind remove once (delegation)
  try { bindMonRemove(); } catch {}

  // translate injected DOM
  try { applyI18n(currentLang); } catch {}
}


  async function monAdd() {
    const st = $("#mon-status");
    clearStatus(st);

    const net = netFromSelect("#mon-net");
    const a = ($("#mon-addr")?.value || "").trim();
    if (!E.isAddress(a)) { setStatus(st, "warn", "Invalid contract address."); return; }
    const addr = E.getAddress(a);

    const list = monLoad();
    const next = [{ net, addr, last: "‚Äî", status: "pending" }, ...list.filter(x => !(x.net === net && x.addr.toLowerCase() === addr.toLowerCase()))].slice(0, 40);
    monSave(next);
    monRender();
    setStatus(st, "ok", "Added.");
    gtagEvent("sec_mon_add", { net });
  }

  async function monCheckAll() {
    const st = $("#mon-status");
    clearStatus(st);

    const list = monLoad();
    if (!list.length) { setStatus(st, "warn", "Watchlist empty."); return; }

    setStatus(st, "info", "Checking‚Ä¶");

    for (const it of list) {
      try {
                let provider = null;
        try { provider = await cxGetProvider(it.net); } catch {}
        if (!provider) { it.status = "no rpc"; continue; }

        const code = await provider.getCode(it.addr);
        it.status = (code && code !== "0x") ? "code ‚úÖ" : "no code";
        it.last = new Date().toLocaleString();
      } catch {
        it.status = "failed";
        it.last = new Date().toLocaleString();
      }
    }
    monSave(list);
    monRender();
    setStatus(st, "ok", "Done.");
    gtagEvent("sec_mon_check", { n: list.length });
  }

    function monRemove(addr, net) {
  const st = $("#mon-status");
  const addrLower = String(addr || "").trim().toLowerCase();
  const netNorm = String(net || "").trim().toLowerCase();

  const list = monLoad();
  const next = list.filter(it =>
    !(String(it.net || "").toLowerCase() === netNorm &&
      String(it.addr || "").toLowerCase() === addrLower)
  );

  monSave(next);
  monRender();

  setStatus(st, "ok", "Removed.");
  gtagEvent("sec_mon_remove", { net: netNorm });
}

function bindMonRemove() {
  const table = $("#mon-table");
  if (!table || table.__cxBound) return;
  table.__cxBound = true;

  table.addEventListener("click", (e) => {
    const btn = e.target.closest("[data-mon-remove]");
    if (!btn) return;

    e.preventDefault();
    const addr = btn.getAttribute("data-addr") || "";
    const net  = btn.getAttribute("data-net") || "";
    monRemove(addr, net);
  });
}
  // =========================
  // Wiring + Auto-run
  // =========================
  function initWiring() {
    $("#qs-run")?.addEventListener("click", () => runQuickScan({ auto: false }));
    $("#liq-run")?.addEventListener("click", () => runLiqScan({ auto: false }));

    renderWalletLabels();
  }
// =========================
// Deep-link + Explorer Import UX
// =========================
function cxToast(msg, kind = "ok", ms = 2200) {
  try {
    const el = document.createElement("div");
    const bg =
      kind === "warn" ? "rgba(255,193,7,0.16)" :
      kind === "bad"  ? "rgba(255,80,80,0.16)"  :
                        "rgba(0,230,118,0.14)";

    el.style.cssText = `
      position:fixed; z-index:99999;
      top:14px; left:50%; transform:translateX(-50%);
      max-width:min(720px, calc(100% - 24px));
      padding:10px 14px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,0.14);
      background:${bg};
      backdrop-filter: blur(10px);
      color: rgba(244,246,255,0.92);
      font-size: 13px;
      box-shadow: 0 14px 40px rgba(0,0,0,0.35);
      opacity:0; transition:opacity 140ms ease, transform 140ms ease;
    `;
    el.innerHTML = msg;

    document.body.appendChild(el);
    requestAnimationFrame(() => {
      el.style.opacity = "1";
      el.style.transform = "translateX(-50%) translateY(0)";
    });

    setTimeout(() => {
      el.style.opacity = "0";
      el.style.transform = "translateX(-50%) translateY(-6px)";
      setTimeout(() => el.remove(), 180);
    }, ms);
  } catch {}
}
    function cxShortHash(h) {
  const s = String(h || "");
  if (s.length < 16) return s || "‚Äî";
  return `${s.slice(0, 10)}‚Ä¶${s.slice(-6)}`;
}

function cxLooksLikeExplorerRef() {
  const ref = String(document.referrer || "").toLowerCase();
  if (!ref) return false;

  return (
    ref.includes("bscscan.com") ||
    ref.includes("etherscan.io") ||
    ref.includes("arbiscan.io") ||
    ref.includes("polygonscan.com") ||
    ref.includes("snowtrace.io") ||
    ref.includes("ftmscan.com")
  );
}

function cxHandleImportToast(q) {
  try {
    const sp = new URLSearchParams(location.search);
    const src = String(sp.get("src") || sp.get("from") || sp.get("utm_source") || "").toLowerCase();
    const srcExplorer = /(bscscan|etherscan|arbiscan|polygonscan|snowtrace|ftmscan)/.test(src);

    if (!cxLooksLikeExplorerRef() && !srcExplorer) return;

    if (q?.tool === "tx" && /^0x[a-fA-F0-9]{64}$/.test(String(q.tx || ""))) {
      cxToast(
        `${t(currentLang, "toast_imported_tx") || "Imported tx:"} <span class="mono">${cxShortHash(q.tx)}</span>`,
        "ok",
        2400
      );
      return;
    }

    if ((q?.tool === "quick" || q?.tool === "liq") && E.isAddress(String(q.token || ""))) {
      const addr = E.getAddress(String(q.token));
      cxToast(
        `${t(currentLang, "toast_imported_token") || "Imported token:"} <span class="mono">${shortAddr(addr)}</span>`,
        "ok",
        2400
      );
    }
  } catch {}
}


function cxNormalizeNet(x) {
  const v = String(x || "").trim().toLowerCase();
  if (!v) return "";
  if (v === "56" || v === "bsc" || v === "bnb" || v === "bnbchain" || v === "bnb-chain") return "bsc";
  if (v === "1"  || v === "eth" || v === "ethereum") return "eth";
  return v;
}

function cxIsTxHash(x) {
  const s = String(x || "").trim();
  return /^0x[a-fA-F0-9]{64}$/.test(s);
}

function cxIsAddress(x) {
  try {
    const E0 = (typeof E !== "undefined") ? E : (typeof ethers !== "undefined" ? ethers : null);
    if (!E0) return false;
    return E0.isAddress(String(x || "").trim());
  } catch { return false; }
}

function cxDetectSource() {
  // prefer explicit param, but also try referrer host
  const sp = new URLSearchParams(location.search);
  const src = sp.get("src") || sp.get("from") || sp.get("utm_source");
  if (src) return src;

  try {
    const ref = document.referrer || "";
    if (!ref) return "";
    const host = new URL(ref).hostname.toLowerCase();
    if (host.includes("bscscan")) return "BscScan";
    if (host.includes("etherscan")) return "Etherscan";
    if (host.includes("arbiscan")) return "Arbiscan";
    if (host.includes("polygonscan")) return "PolygonScan";
    return host.replace(/^www\./, "");
  } catch {
    return "";
  }
}

function cxOpenTool(tool) {
  // use existing tile click wiring (safe)
  const card = document.querySelector(`.tool-card[data-tool="${tool}"]`);
  if (card) {
    card.dispatchEvent(new MouseEvent("click", { bubbles: true }));
  } else {
    // fallback: show panel directly if exists
    const p = document.querySelector(`#panel-${tool}`);
    if (p) p.classList.remove("hidden");
  }

  // scroll to panel
  const panel = document.querySelector(`#panel-${tool}`);
  if (panel) {
    setTimeout(() => panel.scrollIntoView({ behavior: "smooth", block: "start" }), 60);
  }
}

function cxSetStatusById(id, kind, msg) {
  const el = document.querySelector(id);
  if (!el) return;
  if (typeof setStatus === "function") {
    setStatus(el, kind, msg);
  } else {
    // fallback
    el.className = `status ${kind}`;
    el.textContent = msg;
  }
}

function cxAutoRunFromQuery() {
  if (window.__cxDeepLinkRan) return;
  window.__cxDeepLinkRan = true;

  const sp = new URLSearchParams(location.search);

  // detect tool
  let tool = (sp.get("tool") || "").trim().toLowerCase();
  const net = cxNormalizeNet(sp.get("net") || sp.get("chain") || "");
  const token = (sp.get("token") || sp.get("addr") || sp.get("contract") || "").trim();
  const tx = (sp.get("tx") || sp.get("hash") || "").trim();

  if (!tool) {
    if (tx) tool = "tx";
    else if (token) tool = "quick";
  }

  const supported = new Set(["quick", "liq", "approvals", "rpc", "tx", "dev"]);
  if (!supported.has(tool)) return;

  const src = cxDetectSource();
  const imported = Boolean(token || tx);
  if (imported) {
    cxToast(`Imported from <b>${src || "explorer"}</b> ‚úÖ`, "ok", 2400);
  }

  cxOpenTool(tool);

  // Run after UI is visible
  setTimeout(() => {
    // QUICK
    if (tool === "quick") {
      if (net && document.querySelector("#qs-net")) document.querySelector("#qs-net").value = net;
      if (token && document.querySelector("#qs-token")) document.querySelector("#qs-token").value = token;

      if (token && !cxIsAddress(token)) {
        cxSetStatusById("#qs-status", "warn", "Invalid token address in link.");
        cxToast("Invalid token address in link.", "warn", 2600);
        return;
      }

      // auto-run only if token exists
      if (token) document.querySelector("#qs-run")?.click();
      return;
    }

    // LIQ
    if (tool === "liq") {
      if (net && document.querySelector("#liq-net")) document.querySelector("#liq-net").value = net;
      if (token && document.querySelector("#liq-token")) document.querySelector("#liq-token").value = token;

      if (token && !cxIsAddress(token)) {
        cxSetStatusById("#liq-status", "warn", "Invalid token address in link.");
        cxToast("Invalid token address in link.", "warn", 2600);
        return;
      }

      if (token) document.querySelector("#liq-run")?.click();
      return;
    }

    // TX
    if (tool === "tx") {
      if (net && document.querySelector("#tx-net")) document.querySelector("#tx-net").value = net;
      if (tx && document.querySelector("#tx-hash")) document.querySelector("#tx-hash").value = tx;

      if (tx && !cxIsTxHash(tx)) {
        cxSetStatusById("#tx-status", "warn", "Invalid tx hash in link.");
        cxToast("Invalid tx hash in link.", "warn", 2600);
        return;
      }

      if (tx) document.querySelector("#tx-run")?.click();
      return;
    }
  }, 120);
}

  // =========================
  // Boot
  // =========================
  window.addEventListener("DOMContentLoaded", () => {
  initPanels();
  initWalletButtons();
  initApiKeysUi();
  initApprovalsUi();
  initRpcUi();
  initTxUi();
  initDevUi();

  bindLangButtons();
  bindMonRemove();
  initLang();

  monRender();
  renderWalletLabels();
  initWiring();
  cxAutoRunFromQuery();

    

});

</script>
</body>
</html>
