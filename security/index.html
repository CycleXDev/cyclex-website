<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google tag (GA4) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-BXDFXJWCNQ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-BXDFXJWCNQ');
  </script>

  <link rel="icon" href="/logo.png">
  <link rel="icon" href="/favicon.ico" sizes="any">
  <link rel="icon" type="image/png" href="/logo.png">
  <link rel="apple-touch-icon" href="/logo.png">

  <meta charset="UTF-8" />
  <title>CycleX â€“ Security Hub</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    :root {
      --bg-main: #05060a;
      --bg-gradient-start: #05060a;
      --bg-gradient-mid: #1a0d3a;
      --bg-gradient-end: #003a4c;

      --text-main: #f4f6ff;
      --text-muted: rgba(244, 246, 255, 0.7);

      --accent-cyan: #00e5ff;
      --accent-green: #5dffb2;
      --accent-purple: #7c5cff;

      --card-bg: rgba(255, 255, 255, 0.06);
      --border-subtle: rgba(255, 255, 255, 0.12);

      --shadow-soft: 0 30px 90px rgba(0, 0, 0, 0.75);
      --radius-xl: 24px;
      --radius-lg: 18px;
      --transition-fast: 0.18s ease-out;

      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text", "Segoe UI", sans-serif;
      --maxw: 1160px;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }
    html, body { height: 100%; }
    body {
      font-family: var(--sans);
      background:
        radial-gradient(circle at top left, rgba(124, 92, 255, 0.35) 0%, transparent 45%),
        radial-gradient(circle at top right, rgba(0, 229, 255, 0.35) 0%, transparent 45%),
        radial-gradient(circle at bottom, rgba(0, 58, 76, 0.55) 0%, transparent 55%),
        linear-gradient(160deg, var(--bg-gradient-start), var(--bg-gradient-mid), var(--bg-gradient-end));
      color: var(--text-main);
      min-height: 100vh;
      -webkit-font-smoothing: antialiased;
      animation: fadeBody 0.7s ease-out forwards;
      opacity: 1;
      overflow-x: hidden;
    }
    @keyframes fadeBody { from { opacity: 0; } to { opacity: 1; } }
    a { color: inherit; text-decoration: none; }

    .page-shell { max-width: var(--maxw); margin: 0 auto; padding: 32px 20px 72px; }

    /* Top bar */
    .top-bar {
      position: sticky;
      top: 14px;
      z-index: 999;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      padding: 12px 18px;
      margin-bottom: 26px;
      border-radius: 999px;
      background: rgba(8, 10, 22, 0.55);
      backdrop-filter: blur(18px);
      -webkit-backdrop-filter: blur(18px);
      border: 1px solid rgba(255, 255, 255, 0.14);
      box-shadow: 0 20px 70px rgba(0, 0, 0, 0.6), inset 0 1px 0 rgba(255, 255, 255, 0.06);
    }
    .brand { display: flex; align-items: center; gap: 10px; min-width: 0; }
    .brand-logo {
      width: 44px; height: 44px; border-radius: 16px; object-fit: contain;
      box-shadow: 0 12px 32px rgba(0, 0, 0, 0.8);
      flex: 0 0 auto;
    }
    .brand-text { display: flex; flex-direction: column; gap: 2px; min-width: 0; }
    .brand-title {
      font-weight: 800; letter-spacing: 0.05em; font-size: 18px; text-transform: uppercase;
      white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
    }
    .brand-sub {
      font-size: 11px; text-transform: uppercase; letter-spacing: 0.16em; color: var(--text-muted);
      white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
    }

    .lang-switch {
      display: inline-flex;
      align-items: center;
      padding: 4px;
      border-radius: 999px;
      background: rgba(255, 255, 255, 0.06);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.16);
      box-shadow: 0 12px 36px rgba(0, 0, 0, 0.55);
      gap: 2px;
      flex: 0 0 auto;
    }
    .lang-btn {
      border: none;
      background: transparent;
      color: var(--text-muted);
      font-size: 11px;
      padding: 6px 9px;
      border-radius: 999px;
      cursor: pointer;
      transition: background var(--transition-fast), color var(--transition-fast), transform var(--transition-fast);
      user-select: none;
      white-space: nowrap;
    }
    .lang-btn:hover { transform: translateY(-1px); }
    .lang-btn.active { background: rgba(0, 229, 255, 0.14); color: var(--accent-cyan); }

    body.lang-switching { animation: langFade 0.28s ease-out; }
    @keyframes langFade { from { opacity: 0.5; transform: translateY(4px); } to { opacity: 1; transform: translateY(0); } }

    /* Hero */
    .hero {
      text-align: center;
      max-width: 980px;
      margin: 0 auto 18px auto;
      animation: fadeUp 0.8s ease-out forwards;
    }
    @keyframes fadeUp { from { opacity: 0; transform: translateY(14px); } to { opacity: 1; transform: translateY(0); } }

    .hero-kicker { font-size: 13px; letter-spacing: 0.16em; text-transform: uppercase; color: var(--accent-cyan); margin-bottom: 14px; }
    .hero-title { font-size: clamp(40px, 5vw, 60px); line-height: 1.05; font-weight: 900; margin-bottom: 14px; letter-spacing: -0.02em; }
    .hero-subtitle { max-width: 760px; margin: 0 auto 18px auto; font-size: 16px; line-height: 1.5; color: var(--text-muted); }

    .hero-actions { display: flex; justify-content: center; flex-wrap: wrap; gap: 14px; margin-bottom: 10px; }

    .btn {
      border-radius: 999px;
      border: none;
      padding: 13px 26px;
      font-size: 14px;
      font-weight: 700;
      letter-spacing: 0.04em;
      text-transform: uppercase;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      transition: transform var(--transition-fast), box-shadow var(--transition-fast), background var(--transition-fast), color var(--transition-fast), border-color var(--transition-fast);
      user-select: none;
      white-space: nowrap;
    }
    .btn:disabled { opacity: 0.55; cursor: not-allowed; }

    .btn-primary {
      background: linear-gradient(135deg, var(--accent-cyan), #7df2ff);
      color: #020308;
      box-shadow: 0 14px 40px rgba(0, 229, 255, 0.4);
    }
    .btn-primary:hover { transform: translateY(-1px); box-shadow: 0 18px 60px rgba(0, 229, 255, 0.6); }

    .btn-secondary {
      background: linear-gradient(135deg, var(--accent-green), #b9ffcf);
      color: #020308;
      box-shadow: 0 14px 40px rgba(0, 230, 118, 0.4);
    }
    .btn-secondary:hover { transform: translateY(-1px); box-shadow: 0 18px 60px rgba(0, 230, 118, 0.7); }

    .btn-ghost {
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.16);
      color: var(--text-main);
      box-shadow: 0 12px 34px rgba(0,0,0,0.45);
    }
    .btn-ghost:hover { transform: translateY(-1px); border-color: rgba(0,229,255,0.26); }

    .note-line {
      margin-top: 10px;
      font-size: 12px;
      color: var(--text-muted);
      line-height: 1.45;
    }

    /* Tool cubes */
    .tool-grid-wrap { max-width: var(--maxw); margin: 0 auto 14px; }
    .tool-grid-title {
      text-align: center;
      margin: 14px 0 8px;
      font-size: 12px;
      letter-spacing: 0.16em;
      text-transform: uppercase;
      color: rgba(244,246,255,0.72);
    }

    .tool-grid {
      display: grid;
      grid-template-columns: repeat(12, 1fr);
      gap: 14px;
      margin-top: 10px;
    }
    .tool-card {
      grid-column: span 4;
      background: rgba(255,255,255,0.05);
      border-radius: var(--radius-xl);
      border: 1px solid rgba(255,255,255,0.12);
      padding: 16px 16px 14px;
      box-shadow: 0 24px 70px rgba(0,0,0,0.65), inset 0 1px 0 rgba(255,255,255,0.05);
      cursor: pointer;
      position: relative;
      overflow: hidden;
      transition: transform var(--transition-fast), border-color var(--transition-fast), background var(--transition-fast);
      min-width: 0;
    }
    .tool-card::before{
      content:"";
      position:absolute; inset:-2px;
      background:
        radial-gradient(520px 160px at 18% -5%, rgba(0,229,255,.16), transparent 60%),
        radial-gradient(520px 160px at 85% 0%, rgba(124,92,255,.16), transparent 60%);
      pointer-events:none;
      opacity: .9;
    }
    .tool-card > * { position: relative; }

    .tool-card:hover { transform: translateY(-2px); border-color: rgba(0,229,255,0.26); background: rgba(255,255,255,0.06); }
    .tool-card.active { border-color: rgba(0,229,255,0.38); background: rgba(0,229,255,0.06); }

    .tool-head { display:flex; align-items:flex-start; justify-content:space-between; gap:10px; margin-bottom:8px; }
    .tool-name { font-size: 15px; font-weight: 900; letter-spacing: 0.01em; line-height: 1.25; }
    .tool-desc { font-size: 13px; color: var(--text-muted); line-height: 1.45; }

    .badge-row { display:flex; flex-wrap:wrap; gap:8px; margin-top: 12px; }
    .badge {
      display:inline-flex; align-items:center; gap:8px;
      font-size: 12px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.12);
      background: rgba(255,255,255,0.05);
      color: var(--text-muted);
      white-space: nowrap;
      user-select: none;
    }
    .badge strong { color: rgba(244,246,255,0.92); font-weight: 800; }
    .badge.beta { border-color: rgba(255,193,7,0.25); background: rgba(255,193,7,0.08); color: rgba(244,246,255,0.92); }

    /* Panels */
    .panel-shell {
      margin-top: 14px;
      padding: 22px 20px;
      border-radius: var(--radius-xl);
      background: rgba(255, 255, 255, 0.04);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.12);
      box-shadow: 0 28px 80px rgba(0, 0, 0, 0.65), inset 0 1px 0 rgba(255, 255, 255, 0.05);
    }
    .panel-shell.hidden { display: none; }

    .panel-head {
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
      margin-bottom: 12px;
    }
    .panel-kicker {
      font-size: 12px;
      letter-spacing: 0.16em;
      text-transform: uppercase;
      color: var(--accent-purple);
      margin-bottom: 8px;
    }
    .panel-title { font-size: 28px; font-weight: 900; letter-spacing: -0.01em; line-height: 1.12; }
    .panel-sub { margin-top: 8px; max-width: 900px; color: var(--text-muted); font-size: 14px; line-height: 1.6; }

    .panel-actions { display:flex; gap:10px; flex-wrap:wrap; justify-content:flex-end; align-items:center; }
    .pill {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      font-size: 12px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.12);
      background: rgba(255,255,255,0.05);
      color: var(--text-muted);
      white-space: nowrap;
    }

    .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; margin-top: 14px; }
    .grid-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 14px; margin-top: 14px; }

    .card {
      background: var(--card-bg);
      border-radius: var(--radius-lg);
      border: 1px solid var(--border-subtle);
      padding: 16px;
      box-shadow: var(--shadow-soft);
      backdrop-filter: blur(18px);
      min-width: 0;
    }
    .card h3 { font-size: 15px; letter-spacing: 0.02em; margin-bottom: 8px; color: var(--text-main); }
    .muted { color: var(--text-muted); font-size: 13px; line-height: 1.45; }

    .field { margin-top: 10px; }
    .label { font-size: 12px; letter-spacing: 0.08em; text-transform: uppercase; color: rgba(244,246,255,0.75); margin-bottom: 6px; }
    .row { display: flex; gap: 10px; flex-wrap: wrap; align-items: center; }

    input, textarea, select {
      width: 100%;
      padding: 10px 12px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.16);
      background: rgba(5, 7, 18, 0.9);
      color: var(--text-main);
      font-size: 13px;
      outline: none;
    }
    textarea { border-radius: 18px; min-height: 96px; resize: vertical; padding: 12px 12px; }
    input:focus, textarea:focus, select:focus { border-color: var(--accent-cyan); }
    .mono { font-family: var(--mono); }

    .toggle{
      display:flex; align-items:center; gap:10px;
      padding:10px 12px;
      border:1px solid rgba(255,255,255,0.12);
      background: rgba(255,255,255,0.04);
      border-radius: 14px;
      user-select:none;
      width: 100%;
    }
    .toggle input{ width:auto; accent-color: var(--accent-cyan); }

    .status {
      margin-top: 10px;
      padding: 12px 14px;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,0.14);
      background: rgba(255,255,255,0.04);
      color: var(--text-main);
      line-height: 1.5;
      font-size: 13px;
      display: none;
      overflow-wrap: anywhere;
    }
    .status.ok   { display:block; background: rgba(0, 230, 118, 0.10); border-color: rgba(0,230,118,0.35); color: #78ffbf; }
    .status.warn { display:block; background: rgba(255, 193, 7, 0.10); border-color: rgba(255,193,7,0.35); color: #ffd166; }
    .status.bad  { display:block; background: rgba(220, 53, 69, 0.10); border-color: rgba(220,53,69,0.35); color: #ff7a8a; }
    .status.info { display:block; background: rgba(0, 229, 255, 0.10); border-color: rgba(0,229,255,0.30); color: #7df2ff; }

    .small { font-size: 12px; color: var(--text-muted); line-height: 1.45; }

    .table {
      margin-top: 10px;
      border: 1px solid rgba(255,255,255,0.12);
      border-radius: 18px;
      overflow: hidden;
    }
    .trow {
      display: grid;
      grid-template-columns: 1.3fr 1.1fr 0.9fr 0.9fr;
      gap: 10px;
      padding: 10px 12px;
      border-top: 1px solid rgba(255,255,255,0.10);
      background: rgba(255,255,255,0.03);
      align-items: center;
      font-size: 13px;
    }
    .trow.head {
      border-top: none;
      background: rgba(255,255,255,0.05);
      font-size: 12px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: rgba(244,246,255,0.75);
    }
    .trow .cell { min-width: 0; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
    .trow .cell.wrap { white-space: normal; overflow: visible; }
    .trow .cell .mini { font-size: 12px; color: rgba(244,246,255,0.82); }
    .trow.highlight { background: rgba(0,230,118,0.10); border-top-color: rgba(0,230,118,0.20); }

    .chips { display:flex; flex-wrap:wrap; gap:10px; margin-top: 10px; }
    .chip {
      display:inline-flex; align-items:center; gap:8px;
      padding: 8px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.12);
      background: rgba(255,255,255,0.05);
      color: rgba(244,246,255,0.88);
      cursor: pointer;
      user-select: none;
      transition: transform var(--transition-fast), border-color var(--transition-fast);
      font-size: 12px;
    }
    .chip:hover { transform: translateY(-1px); border-color: rgba(0,229,255,0.26); }
    .chip .x { opacity: .85; color: var(--text-muted); }

    .share-row { display:flex; gap:10px; flex-wrap:wrap; margin-top: 12px; }

    /* Footer */
    .footer {
      border-top: 1px solid rgba(255, 255, 255, 0.06);
      margin-top: 20px;
      padding-top: 16px;
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      font-size: 12px;
      color: var(--text-muted);
    }
    .footer-tagline { color: var(--accent-cyan); font-weight: 700; }

    /* Responsiveness */
    @media (max-width: 980px) {
      .tool-card { grid-column: span 6; }
      .grid-2, .grid-3 { grid-template-columns: 1fr; }
      .trow { grid-template-columns: 1.2fr 1fr 0.9fr; }
      .trow .hide-sm { display: none; }
      .panel-title { font-size: 24px; }
    }
    @media (max-width: 640px) {
      .tool-card { grid-column: span 12; }
      .top-bar { top: 10px; padding: 10px 12px; }
      .brand-logo { width: 40px; height: 40px; border-radius: 14px; }
      .btn { padding: 12px 18px; font-size: 13px; }
    }
  </style>
</head>
<body>
  <div class="page-shell">
    <header class="top-bar">
      <a class="brand" href="/" title="Back to CycleX">
        <img src="/logo.png" alt="CycleX logo" class="brand-logo" />
        <div class="brand-text">
          <div class="brand-title">CYCLEX</div>
          <div class="brand-sub" data-i18n="brand_sub">On-Chain Security & Rewards</div>
        </div>
      </a>

      <div class="lang-switch" aria-label="Language selector">
        <button class="lang-btn active" data-lang="en">ğŸ‡ºğŸ‡¸ EN</button>
        <button class="lang-btn" data-lang="zh">ğŸ‡¨ğŸ‡³ ä¸­æ–‡</button>
        <button class="lang-btn" data-lang="ar">ğŸ‡¸ğŸ‡¦ Ø¹Ø±Ø¨ÙŠ</button>
        <button class="lang-btn" data-lang="ru">ğŸ‡·ğŸ‡º RU</button>
      </div>
    </header>

    <main>
      <section class="hero">
        <div class="hero-kicker" data-i18n="hero_kicker">Security Hub</div>
        <h1 class="hero-title" data-i18n="hero_title">CycleX Security Tools</h1>
        <p class="hero-subtitle" data-i18n="hero_subtitle">
          A lightweight, client-side toolkit for safer swaps, approvals hygiene, and RPC health checks across BSC + Ethereum.
        </p>

        <div class="hero-actions">
          <a class="btn btn-primary" href="/" data-i18n="btn_back">Back to Site</a>
          <button class="btn btn-secondary" id="btn-connect" data-i18n="btn_connect">Connect Wallet (optional)</button>
          <button class="btn btn-ghost" id="btn-quick" data-i18n="btn_quick">Run Quick Scan</button>
        </div>

        <div class="note-line" data-i18n="hero_note">
          Note: These checks are informational and do not guarantee safety. Always verify independently.
        </div>
      </section>

      <section class="tool-grid-wrap">
        <div class="tool-grid-title" data-i18n="tools_kicker">CHOOSE A TOOL</div>

        <div class="tool-grid" id="toolGrid">
          <div class="tool-card active" data-tool="quick">
            <div class="tool-head">
              <div class="tool-name" data-i18n="cube_quick_title">Quick Scan</div>
              <div class="badge"><strong>BSC</strong> + <strong>ETH</strong></div>
            </div>
            <div class="tool-desc" data-i18n="cube_quick_desc">
              Paste a token, get a practical score + warnings, save history, and share results.
            </div>
            <div class="badge-row">
              <div class="badge"><strong data-i18n="badge_fast">Fast</strong></div>
              <div class="badge"><strong data-i18n="badge_history">History</strong></div>
              <div class="badge"><strong data-i18n="badge_share">Share</strong></div>
            </div>
          </div>

          <div class="tool-card" data-tool="deep">
            <div class="tool-head">
              <div class="tool-name" data-i18n="cube_deep_title">Token Safety + Liquidity</div>
              <div class="badge"><strong>BSC</strong> + <strong>ETH</strong></div>
            </div>
            <div class="tool-desc" data-i18n="cube_deep_desc">
              Deeper scan: proxy hints, ownership hints, bytecode fingerprint, liquidity pairs & LP burn signal.
            </div>
            <div class="badge-row">
              <div class="badge"><strong data-i18n="badge_deeper">Deeper</strong></div>
              <div class="badge"><strong data-i18n="badge_pairs">Pairs</strong></div>
            </div>
          </div>

          <div class="tool-card" data-tool="honeypot">
            <div class="tool-head">
              <div class="tool-name" data-i18n="cube_honey_title">Honeypot / Sell Signals</div>
              <div class="badge beta"><strong data-i18n="badge_beta">Beta</strong></div>
            </div>
            <div class="tool-desc" data-i18n="cube_honey_desc">
              Best-effort â€œsell riskâ€ signals from on-chain patterns + suspicious bytecode keywords.
            </div>
            <div class="badge-row">
              <div class="badge"><strong data-i18n="badge_signals">Signals</strong></div>
              <div class="badge"><strong data-i18n="badge_keywords">Keywords</strong></div>
            </div>
          </div>

          <div class="tool-card" data-tool="approvals">
            <div class="tool-head">
              <div class="tool-name" data-i18n="cube_approvals_title">Approval Guardian</div>
              <div class="badge"><strong data-i18n="badge_wallet">Wallet</strong></div>
            </div>
            <div class="tool-desc" data-i18n="cube_approvals_desc">
              Check and revoke ERC-20 allowances safely (approve â†’ 0) with a clean, pro UX.
            </div>
            <div class="badge-row">
              <div class="badge"><strong>BSC</strong> + <strong>ETH</strong></div>
              <div class="badge"><strong data-i18n="badge_revoke">Revoke</strong></div>
            </div>
          </div>

          <div class="tool-card" data-tool="rpc">
            <div class="tool-head">
              <div class="tool-name" data-i18n="cube_rpc_title">RPC Health Checker</div>
              <div class="badge"><strong>BSC</strong> + <strong>ETH</strong></div>
            </div>
            <div class="tool-desc" data-i18n="cube_rpc_desc">
              Test endpoints, show latency + block height, then copy the best RPC instantly.
            </div>
            <div class="badge-row">
              <div class="badge"><strong data-i18n="badge_table">Table</strong></div>
              <div class="badge"><strong data-i18n="badge_copy">Copy</strong></div>
            </div>
          </div>

          <div class="tool-card" data-tool="monitor">
            <div class="tool-head">
              <div class="tool-name" data-i18n="cube_monitor_title">Contract Diff / Upgrade Monitor</div>
              <div class="badge"><strong data-i18n="badge_watch">Watch</strong></div>
            </div>
            <div class="tool-desc" data-i18n="cube_monitor_desc">
              Save contracts locally, detect bytecode changes and proxy implementation upgrades over time.
            </div>
            <div class="badge-row">
              <div class="badge"><strong data-i18n="badge_local">Local</strong></div>
              <div class="badge"><strong data-i18n="badge_changes">Changes</strong></div>
            </div>
          </div>
        </div>
      </section>

      <!-- PANELS (open below cubes) -->
      <section class="panel-shell" id="panel-quick">
        <div class="panel-head">
          <div>
            <div class="panel-kicker" data-i18n="p_quick_kicker">Quick Scan</div>
            <div class="panel-title" data-i18n="p_quick_title">Score a token in seconds</div>
            <div class="panel-sub" data-i18n="p_quick_sub">
              Paste a token address, choose network, run scan. We save history locally and generate shareable outputs.
            </div>
          </div>
          <div class="panel-actions">
            <div class="pill"><span data-i18n="pill_wallet">Wallet</span>: <span class="mono" id="walletLabel">not connected</span></div>
            <button class="btn btn-ghost" id="btnCloseQuick" data-i18n="btn_close">Close</button>
          </div>
        </div>

        <div class="grid-2">
          <div class="card">
            <h3 data-i18n="quick_input_title">Token Input</h3>

            <div class="field">
              <div class="label" data-i18n="net_label">Network</div>
              <select id="qs-net">
                <option value="bsc">BSC (BNB Chain)</option>
                <option value="eth">Ethereum</option>
              </select>
            </div>

            <div class="field">
              <div class="label" data-i18n="addr_label">Token contract</div>
              <input id="qs-token" class="mono" placeholder="0x..." />
              <div class="small" style="margin-top:8px" data-i18n="qs_tip">
                Tip: open with <span class="mono">?token=0x...</span> to auto-run.
              </div>
            </div>

            <div class="field">
              <div class="label" data-i18n="options_label">Options</div>
              <label class="toggle">
                <input type="checkbox" id="qs-require-liq">
                <span data-i18n="opt_require_liq">Require liquidity (stricter score)</span>
              </label>
              <label class="toggle" style="margin-top:10px">
                <input type="checkbox" id="qs-show-json" checked>
                <span data-i18n="opt_show_json">Enable JSON report (copy)</span>
              </label>
            </div>

            <div class="field">
              <div class="row">
                <button class="btn btn-primary" id="qs-run" data-i18n="btn_scan">Scan</button>
                <button class="btn btn-ghost" id="qs-copy-link" data-i18n="btn_copy_link">Copy Share Link</button>
                <button class="btn btn-ghost" id="qs-copy-json" data-i18n="btn_copy_json">Copy JSON</button>
              </div>
            </div>

            <div class="field">
              <div class="label" data-i18n="history_label">History</div>
              <div class="chips" id="qs-history"></div>
              <div class="small" style="margin-top:8px" data-i18n="history_tip">
                Click an item to re-run quickly. Stored locally only.
              </div>
            </div>

            <div class="share-row">
              <button class="btn btn-ghost" id="qs-share-x">Share to X</button>
              <button class="btn btn-ghost" id="qs-share-tg">Share to Telegram</button>
            </div>

            <div id="qs-status" class="status info"></div>
          </div>

          <div class="card">
            <h3 data-i18n="results_title">Results</h3>
            <div class="small" data-i18n="results_hint">
              Green / Yellow / Red signals. Not a guarantee â€” just verifiable on-chain checks.
            </div>

            <div id="qs-out" class="status info" style="display:block; margin-top:10px;">
              <strong>Ready.</strong><br>
              Paste a token address and click <b>Scan</b>.
            </div>

            <div id="qs-pairsWrap" style="margin-top:12px;"></div>
          </div>
        </div>
      </section>

      <section class="panel-shell hidden" id="panel-deep">
        <div class="panel-head">
          <div>
            <div class="panel-kicker" data-i18n="p_deep_kicker">Token Safety + Liquidity</div>
            <div class="panel-title" data-i18n="p_deep_title">Deeper on-chain breakdown</div>
            <div class="panel-sub" data-i18n="p_deep_sub">
              Same scan, but expanded: bytecode fingerprint, proxy details, liquidity pairs, LP burn signal, and keyword hints.
            </div>
          </div>
          <div class="panel-actions">
            <button class="btn btn-ghost" id="btnCloseDeep" data-i18n="btn_close">Close</button>
          </div>
        </div>

        <div class="grid-2">
          <div class="card">
            <h3 data-i18n="deep_input_title">Run Deep Scan</h3>

            <div class="field">
              <div class="label" data-i18n="net_label">Network</div>
              <select id="ds-net">
                <option value="bsc">BSC (BNB Chain)</option>
                <option value="eth">Ethereum</option>
              </select>
            </div>

            <div class="field">
              <div class="label" data-i18n="addr_label">Token contract</div>
              <input id="ds-token" class="mono" placeholder="0x..." />
            </div>

            <div class="field">
              <div class="row">
                <button class="btn btn-primary" id="ds-run" data-i18n="btn_scan">Scan</button>
                <button class="btn btn-ghost" id="ds-copy-json" data-i18n="btn_copy_json">Copy JSON</button>
              </div>
            </div>

            <div id="ds-status" class="status info"></div>
          </div>

          <div class="card">
            <h3 data-i18n="deep_results_title">Detailed Report</h3>
            <div id="ds-out" class="status info" style="display:block; margin-top:10px;">â€”</div>
            <div id="ds-tableWrap" style="margin-top:12px;"></div>
          </div>
        </div>
      </section>

      <section class="panel-shell hidden" id="panel-honeypot">
        <div class="panel-head">
          <div>
            <div class="panel-kicker" data-i18n="p_honey_kicker">Honeypot / Sell Signals</div>
            <div class="panel-title" data-i18n="p_honey_title">Best-effort â€œsell riskâ€ signals</div>
            <div class="panel-sub" data-i18n="p_honey_sub">
              We cannot guarantee honeypot detection client-side. This panel surfaces risk patterns you can verify (ownership, proxy, liquidity, keyword hints).
            </div>
          </div>
          <div class="panel-actions">
            <div class="pill"><span data-i18n="pill_mode">Mode</span>: <span class="mono">Beta</span></div>
            <button class="btn btn-ghost" id="btnCloseHoney" data-i18n="btn_close">Close</button>
          </div>
        </div>

        <div class="grid-2">
          <div class="card">
            <h3 data-i18n="honey_input_title">Token</h3>

            <div class="field">
              <div class="label" data-i18n="net_label">Network</div>
              <select id="hs-net">
                <option value="bsc">BSC (BNB Chain)</option>
                <option value="eth">Ethereum</option>
              </select>
            </div>

            <div class="field">
              <div class="label" data-i18n="addr_label">Token contract</div>
              <input id="hs-token" class="mono" placeholder="0x..." />
            </div>

            <div class="field">
              <label class="toggle">
                <input type="checkbox" id="hs-strict" checked>
                <span data-i18n="honey_strict">Strict warnings (better safe)</span>
              </label>
            </div>

            <div class="field">
              <div class="row">
                <button class="btn btn-primary" id="hs-run" data-i18n="btn_scan">Scan</button>
                <button class="btn btn-ghost" id="hs-copy-json" data-i18n="btn_copy_json">Copy JSON</button>
              </div>
            </div>

            <div id="hs-status" class="status info"></div>
          </div>

          <div class="card">
            <h3 data-i18n="honey_results_title">Signals</h3>
            <div id="hs-out" class="status info" style="display:block; margin-top:10px;">â€”</div>
          </div>
        </div>
      </section>

      <section class="panel-shell hidden" id="panel-approvals">
        <div class="panel-head">
          <div>
            <div class="panel-kicker" data-i18n="p_app_kicker">Approval Guardian</div>
            <div class="panel-title" data-i18n="p_app_title">Check and revoke allowances</div>
            <div class="panel-sub" data-i18n="p_app_sub">
              For privacy + reliability, you provide spender + tokens (or seed common tokens). We read allowance(owner, spender) and revoke with approve(spender, 0).
            </div>
          </div>
          <div class="panel-actions">
            <div class="pill"><span data-i18n="pill_wallet">Wallet</span>: <span class="mono" id="ap-wallet">not connected</span></div>
            <button class="btn btn-ghost" id="btnCloseApprovals" data-i18n="btn_close">Close</button>
          </div>
        </div>

        <div class="grid-2">
          <div class="card">
            <h3 data-i18n="ap_settings_title">Settings</h3>

            <div class="field">
              <div class="label" data-i18n="net_label">Network</div>
              <select id="ap-net">
                <option value="bsc">BSC (BNB Chain)</option>
                <option value="eth">Ethereum</option>
              </select>
            </div>

            <div class="field">
              <div class="row" style="justify-content:space-between">
                <div class="pill"><span data-i18n="ap_connected">Connected:</span> <span id="ap-address" class="mono">â€”</span></div>
                <button class="btn btn-secondary" id="ap-connect" data-i18n="ap_connect">Connect / Refresh</button>
              </div>
            </div>

            <div class="field">
              <div class="label" data-i18n="ap_spender_label">Spender preset</div>
              <div class="row">
                <select id="ap-spender-preset">
                  <option value="pcs_router">PancakeSwap Router (BSC)</option>
                  <option value="uni_router">Uniswap V2 Router (ETH)</option>
                  <option value="custom">Customâ€¦</option>
                </select>
                <input id="ap-spender" class="mono" placeholder="0x spender..." />
              </div>
              <div class="small" style="margin-top:8px" data-i18n="ap_spender_tip">
                Start with a router preset, then add tokens you want to clean up.
              </div>
            </div>

            <div class="field">
              <div class="label" data-i18n="ap_tokens_label">Token list (one per line)</div>
              <textarea id="ap-tokens" class="mono" placeholder="0x...\n0x...\n0x..."></textarea>
              <div class="row" style="margin-top:10px">
                <button class="btn btn-ghost" id="ap-seed-common" data-i18n="ap_seed">Seed common tokens</button>
                <button class="btn btn-ghost" id="ap-seed-history" data-i18n="ap_seed_history">Use scan history</button>
              </div>
            </div>

            <div class="field">
              <div class="row">
                <button class="btn btn-primary" id="ap-check" data-i18n="ap_check">Check Allowances</button>
                <button class="btn btn-ghost" id="ap-revoke-all" data-i18n="ap_revoke_all">Revoke All (non-zero)</button>
              </div>
            </div>

            <div id="ap-status" class="status info"></div>
          </div>

          <div class="card">
            <h3 data-i18n="ap_results">Allowances</h3>
            <div class="small" data-i18n="ap_results_hint">
              If allowance is â€œinfiniteâ€, revoke is recommended unless you fully trust the spender.
            </div>

            <div id="ap-table" class="table" style="margin-top:12px;">
              <div class="trow head">
                <div class="cell">Token</div>
                <div class="cell">Allowance</div>
                <div class="cell hide-sm">Symbol</div>
                <div class="cell">Action</div>
              </div>
              <div class="trow">
                <div class="cell muted">â€”</div>
                <div class="cell muted">â€”</div>
                <div class="cell muted hide-sm">â€”</div>
                <div class="cell muted">â€”</div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <section class="panel-shell hidden" id="panel-rpc">
        <div class="panel-head">
          <div>
            <div class="panel-kicker" data-i18n="p_rpc_kicker">RPC Health Checker</div>
            <div class="panel-title" data-i18n="p_rpc_title">Find the best endpoint</div>
            <div class="panel-sub" data-i18n="p_rpc_sub">
              We test RPC endpoints with eth_blockNumber and measure latency. Best result is highlighted and ready to copy.
            </div>
          </div>
          <div class="panel-actions">
            <button class="btn btn-ghost" id="btnCloseRpc" data-i18n="btn_close">Close</button>
          </div>
        </div>

        <div class="grid-2">
          <div class="card">
            <h3 data-i18n="rpc_inputs">Inputs</h3>

            <div class="field">
              <div class="label" data-i18n="net_label">Network</div>
              <select id="rpc-net">
                <option value="bsc">BSC (BNB Chain)</option>
                <option value="eth">Ethereum</option>
              </select>
            </div>

            <div class="field">
              <div class="label" data-i18n="rpc_custom_label">Optional custom RPC (top priority)</div>
              <input id="rpc-custom" class="mono" placeholder="https://..." />
            </div>

            <div class="field">
              <div class="row">
                <button class="btn btn-primary" id="rpc-test" data-i18n="rpc_test">Test RPCs</button>
                <button class="btn btn-ghost" id="rpc-copy-best" data-i18n="rpc_copy_best">Copy Best RPC</button>
                <button class="btn btn-ghost" id="rpc-copy-json">Copy JSON list</button>
              </div>
            </div>

            <div id="rpc-status" class="status info"></div>
          </div>

          <div class="card">
            <h3 data-i18n="rpc_results">Results</h3>

            <div id="rpc-table" class="table">
              <div class="trow head">
                <div class="cell">RPC</div>
                <div class="cell">Latency</div>
                <div class="cell hide-sm">Block</div>
                <div class="cell">Status</div>
              </div>
            </div>

            <div class="small" style="margin-top:10px" data-i18n="rpc_tip">
              Tip: Some RPCs fail due to CORS/timeouts. Run the test and pick the stable fastest.
            </div>
          </div>
        </div>
      </section>

      <section class="panel-shell hidden" id="panel-monitor">
        <div class="panel-head">
          <div>
            <div class="panel-kicker" data-i18n="p_mon_kicker">Contract Monitor</div>
            <div class="panel-title" data-i18n="p_mon_title">Detect upgrades & bytecode changes</div>
            <div class="panel-sub" data-i18n="p_mon_sub">
              Save contracts locally. We store code hash + proxy implementation. Re-check later to detect changes.
            </div>
          </div>
          <div class="panel-actions">
            <button class="btn btn-ghost" id="btnCloseMonitor" data-i18n="btn_close">Close</button>
          </div>
        </div>

        <div class="grid-2">
          <div class="card">
            <h3 data-i18n="mon_add_title">Add to watchlist</h3>

            <div class="field">
              <div class="label" data-i18n="net_label">Network</div>
              <select id="mon-net">
                <option value="bsc">BSC (BNB Chain)</option>
                <option value="eth">Ethereum</option>
              </select>
            </div>

            <div class="field">
              <div class="label" data-i18n="addr_label">Contract address</div>
              <input id="mon-addr" class="mono" placeholder="0x..." />
            </div>

            <div class="field">
              <div class="row">
                <button class="btn btn-primary" id="mon-add" data-i18n="mon_add">Add</button>
                <button class="btn btn-ghost" id="mon-check" data-i18n="mon_check">Check all</button>
                <button class="btn btn-ghost" id="mon-export">Export JSON</button>
              </div>
            </div>

            <div id="mon-status" class="status info"></div>
          </div>

          <div class="card">
            <h3 data-i18n="mon_list_title">Watchlist</h3>
            <div class="small" data-i18n="mon_list_hint">Stored locally only. No server tracking.</div>

            <div id="mon-table" class="table" style="margin-top:12px;">
              <div class="trow head">
                <div class="cell">Contract</div>
                <div class="cell">Network</div>
                <div class="cell hide-sm">Last seen</div>
                <div class="cell">Status</div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <footer class="footer">
        <div data-i18n="footer_left">
          CycleX Security Hub runs client-side and reads public on-chain data.
        </div>
        <div class="footer-tagline" data-i18n="footer_tagline">
          Verify twice. Connect only when you trust the page.
        </div>
      </footer>
    </main>
  </div>

    <!-- Load ethers.js (required) -->
  <script src="https://cdn.jsdelivr.net/npm/ethers@6.7.1/dist/ethers.umd.min.js"></script>

  <script>
    // ====== i18n ======
    const translations = {
      en: {
        brand_sub: "On-Chain Security & Rewards",
        hero_kicker: "Security Hub",
        hero_title: "CycleX Security Tools",
        hero_subtitle: "A lightweight, client-side toolkit for safer swaps, approvals hygiene, DEX redirects, and RPC health checks.",
        btn_back: "Back to Site",
        btn_connect: "Connect Wallet (optional)",
        btn_run_all: "Run Quick Scan",
        hero_note: "Note: These checks are informational and do not guarantee safety. Always verify independently.",

        ss_kicker: "SafeSwap Gate",
        ss_title: "Check token basics before you swap",
        ss_sub: "Enter a token address on BSC. Weâ€™ll read on-chain metadata, owner/proxy hints, and multi-DEX liquidity signals â€” then generate shareable outputs.",
        ss_input_title: "Token Address",
        ss_token_label: "Token contract (BSC)",
        ss_tip: "Tip: You can open this page with ?token=0x... and it will auto-run.",
        ss_actions_label: "Actions",
        ss_scan: "Scan",
        ss_share: "Copy Share Link",
        ss_copy_json: "Copy JSON report",
        ss_options_label: "Options",
        ss_require_liq: "Require liquidity (production)",
        ss_require_liq_tip: "When enabled, â€œNo DEX pairâ€ becomes Red. When disabled, itâ€™s treated as â€œNot listed yetâ€.",
        ss_open_swap: "Open Swap",
        ss_results_title: "Results",
        ss_results_hint: "We score signals as Green / Yellow / Red. This is not a honeypot guarantee â€” just solid on-chain hygiene checks.",

        ap_kicker: "Approvals Guardian",
        ap_title: "Check and revoke ERC-20 allowances",
        ap_sub: "This tool is targeted: you provide token(s) and spender. We read allowance(owner, spender) and can revoke by sending approve(spender, 0).",
        ap_owner: "Owner wallet",
        ap_connected: "Connected:",
        ap_connect: "Connect / Refresh",
        ap_spender_label: "Spender",
        ap_spender_tip: "If youâ€™re unsure: start with PancakeSwap Router preset.",
        ap_tokens_label: "Token list (one per line)",
        ap_check: "Check Allowances",
        ap_revoke_all: "Revoke All (non-zero)",
        ap_results: "Allowances",
        ap_results_hint: "If allowance is â€œinfiniteâ€, revoke is recommended unless you fully trust the spender.",

        bm_kicker: "DEX Guard",
        bm_title: "Bookmarklet redirect to your security page",
        bm_sub: "Save a bookmark that extracts token params from DEX pages and opens this Security Hub with ?token=.",
        bm_drag: "Drag to bookmarks bar",
        bm_drag_tip: "On desktop: drag this button into your bookmarks bar.",
        bm_note: "Works best when a DEX URL includes outputCurrency / inputCurrency (or similar).",
        bm_code: "Bookmarklet code",
        bm_code_tip: "If your browser blocks drag-drop, create a bookmark and paste this into the URL field:",

        rpc_kicker: "RPC Checker",
        rpc_title: "Find the fastest working BSC RPC",
        rpc_sub: "We measure response time using eth_blockNumber via ethers. Fastest result is highlighted.",
        rpc_list: "Endpoints",
        rpc_custom_label: "Optional custom RPC",
        rpc_test: "Test RPCs",
        rpc_copy_best: "Copy Best RPC",
        rpc_results: "Results",
        rpc_tip: "Tip: If one RPC fails due to CORS/timeout, try another â€” we auto-fallback in CycleX anyway.",

        footer_left: "CycleX Security Hub runs client-side and reads public on-chain data.",
        footer_tagline: "Verify twice. Connect only when you trust the page."
      },
      zh: {
        brand_sub: "é“¾ä¸Šå®‰å…¨ä¸å¥–åŠ±æœºåˆ¶",
        hero_kicker: "å®‰å…¨ä¸­å¿ƒ",
        hero_title: "CycleX å®‰å…¨å·¥å…·",
        hero_subtitle: "è½»é‡çº§å®¢æˆ·ç«¯å·¥å…·ï¼šæ¢å¸å‰æ£€æŸ¥ã€æˆæƒç®¡ç†ã€DEX è·³è½¬ä¸ RPC ä½“æ£€ã€‚",
        btn_back: "è¿”å›ç½‘ç«™",
        btn_connect: "è¿æ¥é’±åŒ…ï¼ˆå¯é€‰ï¼‰",
        btn_run_all: "å¿«é€Ÿæ‰«æ",
        hero_note: "æç¤ºï¼šè¿™äº›æ£€æŸ¥ä»…ä¾›å‚è€ƒï¼Œä¸ä¿è¯å®‰å…¨ï¼Œè¯·è‡ªè¡ŒäºŒæ¬¡éªŒè¯ã€‚",

        ss_kicker: "SafeSwap Gate",
        ss_title: "æ¢å¸å‰å…ˆåšåŸºç¡€æ£€æŸ¥",
        ss_sub: "è¾“å…¥ BSC ä»£å¸åœ°å€ï¼Œè¯»å–é“¾ä¸Šä¿¡æ¯ã€owner/proxy çº¿ç´¢ä¸å¤š DEX æµåŠ¨æ€§ä¿¡å·ï¼Œå¹¶ç”Ÿæˆå¯åˆ†äº«ç»“æœã€‚",
        ss_input_title: "ä»£å¸åœ°å€",
        ss_token_label: "ä»£å¸åˆçº¦ï¼ˆBSCï¼‰",
        ss_tip: "æç¤ºï¼šå¯ä»¥ç”¨ ?token=0x... æ‰“å¼€æœ¬é¡µå¹¶è‡ªåŠ¨æ‰«æã€‚",
        ss_actions_label: "æ“ä½œ",
        ss_scan: "æ‰«æ",
        ss_share: "å¤åˆ¶åˆ†äº«é“¾æ¥",
        ss_copy_json: "å¤åˆ¶ JSON æŠ¥å‘Š",
        ss_options_label: "é€‰é¡¹",
        ss_require_liq: "å¼ºåˆ¶è¦æ±‚æµåŠ¨æ€§ï¼ˆç”Ÿäº§æ¨¡å¼ï¼‰",
        ss_require_liq_tip: "å¼€å¯åï¼šæ²¡æœ‰ DEX Pair ä¼šå˜çº¢ï¼›å…³é—­åˆ™è§†ä¸ºâ€œå°šæœªä¸Šæ¶â€ã€‚",
        ss_open_swap: "æ‰“å¼€å…‘æ¢",
        ss_results_title: "ç»“æœ",
        ss_results_hint: "ç”¨ç»¿/é»„/çº¢ä¿¡å·è¯„åˆ†ã€‚è¿™ä¸æ˜¯èœœç½ä¿è¯ï¼Œåªæ˜¯é“¾ä¸ŠåŸºç¡€å®‰å…¨æ£€æŸ¥ã€‚",

        ap_kicker: "æˆæƒå®ˆå«",
        ap_title: "æ£€æŸ¥å¹¶æ’¤é”€ ERC-20 æˆæƒ",
        ap_sub: "å®šå‘å·¥å…·ï¼šè¾“å…¥ä»£å¸ä¸ spenderï¼Œè¯»å– allowanceï¼Œå¯é€šè¿‡ approve(spender, 0) æ’¤é”€ã€‚",
        ap_owner: "é’±åŒ…åœ°å€",
        ap_connected: "å·²è¿æ¥ï¼š",
        ap_connect: "è¿æ¥ / åˆ·æ–°",
        ap_spender_label: "Spender",
        ap_spender_tip: "ä¸ç¡®å®šçš„è¯ï¼šå…ˆé€‰ PancakeSwap Router é¢„è®¾ã€‚",
        ap_tokens_label: "ä»£å¸åˆ—è¡¨ï¼ˆæ¯è¡Œä¸€ä¸ªï¼‰",
        ap_check: "æ£€æŸ¥æˆæƒ",
        ap_revoke_all: "æ’¤é”€å…¨éƒ¨ï¼ˆéé›¶ï¼‰",
        ap_results: "æˆæƒç»“æœ",
        ap_results_hint: "è‹¥æˆæƒä¸ºâ€œæ— é™â€ï¼Œé™¤éå®Œå…¨ä¿¡ä»»ï¼Œå¦åˆ™å»ºè®®æ’¤é”€ã€‚",

        bm_kicker: "DEX Guard",
        bm_title: "ä¹¦ç­¾è„šæœ¬ï¼šä» DEX ä¸€é”®è·³è½¬æ‰«æ",
        bm_sub: "ä¿å­˜ä¹¦ç­¾ï¼Œä» DEX URL æå– token å‚æ•°å¹¶æ‰“å¼€æœ¬é¡µæ‰«æã€‚",
        bm_drag: "æ‹–åˆ°ä¹¦ç­¾æ ",
        bm_drag_tip: "æ¡Œé¢ç«¯ï¼šæŠŠæŒ‰é’®æ‹–åˆ°ä¹¦ç­¾æ å³å¯ã€‚",
        bm_note: "å½“ DEX URL å« outputCurrency / inputCurrencyï¼ˆæˆ–ç±»ä¼¼ï¼‰æ—¶æ•ˆæœæœ€ä½³ã€‚",
        bm_code: "ä¹¦ç­¾ä»£ç ",
        bm_code_tip: "è‹¥æµè§ˆå™¨é˜»æ­¢æ‹–æ‹½ï¼Œè¯·åˆ›å»ºä¹¦ç­¾å¹¶æŠŠä»¥ä¸‹å†…å®¹ç²˜è´´åˆ° URLï¼š",

        rpc_kicker: "RPC ä½“æ£€",
        rpc_title: "æ‰¾å‡ºæœ€å¿«å¯ç”¨çš„ BSC RPC",
        rpc_sub: "é€šè¿‡ ethers è°ƒç”¨ eth_blockNumber æµ‹é‡å»¶è¿Ÿï¼Œæœ€å¿«çš„ä¼šé«˜äº®ã€‚",
        rpc_list: "èŠ‚ç‚¹åˆ—è¡¨",
        rpc_custom_label: "å¯é€‰ï¼šè‡ªå®šä¹‰ RPC",
        rpc_test: "æµ‹è¯• RPC",
        rpc_copy_best: "å¤åˆ¶æœ€ä½³ RPC",
        rpc_results: "ç»“æœ",
        rpc_tip: "æç¤ºï¼šå¦‚æœæŸä¸ª RPC å›  CORS/è¶…æ—¶å¤±è´¥ï¼Œæ¢ä¸€ä¸ªå³å¯ï¼Œæˆ‘ä»¬ä¹Ÿä¼šè‡ªåŠ¨ fallbackã€‚",

        footer_left: "CycleX å®‰å…¨ä¸­å¿ƒåœ¨æœ¬åœ°è¿è¡Œï¼Œè¯»å–å…¬å¼€é“¾ä¸Šæ•°æ®ã€‚",
        footer_tagline: "å¤šéªŒè¯ä¸€æ¬¡ï¼Œåªåœ¨ä½ ä¿¡ä»»æ—¶è¿æ¥é’±åŒ…ã€‚"
      },
      ar: {
        brand_sub: "Ø£Ù…Ù† ÙˆÙ…ÙƒØ§ÙØ¢Øª Ø¹Ù„Ù‰ Ø§Ù„Ø³Ù„Ø³Ù„Ø©",
        hero_kicker: "Ù…Ø±ÙƒØ² Ø§Ù„Ø£Ù…Ø§Ù†",
        hero_title: "Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø£Ù…Ø§Ù† Ù…Ù† CycleX",
        hero_subtitle: "Ø£Ø¯ÙˆØ§Øª Ø®ÙÙŠÙØ© Ø¹Ù„Ù‰ Ø§Ù„Ù…ØªØµÙØ­: ÙØ­Øµ Ù‚Ø¨Ù„ Ø§Ù„Ø´Ø±Ø§Ø¡ØŒ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø§ØªØŒ Ø¥Ø¹Ø§Ø¯Ø© ØªÙˆØ¬ÙŠÙ‡ DEXØŒ ÙˆÙØ­Øµ RPC.",
        btn_back: "Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…ÙˆÙ‚Ø¹",
        btn_connect: "Ø§ØªØµØ§Ù„ Ø§Ù„Ù…Ø­ÙØ¸Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)",
        btn_run_all: "ÙØ­Øµ Ø³Ø±ÙŠØ¹",
        hero_note: "Ù…Ù„Ø§Ø­Ø¸Ø©: Ù‡Ø°Ù‡ Ø§Ù„ÙØ­ÙˆØµØ§Øª Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙŠØ© ÙˆÙ„Ø§ ØªØ¶Ù…Ù† Ø§Ù„Ø£Ù…Ø§Ù†. ØªØ­Ù‚Ù‚ Ø¯Ø§Ø¦Ù…Ø§Ù‹ Ø¨Ù†ÙØ³Ùƒ.",

        ss_kicker: "SafeSwap Gate",
        ss_title: "ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ø³Ø§Ø³ÙŠØ§Øª Ø§Ù„ØªÙˆÙƒÙ† Ù‚Ø¨Ù„ Ø§Ù„Ù…Ø¨Ø§Ø¯Ù„Ø©",
        ss_sub: "Ø£Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù† ØªÙˆÙƒÙ† Ø¹Ù„Ù‰ BSC ÙˆÙ†Ù‚Ø±Ø£ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„Ø¥Ø´Ø§Ø±Ø§Øª (owner/proxy) ÙˆØ³ÙŠÙˆÙ„Ø© Ù…ØªØ¹Ø¯Ø¯Ø© DEX ÙˆÙ†Ù†Ø´Ø¦ Ù…Ø®Ø±Ø¬Ø§Øª Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„Ù…Ø´Ø§Ø±ÙƒØ©.",
        ss_input_title: "Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØªÙˆÙƒÙ†",
        ss_token_label: "Ø¹Ù‚Ø¯ Ø§Ù„ØªÙˆÙƒÙ† (BSC)",
        ss_tip: "Ù†ØµÙŠØ­Ø©: Ø§ÙØªØ­ Ø§Ù„ØµÙØ­Ø© Ù…Ø¹ ?token=0x... ÙˆØ³ÙŠØ¨Ø¯Ø£ Ø§Ù„ÙØ­Øµ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹.",
        ss_actions_label: "Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª",
        ss_scan: "ÙØ­Øµ",
        ss_share: "Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©",
        ss_copy_json: "Ù†Ø³Ø® ØªÙ‚Ø±ÙŠØ± JSON",
        ss_options_label: "Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª",
        ss_require_liq: "Ø§Ø´ØªØ±Ø§Ø· Ø§Ù„Ø³ÙŠÙˆÙ„Ø© (ÙˆØ¶Ø¹ Ø§Ù„Ø¥Ù†ØªØ§Ø¬)",
        ss_require_liq_tip: "Ø¹Ù†Ø¯ Ø§Ù„ØªÙØ¹ÙŠÙ„: Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Pair ÙŠØµØ¨Ø­ Ø£Ø­Ù…Ø±. Ø¹Ù†Ø¯ Ø§Ù„ØªØ¹Ø·ÙŠÙ„: ÙŠÙØ¹ØªØ¨Ø± (ØºÙŠØ± Ù…ÙØ¯Ø±Ø¬ Ø¨Ø¹Ø¯).",
        ss_open_swap: "ÙØªØ­ Ø§Ù„Ù…Ø¨Ø§Ø¯Ù„Ø©",
        ss_results_title: "Ø§Ù„Ù†ØªØ§Ø¦Ø¬",
        ss_results_hint: "Ø¥Ø´Ø§Ø±Ø§Øª Ø£Ø®Ø¶Ø±/Ø£ØµÙØ±/Ø£Ø­Ù…Ø±. Ù‡Ø°Ø§ Ù„ÙŠØ³ Ø¶Ù…Ø§Ù†Ø§Ù‹ Ø¶Ø¯ honeypot â€” ÙÙ‚Ø· ÙØ­ÙˆØµØ§Øª Ø£Ø³Ø§Ø³ÙŠØ© Ø¹Ù„Ù‰ Ø§Ù„Ø³Ù„Ø³Ù„Ø©.",

        ap_kicker: "Ø­Ø§Ø±Ø³ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø§Øª",
        ap_title: "ÙØ­Øµ ÙˆØ¥Ù„ØºØ§Ø¡ Ø³Ù…Ø§Ø­ÙŠØ§Øª ERC-20",
        ap_sub: "Ø£Ø¯Ø§Ø© Ù…ÙˆØ¬Ù‡Ø©: ØªÙØ¯Ø®Ù„ Ø§Ù„ØªÙˆÙƒÙ†Ø§Øª ÙˆØ§Ù„Ù€ spender. Ù†Ù‚Ø±Ø£ allowance ÙˆÙŠÙ…ÙƒÙ† Ø§Ù„Ø¥Ù„ØºØ§Ø¡ Ø¹Ø¨Ø± approve(spender, 0).",
        ap_owner: "Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…Ø§Ù„Ùƒ",
        ap_connected: "Ù…ØªØµÙ„:",
        ap_connect: "Ø§ØªØµØ§Ù„ / ØªØ­Ø¯ÙŠØ«",
        ap_spender_label: "Spender",
        ap_spender_tip: "Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ù…ØªØ£ÙƒØ¯Ø§Ù‹: Ø§Ø¨Ø¯Ø£ Ø¨Ù…ÙØ³Ø¨Ù‚ PancakeSwap Router.",
        ap_tokens_label: "Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªÙˆÙƒÙ†Ø§Øª (ÙƒÙ„ Ø³Ø·Ø± ØªÙˆÙƒÙ†)",
        ap_check: "ÙØ­Øµ Ø§Ù„Ø³Ù…Ø§Ø­ÙŠØ§Øª",
        ap_revoke_all: "Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ÙƒÙ„ (ØºÙŠØ± ØµÙØ±)",
        ap_results: "Ø§Ù„Ø³Ù…Ø§Ø­ÙŠØ§Øª",
        ap_results_hint: "Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø³Ù…Ø§Ø­ÙŠØ© â€œÙ„Ø§ Ù†Ù‡Ø§Ø¦ÙŠØ©â€ØŒ ÙŠÙˆØµÙ‰ Ø¨Ø§Ù„Ø¥Ù„ØºØ§Ø¡ Ø¥Ù„Ø§ Ø¥Ø°Ø§ ÙƒÙ†Øª ØªØ«Ù‚ ØªÙ…Ø§Ù…Ø§Ù‹ Ø¨Ø§Ù„Ù€ spender.",

        bm_kicker: "DEX Guard",
        bm_title: "Bookmarklet Ù„Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù„Ù„ÙØ­Øµ",
        bm_sub: "Ø§Ø­ÙØ¸ Bookmark ÙŠØ³ØªØ®Ø±Ø¬ Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„ØªÙˆÙƒÙ† Ù…Ù† ØµÙØ­Ø§Øª DEX ÙˆÙŠÙØªØ­ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø±ÙƒØ² Ù…Ø¹ ?token=.",
        bm_drag: "Ø§Ø³Ø­Ø¨ Ø¥Ù„Ù‰ Ø´Ø±ÙŠØ· Ø§Ù„Ù…ÙØ¶Ù„Ø©",
        bm_drag_tip: "Ø¹Ù„Ù‰ Ø³Ø·Ø­ Ø§Ù„Ù…ÙƒØªØ¨: Ø§Ø³Ø­Ø¨ Ø§Ù„Ø²Ø± Ø¥Ù„Ù‰ Ø´Ø±ÙŠØ· Ø§Ù„Ù…ÙØ¶Ù„Ø©.",
        bm_note: "ÙŠØ¹Ù…Ù„ Ø£ÙØ¶Ù„ Ø¹Ù†Ø¯Ù…Ø§ ÙŠØ­ØªÙˆÙŠ Ø§Ù„Ø±Ø§Ø¨Ø· Ø¹Ù„Ù‰ outputCurrency / inputCurrency (Ø£Ùˆ Ù…Ø§ Ø´Ø§Ø¨Ù‡).",
        bm_code: "ÙƒÙˆØ¯ Ø§Ù„Ù€ Bookmarklet",
        bm_code_tip: "Ø¥Ø°Ø§ Ù…Ù†Ø¹ Ø§Ù„Ù…ØªØµÙØ­ Ø§Ù„Ø³Ø­Ø¨ØŒ Ø£Ù†Ø´Ø¦ Bookmark ÙˆØ§Ù„ØµÙ‚ Ù‡Ø°Ø§ ÙÙŠ Ø®Ø§Ù†Ø© URL:",

        rpc_kicker: "ÙØ­Øµ RPC",
        rpc_title: "Ø§Ø¹Ø«Ø± Ø¹Ù„Ù‰ Ø£Ø³Ø±Ø¹ RPC ÙŠØ¹Ù…Ù„ Ø¹Ù„Ù‰ BSC",
        rpc_sub: "Ù†Ù‚ÙŠØ³ Ø²Ù…Ù† Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ø¹Ø¨Ø± ethers Ùˆ eth_blockNumber. Ø§Ù„Ø£Ø³Ø±Ø¹ Ø³ÙŠØ¸Ù‡Ø± Ù…Ù…ÙŠØ²Ø§Ù‹.",
        rpc_list: "Ø§Ù„Ù†Ù‚Ø§Ø·",
        rpc_custom_label: "Ø§Ø®ØªÙŠØ§Ø±ÙŠ: RPC Ù…Ø®ØµØµ",
        rpc_test: "Ø§Ø®ØªØ¨Ø§Ø± RPC",
        rpc_copy_best: "Ù†Ø³Ø® Ø£ÙØ¶Ù„ RPC",
        rpc_results: "Ø§Ù„Ù†ØªØ§Ø¦Ø¬",
        rpc_tip: "Ù†ØµÙŠØ­Ø©: Ø¥Ø°Ø§ ÙØ´Ù„ RPC Ø¨Ø³Ø¨Ø¨ CORS/timeout Ø¬Ø±Ù‘Ø¨ ØºÙŠØ±Ù‡ â€” Ù„Ø¯ÙŠÙ†Ø§ fallback Ø£ÙŠØ¶Ø§Ù‹.",

        footer_left: "Ù…Ø±ÙƒØ² Ø£Ù…Ø§Ù† CycleX ÙŠØ¹Ù…Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ù…ØªØµÙØ­ ÙˆÙŠÙ‚Ø±Ø£ Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ø§Ù…Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø³Ù„Ø³Ù„Ø©.",
        footer_tagline: "ØªØ­Ù‚Ù‚ Ù…Ø±ØªÙŠÙ†. Ù„Ø§ ØªØªØµÙ„ Ø¥Ù„Ø§ Ø¥Ø°Ø§ ÙƒÙ†Øª ØªØ«Ù‚ Ø¨Ø§Ù„ØµÙØ­Ø©."
      },
      ru: {
        brand_sub: "ĞĞ½Ñ‡ĞµĞ¹Ğ½-Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ Ğ¸ Ğ²Ğ¾Ğ·Ğ½Ğ°Ğ³Ñ€Ğ°Ğ¶Ğ´ĞµĞ½Ğ¸Ñ",
        hero_kicker: "Ğ¦ĞµĞ½Ñ‚Ñ€ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚Ğ¸",
        hero_title: "Ğ˜Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ñ‹ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚Ğ¸ CycleX",
        hero_subtitle: "Ğ›Ñ‘Ğ³ĞºĞ¸Ğ¹ Ğ½Ğ°Ğ±Ğ¾Ñ€ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ğ¾Ğ² Ğ² Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€Ğµ: Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¿ĞµÑ€ĞµĞ´ ÑĞ²Ğ¾Ğ¿Ğ¾Ğ¼, Ğ³Ğ¸Ğ³Ğ¸ĞµĞ½Ğ° approvals, DEX-Ñ€ĞµĞ´Ğ¸Ñ€ĞµĞºÑ‚ Ğ¸ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° RPC.",
        btn_back: "ĞĞ°Ğ·Ğ°Ğ´ Ğ½Ğ° ÑĞ°Ğ¹Ñ‚",
        btn_connect: "ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ ĞºĞ¾ÑˆĞµĞ»Ñ‘Ğº (Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾)",
        btn_run_all: "Ğ‘Ñ‹ÑÑ‚Ñ€Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ°",
        hero_note: "ĞŸÑ€Ğ¸Ğ¼ĞµÑ‡Ğ°Ğ½Ğ¸Ğµ: Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸ Ğ½Ğ¾ÑÑÑ‚ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ½Ñ‹Ğ¹ Ñ…Ğ°Ñ€Ğ°ĞºÑ‚ĞµÑ€ Ğ¸ Ğ½Ğµ Ğ³Ğ°Ñ€Ğ°Ğ½Ñ‚Ğ¸Ñ€ÑƒÑÑ‚ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ. Ğ’ÑĞµĞ³Ğ´Ğ° Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑĞ¹Ñ‚Ğµ Ğ´Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾.",

        ss_kicker: "SafeSwap Gate",
        ss_title: "ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒ Ñ‚Ğ¾ĞºĞµĞ½ Ğ¿ĞµÑ€ĞµĞ´ ÑĞ²Ğ¾Ğ¿Ğ¾Ğ¼",
        ss_sub: "Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ°Ğ´Ñ€ĞµÑ Ñ‚Ğ¾ĞºĞµĞ½Ğ° Ğ² BSC. ĞœÑ‹ Ğ¿Ñ€Ğ¾Ñ‡Ğ¸Ñ‚Ğ°ĞµĞ¼ on-chain Ğ¼ĞµÑ‚Ğ°Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ, owner/proxy Ğ¿Ğ¾Ğ´ÑĞºĞ°Ğ·ĞºĞ¸ Ğ¸ ÑĞ¸Ğ³Ğ½Ğ°Ğ»Ñ‹ Ğ»Ğ¸ĞºĞ²Ğ¸Ğ´Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ² Ğ½ĞµÑĞºĞ¾Ğ»ÑŒĞºĞ¸Ñ… DEX â€” Ğ¸ Ğ¿Ğ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ¸Ğ¼ ÑƒĞ´Ğ¾Ğ±Ğ½Ñ‹Ğµ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹.",
        ss_input_title: "ĞĞ´Ñ€ĞµÑ Ñ‚Ğ¾ĞºĞµĞ½Ğ°",
        ss_token_label: "ĞšĞ¾Ğ½Ñ‚Ñ€Ğ°ĞºÑ‚ Ñ‚Ğ¾ĞºĞµĞ½Ğ° (BSC)",
        ss_tip: "Ğ¡Ğ¾Ğ²ĞµÑ‚: Ğ¾Ñ‚ĞºÑ€Ğ¾Ğ¹ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ñƒ Ñ ?token=0x... Ğ¸ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ·Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑÑ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸.",
        ss_actions_label: "Ğ”ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ",
        ss_scan: "Ğ¡ĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ",
        ss_share: "ĞšĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ ÑÑÑ‹Ğ»ĞºÑƒ",
        ss_copy_json: "ĞšĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ JSON Ğ¾Ñ‚Ñ‡Ñ‘Ñ‚",
        ss_options_label: "ĞĞ¿Ñ†Ğ¸Ğ¸",
        ss_require_liq: "Ğ¢Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ»Ğ¸ĞºĞ²Ğ¸Ğ´Ğ½Ğ¾ÑÑ‚ÑŒ (production)",
        ss_require_liq_tip: "Ğ’ĞºĞ».: Ğ¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ğ²Ğ¸Ğµ Pair ÑÑ‚Ğ°Ğ½ĞµÑ‚ ĞºÑ€Ğ°ÑĞ½Ñ‹Ğ¼. Ğ’Ñ‹ĞºĞ».: ÑÑ‚Ğ¾ â€œĞµÑ‰Ñ‘ Ğ½Ğµ Ğ·Ğ°Ğ»Ğ¸ÑÑ‚Ğ¸Ğ»Ğ¸â€.",
        ss_open_swap: "ĞÑ‚ĞºÑ€Ñ‹Ñ‚ÑŒ ÑĞ²Ğ¾Ğ¿",
        ss_results_title: "Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹",
        ss_results_hint: "Ğ¡Ğ¸Ğ³Ğ½Ğ°Ğ»Ñ‹: Ğ·ĞµĞ»Ñ‘Ğ½Ñ‹Ğ¹/Ğ¶Ñ‘Ğ»Ñ‚Ñ‹Ğ¹/ĞºÑ€Ğ°ÑĞ½Ñ‹Ğ¹. Ğ­Ñ‚Ğ¾ Ğ½Ğµ Ğ³Ğ°Ñ€Ğ°Ğ½Ñ‚Ğ¸Ñ Ğ¾Ñ‚ honeypot â€” Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ±Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğµ on-chain Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸.",

        ap_kicker: "Approvals Guardian",
        ap_title: "ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¸ Ğ¾Ñ‚Ğ·Ñ‹Ğ² ERC-20 Ñ€Ğ°Ğ·Ñ€ĞµÑˆĞµĞ½Ğ¸Ğ¹",
        ap_sub: "Ğ¢Ğ¾Ñ‡ĞµÑ‡Ğ½Ñ‹Ğ¹ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚: Ğ²Ñ‹ Ğ·Ğ°Ğ´Ğ°Ñ‘Ñ‚Ğµ Ñ‚Ğ¾ĞºĞµĞ½Ñ‹ Ğ¸ spender. ĞœÑ‹ Ñ‡Ğ¸Ñ‚Ğ°ĞµĞ¼ allowance Ğ¸ Ğ¼Ğ¾Ğ¶ĞµĞ¼ Ğ¾Ñ‚Ğ¾Ğ·Ğ²Ğ°Ñ‚ÑŒ Ñ‡ĞµÑ€ĞµĞ· approve(spender, 0).",
        ap_owner: "ĞšĞ¾ÑˆĞµĞ»Ñ‘Ğº Ğ²Ğ»Ğ°Ğ´ĞµĞ»ÑŒÑ†Ğ°",
        ap_connected: "ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¾:",
        ap_connect: "ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ / Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ",
        ap_spender_label: "Spender",
        ap_spender_tip: "Ğ•ÑĞ»Ğ¸ Ğ½Ğµ ÑƒĞ²ĞµÑ€ĞµĞ½Ñ‹: Ğ½Ğ°Ñ‡Ğ½Ğ¸Ñ‚Ğµ Ñ Ğ¿Ñ€ĞµÑĞµÑ‚Ğ° PancakeSwap Router.",
        ap_tokens_label: "Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ñ‚Ğ¾ĞºĞµĞ½Ğ¾Ğ² (Ğ¿Ğ¾ Ğ¾Ğ´Ğ½Ğ¾Ğ¼Ñƒ Ğ² ÑÑ‚Ñ€Ğ¾ĞºĞµ)",
        ap_check: "ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ allowance",
        ap_revoke_all: "ĞÑ‚Ğ¾Ğ·Ğ²Ğ°Ñ‚ÑŒ Ğ²ÑĞµ (Ğ½ĞµĞ½ÑƒĞ»ĞµĞ²Ñ‹Ğµ)",
        ap_results: "Allowances",
        ap_results_hint: "Ğ•ÑĞ»Ğ¸ allowance â€œĞ±ĞµÑĞºĞ¾Ğ½ĞµÑ‡Ğ½Ñ‹Ğ¹â€, Ğ¾Ñ‚Ğ·Ñ‹Ğ² Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµÑ‚ÑÑ, ĞµÑĞ»Ğ¸ Ğ²Ñ‹ Ğ½Ğµ Ğ´Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚Ğµ spender Ğ½Ğ° 100%.",

        bm_kicker: "DEX Guard",
        bm_title: "Bookmarklet: Ñ€ĞµĞ´Ğ¸Ñ€ĞµĞºÑ‚ Ğ½Ğ° Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºÑƒ",
        bm_sub: "Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚Ğµ Ğ·Ğ°ĞºĞ»Ğ°Ğ´ĞºÑƒ, ĞºĞ¾Ñ‚Ğ¾Ñ€Ğ°Ñ Ğ²Ñ‹Ñ‚Ğ°ÑĞºĞ¸Ğ²Ğ°ĞµÑ‚ token-Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹ Ğ¸Ğ· DEX URL Ğ¸ Ğ¾Ñ‚ĞºÑ€Ñ‹Ğ²Ğ°ĞµÑ‚ ÑÑ‚Ğ¾Ñ‚ Ñ†ĞµĞ½Ñ‚Ñ€ Ñ ?token=.",
        bm_drag: "ĞŸĞµÑ€ĞµÑ‚Ğ°Ñ‰Ğ¸Ñ‚Ğµ Ğ² Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ Ğ·Ğ°ĞºĞ»Ğ°Ğ´Ğ¾Ğº",
        bm_drag_tip: "ĞĞ° Ğ´ĞµÑĞºÑ‚Ğ¾Ğ¿Ğµ: Ğ¿ĞµÑ€ĞµÑ‚Ğ°Ñ‰Ğ¸Ñ‚Ğµ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ Ğ² Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ Ğ·Ğ°ĞºĞ»Ğ°Ğ´Ğ¾Ğº.",
        bm_note: "Ğ›ÑƒÑ‡ÑˆĞµ Ğ²ÑĞµĞ³Ğ¾ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚, ĞµÑĞ»Ğ¸ URL ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ñ‚ outputCurrency / inputCurrency (Ğ¸Ğ»Ğ¸ Ğ¿Ğ¾Ğ´Ğ¾Ğ±Ğ½Ğ¾Ğµ).",
        bm_code: "ĞšĞ¾Ğ´ bookmarklet",
        bm_code_tip: "Ğ•ÑĞ»Ğ¸ Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€ Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€ÑƒĞµÑ‚ drag&drop â€” ÑĞ¾Ğ·Ğ´Ğ°Ğ¹Ñ‚Ğµ Ğ·Ğ°ĞºĞ»Ğ°Ğ´ĞºÑƒ Ğ¸ Ğ²ÑÑ‚Ğ°Ğ²ÑŒÑ‚Ğµ ÑÑ‚Ğ¾ Ğ² Ğ¿Ğ¾Ğ»Ğµ URL:",

        rpc_kicker: "RPC Checker",
        rpc_title: "ĞĞ°Ğ¹Ğ´Ğ¸Ñ‚Ğµ ÑĞ°Ğ¼Ñ‹Ğ¹ Ğ±Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ RPC Ğ´Ğ»Ñ BSC",
        rpc_sub: "Ğ˜Ğ·Ğ¼ĞµÑ€ÑĞµĞ¼ Ğ·Ğ°Ğ´ĞµÑ€Ğ¶ĞºÑƒ Ñ‡ĞµÑ€ĞµĞ· ethers Ğ¸ eth_blockNumber. Ğ¡Ğ°Ğ¼Ñ‹Ğ¹ Ğ±Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ Ğ±ÑƒĞ´ĞµÑ‚ Ğ¿Ğ¾Ğ´ÑĞ²ĞµÑ‡ĞµĞ½.",
        rpc_list: "Ğ­Ğ½Ğ´Ğ¿Ğ¾Ğ¸Ğ½Ñ‚Ñ‹",
        rpc_custom_label: "ĞĞ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾: ÑĞ²Ğ¾Ğ¹ RPC",
        rpc_test: "Ğ¢ĞµÑÑ‚ RPC",
        rpc_copy_best: "Ğ¡ĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ»ÑƒÑ‡ÑˆĞ¸Ğ¹ RPC",
        rpc_results: "Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹",
        rpc_tip: "Ğ¡Ğ¾Ğ²ĞµÑ‚: ĞµÑĞ»Ğ¸ RPC Ğ¿Ğ°Ğ´Ğ°ĞµÑ‚ Ğ¸Ğ·-Ğ·Ğ° CORS/timeout â€” Ğ²Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ğ´Ñ€ÑƒĞ³Ğ¾Ğ¹, Ñƒ Ğ½Ğ°Ñ Ñ‚Ğ°ĞºĞ¶Ğµ ĞµÑÑ‚ÑŒ fallback.",

        footer_left: "CycleX Security Hub Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ğ½Ğ° ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ğµ Ğ¸ Ñ‡Ğ¸Ñ‚Ğ°ĞµÑ‚ Ğ¿ÑƒĞ±Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ğµ on-chain Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ.",
        footer_tagline: "ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞ¹Ñ‚Ğµ Ğ´Ğ²Ğ°Ğ¶Ğ´Ñ‹. ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡Ğ°Ğ¹Ñ‚Ğµ ĞºĞ¾ÑˆĞµĞ»Ñ‘Ğº Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ ĞµÑĞ»Ğ¸ Ğ´Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚Ğµ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğµ."
      }
    };

    function setLanguage(lang) {
      const dict = translations[lang] || translations.en;

      document.body.classList.add("lang-switching");

      document.querySelectorAll("[data-i18n]").forEach((el) => {
        const key = el.getAttribute("data-i18n");
        const val = (dict[key] !== undefined) ? dict[key] : translations.en[key];
        if (val !== undefined) el.innerHTML = val;
      });

      document.querySelectorAll(".lang-btn").forEach((btn) => {
        btn.classList.toggle("active", btn.getAttribute("data-lang") === lang);
      });

      document.documentElement.dir = (lang === "ar") ? "rtl" : "ltr";
      setTimeout(() => document.body.classList.remove("lang-switching"), 250);
    }

    document.querySelectorAll(".lang-btn").forEach((btn) => {
      btn.addEventListener("click", () => setLanguage(btn.getAttribute("data-lang")));
    });
    setLanguage("en");

    // ====== Shared helpers ======
    const CX_DEBUG = false;
    function cxlog(...a){ if(CX_DEBUG) console.log(...a); }

    const RPCS_DEFAULT = [
      "https://bsc-dataseed.binance.org",
      "https://bsc-dataseed1.bnbchain.org",
      "https://bsc-dataseed2.bnbchain.org",
      "https://bsc-dataseed3.bnbchain.org",
      "https://bsc-dataseed1.defibit.io",
    ];

    // Core tokens (BSC)
    const WBNB = "0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c";
    const USDT = "0x55d398326f99059fF775485246999027B3197955";
    const USDC = "0x8AC76a51cc950d9822D68b83fE1Ad97B32Cd580d";
    const BUSD = "0xe9e7CEA3DedcA5984780Bafc599bD69ADd087D56";

    // DEX Routers (BSC)
    const DEXES = [
      {
        key: "pancake",
        name: "PancakeSwap V2",
        router: "0x10ED43C718714eb63d5aA57B78B54704E256024E",
        swap: (tokenIn, tokenOut) => `https://pancakeswap.finance/swap?inputCurrency=${tokenIn}&outputCurrency=${tokenOut}`
      },
      {
        key: "apeswap",
        name: "ApeSwap",
        router: "0xC0788A3aD43d79aa53B09c2EaCc313A787d1d607",
        swap: (tokenIn, tokenOut) => `https://apeswap.finance/swap?inputCurrency=${tokenIn}&outputCurrency=${tokenOut}`
      },
      {
        key: "biswap",
        name: "BiSwap",
        router: "0xE97E2787C9C8d63bFF482Fa3fdc212BbD547aE98",
        swap: (tokenIn, tokenOut) => `https://exchange.biswap.org/#/swap?inputCurrency=${tokenIn}&outputCurrency=${tokenOut}`
      },
      {
        key: "mdex",
        name: "MDEX (BSC)",
        router: "0x7DAe51BD3E3376B8c7c4900E9107f12Be3AF1bA8",
        swap: (tokenIn, tokenOut) => `https://bscr.mdex.com/#/swap?inputCurrency=${tokenIn}&outputCurrency=${tokenOut}`
      },
      {
        key: "bakery",
        name: "BakerySwap",
        router: "0x824C9364A6CF8f5EB542ad2ca8F5705561C8b1db",
        swap: (tokenIn, tokenOut) => `https://www.bakeryswap.org/#/swap?inputCurrency=${tokenIn}&outputCurrency=${tokenOut}`
      },
      {
        key: "babyswap",
        name: "BabySwap",
        router: "0xC085fDA7Dc3c1A1611f3Ae421e2BD3c75b3a6943",
        swap: (tokenIn, tokenOut) => `https://exchange.babyswap.finance/#/swap?inputCurrency=${tokenIn}&outputCurrency=${tokenOut}`
      }
    ];

    const BASES = [
      { key: "WBNB", name: "WBNB", addr: WBNB, kind: "bnb" },
      { key: "USDT", name: "USDT", addr: USDT, kind: "stable" },
      { key: "USDC", name: "USDC", addr: USDC, kind: "stable" },
      { key: "BUSD", name: "BUSD", addr: BUSD, kind: "stable" }
    ];

    // Pancake factory (fallback price)
    const PCS_FACTORY = "0xca143ce32fe78f1f7019d7d551a6402fc5350c73";
    // Chainlink BNB/USD feed on BSC
    const CHAINLINK_BNBUSD = "0x0567F2323251f0Aab15c8DfB1967E4e8A7D42aeE";

    let _rpcProvider = null;
    let _rpcUrl = "";
    let _bestRpc = "";
    let ssLastReport = null;

    function sleep(ms){ return new Promise(r => setTimeout(r, ms)); }

    async function pickProvider(customList) {
      if (_rpcProvider) return _rpcProvider;

      const list = Array.isArray(customList) && customList.length ? customList : RPCS_DEFAULT;

      for (const url of list) {
        try {
          const p = new ethers.JsonRpcProvider(url);
          const bn = await p.getBlockNumber();
          const net = await p.getNetwork();
          if (Number(net.chainId) !== 56) throw new Error("Wrong chainId");

          _rpcProvider = p;
          _rpcUrl = url;
          cxlog("âœ… RPC:", url, "block:", bn);
          return p;
        } catch (e) {
          cxlog("âš ï¸ RPC fail:", url, e?.message || e);
        }
      }
      throw new Error("All RPCs failed");
    }

    function isHexAddr(x){ return typeof x === "string" && /^0x[0-9a-fA-F]{40}$/.test(x.trim()); }
    function toChecksum(x){ return ethers.getAddress(x.trim()); }

    async function copyText(text){
      try {
        await navigator.clipboard.writeText(text);
        return true;
      } catch {
        const ta = document.createElement("textarea");
        ta.value = text;
        document.body.appendChild(ta);
        ta.select();
        document.execCommand("copy");
        ta.remove();
        return true;
      }
    }

    function setStatus(el, kind, html){
      el.className = "status " + (kind || "info");
      el.innerHTML = html || "";
      el.style.display = "block";
    }

    function fmtAddr(a){
      try {
        const x = toChecksum(a);
        return x.slice(0, 6) + "â€¦" + x.slice(-4);
      } catch { return a; }
    }

    function fmtBigintUnits(v, decimals){
      try {
        const s = ethers.formatUnits(v, decimals);
        const [i, f=""] = s.split(".");
        const intWithCommas = i.replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        const ff = f.slice(0, 6).replace(/0+$/, "");
        return intWithCommas + (ff ? "." + ff : "");
      } catch {
        return String(v);
      }
    }

    function fmtUsd(x){
      if (!Number.isFinite(x)) return "â€”";
      if (x >= 1_000_000_000) return "$" + (x/1_000_000_000).toFixed(2) + "B";
      if (x >= 1_000_000) return "$" + (x/1_000_000).toFixed(2) + "M";
      if (x >= 1_000) return "$" + (x/1_000).toFixed(2) + "K";
      return "$" + x.toFixed(2);
    }

    // ====== ABIs ======
    const ERC20_ABI = [
      "function name() view returns (string)",
      "function symbol() view returns (string)",
      "function decimals() view returns (uint8)",
      "function totalSupply() view returns (uint256)",
      "function owner() view returns (address)",
      "function getOwner() view returns (address)",
      "function admin() view returns (address)",
    ];

    const FACTORY_ABI = [
      "function getPair(address tokenA, address tokenB) external view returns (address pair)"
    ];

    const ROUTER_ABI = [
      "function factory() view returns (address)",
      "function WETH() view returns (address)"
    ];

    const PAIR_ABI = [
      "function token0() view returns (address)",
      "function token1() view returns (address)",
      "function getReserves() view returns (uint112 reserve0, uint112 reserve1, uint32 blockTimestampLast)"
    ];

    const LP_ABI = [
      "function totalSupply() view returns (uint256)",
      "function balanceOf(address) view returns (uint256)"
    ];

    const CL_ABI = [
      "function decimals() view returns (uint8)",
      "function latestRoundData() view returns (uint80,int256,uint256,uint256,uint80)"
    ];

    // ====== Proxy detection (EIP-1967) ======
    const EIP1967_IMPL_SLOT = "0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc";
    const EIP1967_ADMIN_SLOT = "0xb53127684a568b3173ae13b9f8a6016e243e63b6e8ee1178d6a717850b5d6103";

    function slotToAddress(storageHex){
      if (!storageHex || storageHex === "0x") return null;
      const h = storageHex.toLowerCase().replace(/^0x/,"").padStart(64,"0");
      const addr = "0x" + h.slice(24);
      if (/^0x0{40}$/.test(addr)) return null;
      try { return toChecksum(addr); } catch { return null; }
    }

    async function detectProxy(provider, token){
      try {
        const implRaw = await provider.getStorage(token, EIP1967_IMPL_SLOT);
        const impl = slotToAddress(implRaw);
        const adminRaw = await provider.getStorage(token, EIP1967_ADMIN_SLOT);
        const admin = slotToAddress(adminRaw);
        if (impl) return { isProxy: true, impl, admin };
        return { isProxy: false, impl: null, admin: admin || null };
      } catch {
        return { isProxy: false, impl: null, admin: null };
      }
    }

    // ====== BNB/USD oracle (Chainlink + fallback) ======
    let _bnbUsdCache = null;

    async function getBnbUsd(provider){
      if (_bnbUsdCache && (Date.now() - _bnbUsdCache.t) < 60_000) return _bnbUsdCache;

      // 1) Chainlink
      try {
        const feed = new ethers.Contract(CHAINLINK_BNBUSD, CL_ABI, provider);
        const dec = Number(await feed.decimals());
        const rd = await feed.latestRoundData();
        const ans = Number(rd[1]);
        if (Number.isFinite(ans) && ans > 0) {
          const px = ans / (10 ** dec);
          _bnbUsdCache = { px, source: "Chainlink", t: Date.now() };
          return _bnbUsdCache;
        }
      } catch {}

      // 2) Fallback: WBNB/USDT reserves on Pancake factory
      try {
        const f = new ethers.Contract(PCS_FACTORY, FACTORY_ABI, provider);
        let pair = await f.getPair(WBNB, USDT);
        pair = toChecksum(String(pair));
        if (pair && !/^0x0{40}$/i.test(pair)) {
          const p = new ethers.Contract(pair, PAIR_ABI, provider);
          const t0 = toChecksum(await p.token0());
          const r = await p.getReserves();
          const r0 = BigInt(r[0]);
          const r1 = BigInt(r[1]);

          const wbnbRes = (t0 === toChecksum(WBNB)) ? r0 : r1;
          const usdtRes = (t0 === toChecksum(WBNB)) ? r1 : r0;

          const wbnbF = Number(ethers.formatUnits(wbnbRes, 18));
          const usdtF = Number(ethers.formatUnits(usdtRes, 18));
          if (wbnbF > 0 && usdtF > 0) {
            const px = usdtF / wbnbF;
            _bnbUsdCache = { px, source: "On-chain (WBNB/USDT)", t: Date.now() };
            return _bnbUsdCache;
          }
        }
      } catch {}

      _bnbUsdCache = { px: NaN, source: "Unavailable", t: Date.now() };
      return _bnbUsdCache;
    }

    // ====== UI init for dropdowns ======
    function initDexBaseDropdowns(){
      const dexSel = document.getElementById("ss-dex-select");
      const baseSel = document.getElementById("ss-base-select");
      if (!dexSel || !baseSel) return;

      dexSel.innerHTML = DEXES.map(d => `<option value="${d.key}">${d.name}</option>`).join("");
      baseSel.innerHTML = BASES.map(b => `<option value="${b.key}">${b.name}</option>`).join("");

      dexSel.value = "pancake";
      baseSel.value = "WBNB";
    }

    // ====== SafeSwap scan ======
    async function getDexFactory(provider, dex){
      try {
        const r = new ethers.Contract(dex.router, ROUTER_ABI, provider);
        const f = await r.factory();
        return toChecksum(String(f));
      } catch {
        return null;
      }
    }

    async function scanOnePair(provider, token, base, dex, factoryAddr){
      if (!factoryAddr) return null;

      try {
        const f = new ethers.Contract(factoryAddr, FACTORY_ABI, provider);
        let pair = await f.getPair(token, base.addr);
        pair = toChecksum(String(pair));
        if (/^0x0{40}$/i.test(pair)) return null;

        const p = new ethers.Contract(pair, PAIR_ABI, provider);
        const t0 = toChecksum(await p.token0());
        const r = await p.getReserves();
        const r0 = BigInt(r[0]);
        const r1 = BigInt(r[1]);

        const baseRes = (t0 === toChecksum(base.addr)) ? r0 : r1;
        const tokenRes = (t0 === toChecksum(base.addr)) ? r1 : r0;

        let burnPct = null;
        try {
          const lp = new ethers.Contract(pair, LP_ABI, provider);
          const ts = BigInt(await lp.totalSupply());
          if (ts > 0n) {
            const z = BigInt(await lp.balanceOf("0x0000000000000000000000000000000000000000"));
            const d = BigInt(await lp.balanceOf("0x000000000000000000000000000000000000dEaD"));
            const burned = z + d;
            burnPct = Number((burned * 10000n) / ts) / 100;
          }
        } catch {}

        return {
          dexKey: dex.key,
          dexName: dex.name,
          router: dex.router,
          factory: factoryAddr,
          baseKey: base.key,
          baseName: base.name,
          baseAddr: base.addr,
          pair,
          baseReserve: baseRes,
          tokenReserve: tokenRes,
          burnPct
        };
      } catch {
        return null;
      }
    }

    function ssBuildShareLink(paramsObj){
      const u = new URL(window.location.href);
      ["token","tokenIn","tokenOut","requireLiq","dex","base"].forEach(k => u.searchParams.delete(k));

      if (paramsObj?.token) u.searchParams.set("token", paramsObj.token);
      if (paramsObj?.tokenIn) u.searchParams.set("tokenIn", paramsObj.tokenIn);
      if (paramsObj?.requireLiq) u.searchParams.set("requireLiq", "1");
      return u.toString();
    }

    function ssRenderLinks(pairs, token, tokenInHint){
      const wrap = document.getElementById("ss-links");
      if (!wrap) return;

      if (!pairs?.length) {
        wrap.innerHTML = "";
        return;
      }

      const best = pairs[0];
      const tokenIn = tokenInHint && isHexAddr(tokenInHint) ? toChecksum(tokenInHint) : best.baseAddr;

      const btns = pairs.slice(0, 6).map(p => {
        const dex = DEXES.find(d => d.key === p.dexKey);
        const url = dex ? dex.swap(tokenIn, token) : "#";
        const liq = (p.liqUsdApprox != null) ? fmtUsd(p.liqUsdApprox) : "â€”";
        const burn = (p.burnPct != null) ? `${p.burnPct.toFixed(2)}%` : "â€”";
        return `
          <div class="card" style="padding:12px; margin-top:10px;">
            <div class="row" style="justify-content:space-between; gap:8px;">
              <div class="pill"><b>${p.dexName}</b> â€¢ ${p.baseName}</div>
              <a class="btn btn-ghost" href="${url}" target="_blank" rel="noopener" style="padding:10px 14px; font-size:12px;">Open Swap</a>
            </div>
            <div class="small" style="margin-top:8px">
              <b>Pair:</b> <span class="mono">${p.pair}</span><br>
              <b>Liquidity (approx):</b> ${liq}<br>
              <b>LP Burn:</b> ${burn}
            </div>
          </div>
        `;
      }).join("");

      wrap.innerHTML = btns;
    }

    async function ssScanV2() {
      const input = document.getElementById("ss-token");
      const out = document.getElementById("ss-out");
      const status = document.getElementById("ss-status");
      const requireLiqEl = document.getElementById("ss-require-liq");

      if (!input || !out || !status || !requireLiqEl) return;

      const requireLiq = !!requireLiqEl.checked;

      let addrRaw = (input.value || "").trim();
      if (!addrRaw) {
        setStatus(status, "warn", "<strong>âš ï¸ Missing token address.</strong><br>Paste a token and try again.");
        return;
      }
      if (!isHexAddr(addrRaw)) {
        setStatus(status, "bad", "<strong>âŒ Invalid address format.</strong><br>Expected 0x + 40 hex chars.");
        return;
      }
      const token = toChecksum(addrRaw);

      let tokenInHint = null;
      try {
        const u = new URL(window.location.href);
        const ti = u.searchParams.get("tokenIn");
        if (ti && isHexAddr(ti)) tokenInHint = toChecksum(ti);
      } catch {}

      const pcs = document.getElementById("ss-pcs");
      const bsc = document.getElementById("ss-bsc");
      if (pcs) pcs.href = `https://pancakeswap.finance/swap?outputCurrency=${token}`;
      if (bsc) bsc.href = `https://bscscan.com/address/${token}`;

      setStatus(status, "info", "<strong>â³ Scanningâ€¦</strong><br>Reading metadata, proxy/owner hints, and multi-DEX liquidity.");
      setStatus(out, "info", "<strong>â³ Workingâ€¦</strong>");
      const linksWrap = document.getElementById("ss-links");
      if (linksWrap) linksWrap.innerHTML = "";
      ssLastReport = null;

      try {
        const provider = await pickProvider();

        const code = await provider.getCode(token);
        const isContract = code && code !== "0x";
        if (!isContract) {
          setStatus(out, "bad", `<strong>âŒ Not a contract.</strong><br>${token} has no bytecode on BSC.`);
          setStatus(status, "bad", "<strong>âŒ Scan finished:</strong> address is not a token contract.");
          return;
        }

        const c = new ethers.Contract(token, ERC20_ABI, provider);

        let name = "â€”", symbol = "â€”", decimals = 18, supply = 0n;
        try { name = await c.name(); } catch {}
        try { symbol = await c.symbol(); } catch {}
        try { decimals = Number(await c.decimals()); } catch { decimals = 18; }
        try { supply = BigInt(await c.totalSupply()); } catch { supply = 0n; }

        let owner = null;
        for (const fn of ["owner", "getOwner", "admin"]) {
          try {
            const o = await c[fn]();
            if (o && isHexAddr(String(o))) { owner = toChecksum(String(o)); break; }
          } catch {}
        }
        const ownerRenounced = owner ? (owner === "0x0000000000000000000000000000000000000000") : null;

        const proxy = await detectProxy(provider, token);

        const bnbUsd = await getBnbUsd(provider);
        const pairsFound = [];

        for (const dex of DEXES) {
          if (!isHexAddr(dex.router)) continue;
          const factory = await getDexFactory(provider, dex);
          if (!factory) continue;

          for (const base of BASES) {
            const res = await scanOnePair(provider, token, base, dex, factory);
            if (!res) continue;

            let liqUsdApprox = null;
            try {
              const baseAmt = Number(ethers.formatUnits(res.baseReserve, 18));
              if (base.kind === "stable") {
                liqUsdApprox = baseAmt * 2;
              } else if (base.kind === "bnb") {
                liqUsdApprox = (Number.isFinite(bnbUsd.px) ? baseAmt * bnbUsd.px * 2 : null);
              }
            } catch {}

            pairsFound.push({ ...res, liqUsdApprox });
          }
        }

        pairsFound.sort((a,b) => (b.liqUsdApprox || 0) - (a.liqUsdApprox || 0));

        let score = 0;
        const notes = [];
        notes.push(`âœ… Contract bytecode found`);

        if (!name || name === "â€”") { score += 1; notes.push(`âš ï¸ Token name unreadable (non-standard)`); }
        if (!symbol || symbol === "â€”") { score += 1; notes.push(`âš ï¸ Symbol unreadable (non-standard)`); }

        if (proxy?.isProxy && proxy.impl) {
          notes.push(`â„¹ï¸ Proxy detected (EIP-1967). Implementation: ${proxy.impl}`);
          if (proxy.admin) notes.push(`â„¹ï¸ Proxy admin slot: ${proxy.admin}`);
        }

        if (!owner) {
          score += 1; notes.push(`âš ï¸ Owner not detectable (may be fine, but less transparent)`);
        } else if (ownerRenounced) {
          notes.push(`âœ… Ownership appears renounced (owner=0x0)`);
        } else {
          score += 1;
          notes.push(`âš ï¸ Owner detected: ${owner} (not renounced)`);
        }

        if (!pairsFound.length) {
          if (requireLiq) {
            score += 4;
            notes.push(`âŒ No DEX pair found (require-liquidity enabled)`);
          } else {
            score += 1;
            notes.push(`â„¹ï¸ No DEX pair found (may be â€œNot listed yetâ€)`);
          }
        } else {
          const best = pairsFound[0];
          notes.push(`âœ… Best liquidity pair: ${best.dexName} â€¢ ${best.baseName} â€¢ ${best.pair}`);

          if (best.liqUsdApprox != null) {
            notes.push(`â„¹ï¸ Liquidity (approx): ${fmtUsd(best.liqUsdApprox)} (method: 2Ã—base side)`);
            if (best.baseKey === "WBNB" && Number.isFinite(bnbUsd.px)) {
              notes.push(`â„¹ï¸ BNB/USD: ${bnbUsd.px.toFixed(2)} (${bnbUsd.source})`);
            }
            if (best.liqUsdApprox < 25_000) { score += 2; notes.push(`âš ï¸ Low liquidity signal (< $25k approx)`); }
          }

          if (best.burnPct != null) {
            if (best.burnPct >= 50) notes.push(`âœ… LP burn seems high: ${best.burnPct.toFixed(2)}%`);
            else { score += 1; notes.push(`âš ï¸ LP burn seems low/unknown: ${best.burnPct.toFixed(2)}%`); }
          }
        }

        let badge = "info";
        let headline = "â„¹ï¸ Informational";
        if (score <= 1) { badge = "ok"; headline = "âœ… Looks OK (basic checks)"; }
        else if (score <= 4) { badge = "warn"; headline = "âš ï¸ Caution (some risk signals)"; }
        else { badge = "bad"; headline = "âŒ High risk signals"; }

        const supplyHuman = supply ? fmtBigintUnits(supply, decimals) : "â€”";

        ssLastReport = {
          token,
          name,
          symbol,
          decimals,
          totalSupply: supply ? supply.toString() : null,
          owner: owner || null,
          ownerRenounced: ownerRenounced === null ? null : ownerRenounced,
          proxy,
          requireLiquidity: requireLiq,
          bnbUsd: Number.isFinite(bnbUsd.px) ? { price: bnbUsd.px, source: bnbUsd.source } : null,
          pairs: pairsFound.slice(0, 20).map(p => ({
            dex: p.dexName,
            router: p.router,
            factory: p.factory,
            base: p.baseName,
            baseAddr: p.baseAddr,
            pair: p.pair,
            liquidityUsdApprox: (p.liqUsdApprox != null) ? Number(p.liqUsdApprox) : null,
            lpBurnPct: (p.burnPct != null) ? Number(p.burnPct) : null
          })),
          score,
          headline,
          generatedAt: new Date().toISOString(),
          rpc: _rpcUrl || "auto"
        };

        const html = `
          <strong>${headline}</strong><br><br>
          <div class="pill">Token: <span class="mono">${token}</span></div>
          <div style="margin-top:10px" class="small">
            <b>Name:</b> ${String(name).replace(/</g,"&lt;")}<br>
            <b>Symbol:</b> ${String(symbol).replace(/</g,"&lt;")}<br>
            <b>Decimals:</b> ${decimals}<br>
            <b>Total supply:</b> ${supply ? supplyHuman : "â€”"}
          </div>
          <div style="margin-top:12px" class="small">
            <b>Signals:</b><br>
            ${notes.map(n => "â€¢ " + n).join("<br>")}
          </div>
          <div style="margin-top:12px" class="small">
            <b>Next:</b> Open a DEX only if you trust the token. Consider external audits / community sources.
          </div>
        `;

        setStatus(out, badge, html);
        setStatus(status, badge, `<strong>Done.</strong> Score: ${score} (lower is better). RPC: <span class="mono">${_rpcUrl || "auto"}</span>`);

        ssRenderLinks(pairsFound, token, tokenInHint);

      } catch (e) {
        console.error(e);
        setStatus(out, "bad", `<strong>âŒ Scan failed.</strong><br>${(e?.message || e || "Unknown error").toString()}`);
        setStatus(status, "bad", "<strong>âŒ Scan failed.</strong> Try again or test RPCs below.");
      }
    }

    async function ssCopyShare() {
      const input = document.getElementById("ss-token");
      const status = document.getElementById("ss-status");
      const raw = (input?.value || "").trim();
      if (!raw || !isHexAddr(raw)) {
        setStatus(status, "warn", "<strong>âš ï¸ Paste a valid token address first.</strong>");
        return;
      }
      const token = toChecksum(raw);
      const requireLiq = !!document.getElementById("ss-require-liq")?.checked;

      let tokenIn = null;
      try {
        const u = new URL(window.location.href);
        const ti = u.searchParams.get("tokenIn");
        if (ti && isHexAddr(ti)) tokenIn = toChecksum(ti);
      } catch {}

      const link = ssBuildShareLink({ token, tokenIn, requireLiq });
      await copyText(link);
      setStatus(status, "ok", `<strong>âœ… Share link copied.</strong><br><span class="mono">${link}</span>`);
    }

    async function ssCopyJsonReport(){
      const status = document.getElementById("ss-status");
      if (!ssLastReport) {
        setStatus(status, "warn", "<strong>âš ï¸ No report yet.</strong><br>Run Scan first.");
        return;
      }
      const json = JSON.stringify(ssLastReport, null, 2);
      await copyText(json);
      setStatus(status, "ok", "<strong>âœ… JSON report copied.</strong>");
    }

    async function ssOpenManualSwap(){
      const tokenRaw = (document.getElementById("ss-token")?.value || "").trim();
      if (!isHexAddr(tokenRaw)) {
        setStatus(document.getElementById("ss-status"), "warn", "<strong>âš ï¸ Paste a valid token address first.</strong>");
        return;
      }
      const token = toChecksum(tokenRaw);

      const dexKey = document.getElementById("ss-dex-select")?.value;
      const baseKey = document.getElementById("ss-base-select")?.value;

      const dex = DEXES.find(d => d.key === dexKey);
      const base = BASES.find(b => b.key === baseKey);
      if (!dex || !base) return;

      let tokenIn = base.addr;
      try {
        const u = new URL(window.location.href);
        const ti = u.searchParams.get("tokenIn");
        if (ti && isHexAddr(ti)) tokenIn = toChecksum(ti);
      } catch {}

      const url = dex.swap(tokenIn, token);
      window.open(url, "_blank", "noopener");
    }

    function ssAutoFromQuery(){
      try {
        const u = new URL(window.location.href);
        const t = u.searchParams.get("token");
        const req = u.searchParams.get("requireLiq");
        const reqEl = document.getElementById("ss-require-liq");
        if (req === "1" && reqEl) reqEl.checked = true;

        if (t && isHexAddr(t)) {
          const input = document.getElementById("ss-token");
          if (input) input.value = toChecksum(t);
          ssScanV2();
        }
      } catch {}
    }

    document.getElementById("ss-scan")?.addEventListener("click", ssScanV2);
    document.getElementById("ss-share")?.addEventListener("click", ssCopyShare);
    document.getElementById("ss-copy-json")?.addEventListener("click", ssCopyJsonReport);
    document.getElementById("ss-open-manual")?.addEventListener("click", ssOpenManualSwap);

    // ====== 2) Approvals Guardian ======
    window.cxAppKitModal = null;

    let apSigner = null;
    let apOwner = null;

    const ALLOW_ABI = [
      "function allowance(address owner, address spender) view returns (uint256)",
      "function approve(address spender, uint256 value) returns (bool)",
      "function decimals() view returns (uint8)",
      "function symbol() view returns (string)"
    ];

    const MAX_UINT = (1n << 256n) - 1n;

    function apSetStatus(kind, html){
      setStatus(document.getElementById("ap-status"), kind, html);
    }

    function apGetSpender(){
      const preset = document.getElementById("ap-spender-preset")?.value;
      const input = document.getElementById("ap-spender")?.value?.trim() || "";
      if (preset === "pcs_router") return DEXES.find(d=>d.key==="pancake")?.router || input;
      if (preset === "custom") return input;
      return input;
    }

    function apParseTokens(){
      const raw = document.getElementById("ap-tokens")?.value || "";
      return raw
        .split(/\r?\n/)
        .map(x => x.trim())
        .filter(Boolean)
        .filter(isHexAddr)
        .map(toChecksum);
    }

    function apRenderRows(rows){
      const table = document.getElementById("ap-table");
      if (!table) return;

      const head = table.querySelector(".trow.head");
      table.innerHTML = "";
      if (head) table.appendChild(head);

      if (!rows.length) {
        const row = document.createElement("div");
        row.className = "trow";
        row.innerHTML = `<div class="cell muted">â€”</div><div class="cell muted">â€”</div><div class="cell muted hide-sm">â€”</div><div class="cell muted">â€”</div>`;
        table.appendChild(row);
        return;
      }

      for (const r of rows) {
        const row = document.createElement("div");
        row.className = "trow";
        const allowanceStr = r.allowanceInf ? "âˆ (infinite)" : r.allowanceHuman;

        row.innerHTML = `
          <div class="cell mono" title="${r.token}">${r.token}</div>
          <div class="cell">${allowanceStr}</div>
          <div class="cell hide-sm">${r.symbol || "â€”"}</div>
          <div class="cell">
            <button class="btn btn-ghost" data-token="${r.token}" ${(!r.canRevoke ? "disabled" : "")} style="padding:10px 14px; font-size:12px;">
              Revoke
            </button>
          </div>
        `;
        table.appendChild(row);
      }

      table.querySelectorAll("button[data-token]").forEach((btn) => {
        btn.addEventListener("click", async () => {
          const token = btn.getAttribute("data-token");
          await apRevokeOne(token);
        });
      });
    }

    async function apEnsureConnected() {
      const modal = window.cxAppKitModal;
      if (!modal?.open) {
        apSetStatus("warn", "<strong>âš ï¸ Wallet modal not ready yet.</strong><br>Wait a second and try again.");
        return false;
      }

      apSetStatus("info", "<strong>â³ Connecting walletâ€¦</strong>");
      await modal.open({ view: "ConnectWallet" });

      const start = Date.now();
      while (Date.now() - start < 90000) {
        const p = modal.getWalletProvider?.();
        if (p) {
          const bp = new ethers.BrowserProvider(p);
          apSigner = await bp.getSigner();
          apOwner = await apSigner.getAddress();
          const addrEl = document.getElementById("ap-address");
          if (addrEl) addrEl.textContent = apOwner;
          apSetStatus("ok", "<strong>âœ… Wallet connected.</strong>");
          return true;
        }
        await sleep(250);
      }

      apSetStatus("warn", "<strong>âš ï¸ Connection timeout.</strong><br>Please try again.");
      return false;
    }

    async function apCheck() {
      const ok = apOwner ? true : await apEnsureConnected();
      if (!ok) return;

      const spenderRaw = apGetSpender();
      if (!isHexAddr(spenderRaw)) {
        apSetStatus("bad", "<strong>âŒ Invalid spender address.</strong>");
        return;
      }
      const spender = toChecksum(spenderRaw);

      const tokens = apParseTokens();
      if (!tokens.length) {
        apSetStatus("warn", "<strong>âš ï¸ No valid token addresses.</strong><br>Paste at least one token address (one per line).");
        return;
      }

      apSetStatus("info", `<strong>â³ Checking allowancesâ€¦</strong><br>Owner: <span class="mono">${fmtAddr(apOwner)}</span> â€¢ Spender: <span class="mono">${fmtAddr(spender)}</span>`);

      const rows = [];
      for (const t of tokens) {
        try {
          const c = new ethers.Contract(t, ALLOW_ABI, apSigner);
          let sym = "â€”", dec = 18;
          try { sym = await c.symbol(); } catch {}
          try { dec = Number(await c.decimals()); } catch { dec = 18; }

          const a = BigInt(await c.allowance(apOwner, spender));
          const isInf = (a > (MAX_UINT / 2n));
          const human = isInf ? "âˆ" : (a === 0n ? "0" : fmtBigintUnits(a, dec));

          rows.push({
            token: t,
            symbol: sym,
            allowance: a,
            allowanceInf: isInf,
            allowanceHuman: human,
            canRevoke: (a > 0n)
          });
        } catch {
          rows.push({
            token: t,
            symbol: "â€”",
            allowance: 0n,
            allowanceInf: false,
            allowanceHuman: "error",
            canRevoke: false
          });
        }
      }

      apRenderRows(rows);

      const nonZero = rows.filter(r => r.allowance > 0n).length;
      apSetStatus(nonZero ? "warn" : "ok",
        `<strong>Done.</strong><br>Checked ${rows.length} token(s). Non-zero: ${nonZero}.`);
    }

    async function apRevokeOne(tokenAddr) {
      const spenderRaw = apGetSpender();
      if (!apOwner || !apSigner) {
        apSetStatus("warn", "<strong>âš ï¸ Connect wallet first.</strong>");
        return;
      }
      if (!isHexAddr(spenderRaw)) {
        apSetStatus("bad", "<strong>âŒ Invalid spender address.</strong>");
        return;
      }
      const spender = toChecksum(spenderRaw);
      const token = toChecksum(tokenAddr);

      apSetStatus("info", `<strong>â³ Revokingâ€¦</strong><br>Token: <span class="mono">${fmtAddr(token)}</span> â€¢ Spender: <span class="mono">${fmtAddr(spender)}</span>`);

      try {
        const c = new ethers.Contract(token, ALLOW_ABI, apSigner);
        const tx = await c.approve(spender, 0);
        apSetStatus("info", `<strong>â³ Pendingâ€¦</strong><br><span class="mono">${tx.hash}</span>`);
        await tx.wait();
        apSetStatus("ok", "<strong>âœ… Revoke successful.</strong>");
        await apCheck();
      } catch (e) {
        console.error(e);
        apSetStatus("bad", `<strong>âŒ Revoke failed.</strong><br>${(e?.message || e).toString()}`);
      }
    }

    async function apRevokeAllNonZero() {
      const ok = apOwner ? true : await apEnsureConnected();
      if (!ok) return;

      const tokens = apParseTokens();
      if (!tokens.length) {
        apSetStatus("warn", "<strong>âš ï¸ No valid token addresses.</strong>");
        return;
      }

      await apCheck();

      const rows = [];
      document.querySelectorAll("#ap-table button[data-token]").forEach(btn => {
        if (!btn.disabled) rows.push(btn.getAttribute("data-token"));
      });

      if (!rows.length) {
        apSetStatus("ok", "<strong>âœ… Nothing to revoke.</strong>");
        return;
      }

      apSetStatus("warn", `<strong>â³ Revoking ${rows.length} token(s)â€¦</strong><br>This will send multiple transactions.`);
      for (const t of rows) {
        await apRevokeOne(t);
        await sleep(500);
      }
      apSetStatus("ok", "<strong>âœ… Revoke batch finished.</strong>");
    }

    document.getElementById("ap-spender-preset")?.addEventListener("change", () => {
      const preset = document.getElementById("ap-spender-preset").value;
      const input = document.getElementById("ap-spender");
      if (!input) return;

      if (preset === "pcs_router") {
        input.value = DEXES.find(d=>d.key==="pancake")?.router || "";
        input.disabled = true;
      } else {
        input.value = "";
        input.disabled = false;
      }
    });

    const apSpender = document.getElementById("ap-spender");
    const pcsRouter = DEXES.find(d=>d.key==="pancake")?.router || "";
    if (apSpender) {
      apSpender.value = pcsRouter;
      apSpender.disabled = true;
    }

    document.getElementById("ap-connect")?.addEventListener("click", apEnsureConnected);
    document.getElementById("ap-check")?.addEventListener("click", apCheck);
    document.getElementById("ap-revoke-all")?.addEventListener("click", apRevokeAllNonZero);

    // ====== 3) Bookmarklet (multi-DEX param extraction) ======
    function buildSecurityBase(){
      const u = new URL(window.location.href);
      return u.origin + "/security/";
    }

    const bookmarklet = `javascript:(function(){try{var u=new URL(location.href);var get=function(k){return u.searchParams.get(k)||'';};var tokenOut=get('outputCurrency')||get('tokenOut')||get('out')||get('currency')||get('address')||get('token')||'';var tokenIn=get('inputCurrency')||get('tokenIn')||get('in')||'';if(!tokenOut){tokenOut=prompt('Paste token address (BSC):');}if(!tokenOut){return;}var dest='${buildSecurityBase()}?token='+encodeURIComponent(tokenOut.trim());if(tokenIn){dest += '&tokenIn='+encodeURIComponent(tokenIn.trim());}window.open(dest,'_blank');}catch(e){alert('DEX Guard error: '+e.message);}})();`;

    const bmLink = document.getElementById("bm-link");
    const bmCode = document.getElementById("bm-code");
    if (bmLink) bmLink.href = bookmarklet;
    if (bmCode) bmCode.value = bookmarklet;

    // ====== 4) RPC Checker ======
    function rpcRow(url, latency, block, ok){
      const table = document.getElementById("rpc-table");
      if (!table) return;

      const row = document.createElement("div");
      row.className = "trow";

      const tag = ok ? "âœ… OK" : "âŒ Fail";
      const lat = ok ? (latency.toFixed(0) + " ms") : "â€”";
      const blockStr = ok ? String(block) : "â€”";

      row.innerHTML = `
        <div class="cell mono" title="${url}">${url}</div>
        <div class="cell">${lat}</div>
        <div class="cell hide-sm">${blockStr}</div>
        <div class="cell">${tag}</div>
      `;

      if (ok && url === _bestRpc) {
        row.style.background = "rgba(0,230,118,0.10)";
        row.style.borderTopColor = "rgba(0,230,118,0.20)";
      }

      table.appendChild(row);
    }

    async function rpcTestAll(){
      const status = document.getElementById("rpc-status");
      const custom = (document.getElementById("rpc-custom")?.value || "").trim();

      const list = [...RPCS_DEFAULT];
      if (custom) list.unshift(custom);

      const table = document.getElementById("rpc-table");
      if (!table) return;

      table.innerHTML = `
        <div class="trow head">
          <div class="cell">RPC</div>
          <div class="cell">Latency</div>
          <div class="cell hide-sm">Block</div>
          <div class="cell">Status</div>
        </div>
      `;

      setStatus(status, "info", `<strong>â³ Testing ${list.length} RPC(s)â€¦</strong>`);
      _bestRpc = "";
      let bestMs = Infinity;

      for (const url of list) {
        let ok = false;
        let ms = 0;
        let block = 0;

        try {
          const p = new ethers.JsonRpcProvider(url);
          const t0 = performance.now();
          block = await p.getBlockNumber();
          const net = await p.getNetwork();
          const t1 = performance.now();
          ms = (t1 - t0);

          if (Number(net.chainId) !== 56) throw new Error("Wrong chainId");
          ok = true;

          if (ms < bestMs) {
            bestMs = ms;
            _bestRpc = url;
          }
        } catch {
          ok = false;
        }

        rpcRow(url, ms, block, ok);
        await sleep(120);
      }

      if (_bestRpc) {
        setStatus(status, "ok", `<strong>âœ… Best RPC:</strong> <span class="mono">${_bestRpc}</span>`);
      } else {
        setStatus(status, "bad", "<strong>âŒ All RPC tests failed.</strong><br>Try a different custom RPC.");
      }
    }

    async function rpcCopyBest(){
      const status = document.getElementById("rpc-status");
      if (!_bestRpc) {
        setStatus(status, "warn", "<strong>âš ï¸ No best RPC yet.</strong><br>Run Test RPCs first.");
        return;
      }
      await copyText(_bestRpc);
      setStatus(status, "ok", `<strong>âœ… Copied:</strong> <span class="mono">${_bestRpc}</span>`);
    }

    document.getElementById("rpc-test")?.addEventListener("click", rpcTestAll);
    document.getElementById("rpc-copy-best")?.addEventListener("click", rpcCopyBest);

    document.getElementById("btn-run-all")?.addEventListener("click", async () => {
      await ssScanV2();
      await rpcTestAll();
    });

    document.getElementById("btn-connect")?.addEventListener("click", apEnsureConnected);

    // init dropdowns + autorun
    initDexBaseDropdowns();
    ssAutoFromQuery();
  </script>

  <!-- AppKit (wallet list) -->
  <script type="module">
    import { createAppKit } from "https://esm.sh/@reown/appkit@1.8.15";
    import { EthersAdapter } from "https://esm.sh/@reown/appkit-adapter-ethers@1.8.15";
    import { bsc } from "https://esm.sh/@reown/appkit/networks";

    const projectId = "7886bcb95105e9e47337cec481d5de75";

    const modal = createAppKit({
      adapters: [new EthersAdapter()],
      networks: [bsc],
      defaultNetwork: bsc,
      projectId,
      analytics: false,
      metadata: {
        name: "CycleX",
        description: "CycleX Security Hub",
        url: window.location.origin,
        icons: [`${window.location.origin}/logo.png`]
      }
    });

    // IMPORTANT: set modal globally (non-module script reads it from window)
    window.cxAppKitModal = modal;
  </script>

